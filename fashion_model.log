2025-02-27 18:59:05,953 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-02-27 18:59:06,833 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-02-27 18:59:06,838 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-02-27 18:59:06,838 - FashionDataset - INFO - Extracted 50 attribute columns
2025-02-27 18:59:06,847 - FashionDataset - INFO - Created category mapping with 46 categories
2025-02-27 18:59:06,848 - FashionDataset - INFO - Validating dataset files...
2025-02-27 18:59:06,920 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-02-27 18:59:06,920 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-02-27 18:59:07,083 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-02-27 18:59:07,087 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-02-27 18:59:07,087 - FashionDataset - INFO - Extracted 50 attribute columns
2025-02-27 18:59:07,087 - FashionDataset - INFO - Created category mapping with 46 categories
2025-02-27 18:59:07,087 - FashionDataset - INFO - Validating dataset files...
2025-02-27 18:59:07,142 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-02-27 18:59:07,142 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-02-27 18:59:07,142 - FashionHybridModel - INFO - Parameters: num_categories=46, num_category_types=3, num_attributes=50, embed_dim=256
2025-02-27 18:59:07,608 - FashionHybridModel - INFO - Heatmap encoder initialized with output dimension: 256
2025-02-27 18:59:25,323 - TrainingScript - INFO - Batch 0 - Input shapes:
2025-02-27 18:59:25,323 - TrainingScript - INFO - Images: torch.Size([128, 3, 224, 224]), Heatmaps: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-02-27 18:59:25,578 - TrainingScript - ERROR - Invalid category labels found: tensor([ 3, 41, 11, 39, 18,  2, 18, 41, 30,  1, 17, 32, 11, 18, 41, 29, 32, 41,
        41, 41, 18,  6, 18, 10, 41, 41,  6,  3, 18, 22, 41,  2,  3, 41, 18, 41,
        44, 41, 17, 16, 41, 35, 41, 18,  6, 19, 30, 41, 30, 18, 32, 26, 18,  9,
        41,  6, 16, 41, 41, 18, 16, 32, 41, 48, 18, 44, 18, 41, 10, 41, 24, 41,
        17, 32, 32, 19,  2,  6, 18, 41, 41, 48,  3, 32,  3, 11, 48, 16, 18,  3,
         3, 48, 41,  3, 32, 11, 32, 16, 33, 41, 17, 30, 18, 32, 32, 19, 32, 41,
         3, 41, 18, 44, 32, 18, 17, 29,  2, 44, 32, 18, 17,  3, 32, 11, 27, 48,
         3, 33], device='cuda:0')
2025-02-27 18:59:25,578 - TrainingScript - INFO - Batch 1 - Input shapes:
2025-02-27 18:59:25,578 - TrainingScript - INFO - Images: torch.Size([128, 3, 224, 224]), Heatmaps: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-02-27 18:59:25,767 - TrainingScript - ERROR - Invalid category labels found: tensor([32,  3, 41, 41, 41,  6, 19, 18, 41, 26, 41, 18, 41, 41, 26, 19, 32, 32,
        41, 17, 16, 42, 41, 41, 33, 41, 41, 41,  2, 32,  3,  3, 48, 41, 32,  3,
        16, 17, 18,  3, 18, 19, 44, 18, 41, 29, 11, 41, 41,  3, 41, 41,  3, 15,
        10, 16, 17,  6, 32, 41,  2,  6,  9, 11, 41, 48, 18, 41, 16, 29, 17, 41,
        17, 29, 32, 33,  6, 11, 41, 26, 32,  3, 32, 48,  2, 11, 27, 48, 18, 41,
        16, 18, 16, 16,  3, 16,  2, 41, 41, 41, 41, 33, 41, 18,  6,  6, 33, 17,
        18, 44, 33, 41, 41, 41, 17, 18, 18, 16, 12, 30, 33, 30, 26, 19, 17, 26,
        42, 34], device='cuda:0')
2025-02-27 18:59:28,462 - TrainingScript - INFO - Batch 2 - Input shapes:
2025-02-27 18:59:28,462 - TrainingScript - INFO - Images: torch.Size([128, 3, 224, 224]), Heatmaps: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-02-27 18:59:28,644 - TrainingScript - ERROR - Invalid category labels found: tensor([26, 18, 44,  6, 41, 41, 32, 17, 41,  6, 17, 41, 41, 18, 48, 41, 41, 41,
        17, 41,  2, 32,  2, 16, 18, 16, 41, 41, 41, 18, 18, 41, 41, 32, 17, 30,
        33, 41,  3, 41, 16, 41, 10, 10,  6, 33, 17, 41, 41, 42, 33, 41, 41, 41,
        48, 17, 32, 41, 41, 26, 41, 17, 19, 41, 41, 17, 18, 18, 41, 18,  3, 41,
        41, 42, 41,  6, 33, 18, 18, 30,  6, 41, 10, 22, 41, 39, 16, 29, 19, 30,
         3, 48, 42, 41, 48,  3, 41, 41, 18, 18, 16, 30, 41, 17, 12, 41, 41, 41,
        41, 41, 18,  3, 17, 11, 26, 41, 26, 18, 41, 42,  3, 33, 41, 34,  9, 41,
        17, 41], device='cuda:0')
2025-02-27 18:59:28,644 - TrainingScript - INFO - Batch 3 - Input shapes:
2025-02-27 18:59:28,644 - TrainingScript - INFO - Images: torch.Size([128, 3, 224, 224]), Heatmaps: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-02-27 18:59:28,827 - TrainingScript - ERROR - Invalid category type labels found: tensor([3, 1, 1, 1, 3, 1, 1, 1, 1, 1, 1, 1, 2, 3, 2, 1, 3, 3, 3, 1, 2, 3, 1, 1,
        3, 3, 3, 1, 1, 1, 2, 1, 3, 1, 3, 1, 2, 3, 3, 1, 1, 3, 1, 1, 1, 1, 1, 1,
        3, 2, 2, 3, 1, 1, 3, 1, 1, 1, 1, 3, 1, 2, 1, 2, 1, 2, 2, 3, 1, 1, 1, 3,
        3, 2, 2, 1, 1, 2, 3, 3, 3, 1, 2, 2, 3, 1, 2, 3, 1, 2, 1, 1, 3, 1, 2, 3,
        2, 2, 1, 3, 1, 2, 1, 2, 1, 1, 1, 1, 3, 1, 2, 3, 1, 2, 1, 3, 3, 1, 1, 3,
        3, 1, 1, 3, 3, 3, 2, 2], device='cuda:0')
2025-02-27 18:59:31,983 - TrainingScript - INFO - Batch 4 - Input shapes:
2025-02-27 18:59:31,983 - TrainingScript - INFO - Images: torch.Size([128, 3, 224, 224]), Heatmaps: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-02-27 18:59:32,156 - TrainingScript - ERROR - Invalid category labels found: tensor([30, 16, 18,  6, 48, 23, 41, 23, 32, 41, 41, 48, 17, 22,  2, 41, 26, 41,
        17, 18, 10, 11, 11, 39, 18,  6,  3, 26, 19, 18, 18, 41, 39, 33, 41, 18,
        18, 18, 33, 19, 18, 17,  9,  3,  3, 17,  3, 47, 42, 32, 16, 41, 18, 18,
        11, 19, 19, 18, 44,  3, 11, 41, 32, 17, 41, 32, 41, 41, 18, 41, 42, 26,
        10, 16,  3, 41, 41, 41, 34, 41, 18, 41, 41,  3,  2,  6,  3, 17, 33, 11,
         3, 16, 41, 32, 41, 17, 41, 17,  3, 19, 32, 33, 41, 26, 41, 41,  6, 18,
        11, 32, 41, 32, 18, 41, 16, 48, 18, 44, 18, 16, 17, 19, 11, 11,  6, 16,
        19,  2], device='cuda:0')
2025-02-27 18:59:32,156 - TrainingScript - INFO - Batch 5 - Input shapes:
2025-02-27 18:59:32,156 - TrainingScript - INFO - Images: torch.Size([128, 3, 224, 224]), Heatmaps: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-02-27 18:59:32,230 - TrainingScript - ERROR - Invalid category labels found: tensor([18, 41, 26, 18, 41, 32, 17, 41,  3, 41, 34, 30, 42, 26, 29, 41, 48, 32,
        32, 18, 18, 11, 32, 41,  3, 18,  3,  3, 41, 18, 33, 19,  6, 41, 41, 16,
        17, 16, 48, 18, 41, 41, 18, 16, 33, 32, 32, 41, 41, 18, 18,  3, 32, 41,
        17, 41, 41, 41, 19, 18, 18, 18, 18, 42, 41, 19, 16, 11, 18, 42, 18, 11,
        32, 11, 29, 41, 19, 17, 16,  3, 32, 42, 41, 43, 48,  2, 41, 41, 35, 41,
        24, 17, 48, 41,  3, 41, 17, 41, 32, 42, 32, 41, 44, 41, 11,  3, 41, 18,
         3, 42, 32,  6, 17, 41, 41, 32,  3, 48, 18, 18, 41, 48, 10, 12, 48, 30,
        16,  6], device='cuda:0')
2025-02-27 18:59:35,434 - TrainingScript - INFO - Batch 6 - Input shapes:
2025-02-27 18:59:35,434 - TrainingScript - INFO - Images: torch.Size([128, 3, 224, 224]), Heatmaps: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-02-27 18:59:35,618 - TrainingScript - ERROR - Invalid category labels found: tensor([12, 17, 41, 34, 17, 41, 41, 48, 41, 18, 18, 33,  6,  3, 26, 32, 41, 26,
         6, 32, 41, 29, 33, 16, 30, 17,  6, 41, 30, 17,  6, 18, 29, 26,  3, 39,
        41,  2, 26,  3,  2,  6, 32, 32, 41,  3, 30, 18, 16,  3, 16,  2, 26, 41,
        18, 41, 17, 17, 41, 17, 41, 42, 42, 41, 41, 17, 11, 41, 33,  6, 41, 19,
        41, 33,  3, 41,  3, 18, 33,  3, 24,  2,  3, 41, 19, 29, 17, 17, 16, 10,
        32,  3, 17,  6, 34, 41, 18,  7, 13, 33, 16, 18, 41, 32, 41, 19, 18, 41,
         3, 41, 26, 18, 32, 18, 41, 41,  2, 41, 18, 18, 48, 33, 41, 41, 19, 32,
        18, 18], device='cuda:0')
2025-02-27 18:59:35,619 - TrainingScript - INFO - Batch 7 - Input shapes:
2025-02-27 18:59:35,620 - TrainingScript - INFO - Images: torch.Size([128, 3, 224, 224]), Heatmaps: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-02-27 18:59:35,647 - TrainingScript - ERROR - Invalid category labels found: tensor([18,  2, 11, 41, 41, 19, 18, 41, 18, 33, 16,  3, 33, 41, 33, 41, 41,  3,
        30, 11, 48,  3, 33,  3, 41,  3, 18, 26,  6, 41, 41, 41, 41, 41,  2, 17,
         3,  3, 41, 16, 32,  2, 41, 41, 41, 48,  3, 42, 41, 30, 41,  9,  3,  3,
        11, 41, 18, 32,  6, 32, 41, 41, 10,  4, 48, 32, 26, 41, 33, 41, 41,  3,
        41, 30, 26, 33, 41,  3, 24, 16, 17, 41, 41, 33, 18, 19, 41, 18,  3, 41,
        41, 11, 11,  3, 41, 41, 26, 33, 18, 44, 32, 41, 41, 48, 33, 33, 18, 41,
        33, 35,  6, 16,  3, 19, 17, 29,  3, 48,  3, 32, 11, 32, 17,  3, 41,  3,
        17, 41], device='cuda:0')
2025-02-27 18:59:38,737 - TrainingScript - INFO - Batch 8 - Input shapes:
2025-02-27 18:59:38,737 - TrainingScript - INFO - Images: torch.Size([128, 3, 224, 224]), Heatmaps: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-02-27 18:59:38,926 - TrainingScript - ERROR - Invalid category labels found: tensor([34, 11, 17,  3, 41, 41, 41, 16, 32, 41, 11,  2, 34, 33,  2,  3,  3, 16,
        48, 19,  6, 17, 18, 30, 41, 18, 32, 18, 41, 11, 33,  3, 26, 29, 41, 10,
        30, 11, 18, 18,  3, 41,  3,  6, 33, 16, 29, 16, 18, 18, 18, 44, 41, 41,
        26, 30, 19, 18, 32, 18, 17, 16, 30, 41,  3, 18, 41, 41, 15, 34, 41, 18,
        48, 33, 27, 30, 41, 41, 35, 41, 41, 32, 27, 10, 48, 41, 41, 41, 41, 41,
        19,  6, 33,  3, 11, 19, 18, 32, 41, 19, 41, 33, 17, 18, 41, 18,  6, 33,
        41, 11, 11, 41,  6, 17,  3, 17, 41,  2, 18, 17, 17, 41, 41, 39, 48, 48,
        18, 26], device='cuda:0')
2025-02-27 18:59:38,926 - TrainingScript - INFO - Batch 9 - Input shapes:
2025-02-27 18:59:38,926 - TrainingScript - INFO - Images: torch.Size([128, 3, 224, 224]), Heatmaps: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-02-27 18:59:39,031 - TrainingScript - ERROR - Invalid category labels found: tensor([19, 41,  3, 33, 35,  2, 11, 33, 33, 10, 19, 41, 24,  3, 17, 41, 33, 41,
        41, 15, 18, 41, 33, 48, 41, 41, 42, 41, 31, 19, 41, 32, 48, 11, 11, 32,
        42, 17, 41, 41, 32,  3, 41,  2, 41,  2, 41, 18, 17, 17,  3, 42, 17, 41,
        33, 44, 11, 41, 18, 41,  2, 19, 41, 16, 41,  6, 41, 18, 16, 18, 18,  2,
        32, 33, 41, 41, 41, 18, 18,  3, 33, 19, 19, 33, 17, 41, 41, 30, 17, 19,
        48, 32,  3, 41, 41, 32, 20, 48, 18, 41, 17,  3, 26, 32, 34,  3, 33, 17,
        16, 32, 33, 33, 41,  3,  3, 32, 41, 18, 11, 41, 20, 32,  4, 18, 29, 41,
        18, 26], device='cuda:0')
2025-02-27 18:59:42,082 - TrainingScript - INFO - Batch 10 - Input shapes:
2025-02-27 18:59:42,082 - TrainingScript - INFO - Images: torch.Size([128, 3, 224, 224]), Heatmaps: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-02-27 18:59:42,265 - TrainingScript - ERROR - Invalid category labels found: tensor([16, 34,  3, 41, 16, 32, 41, 41, 26, 19, 41, 18, 32,  6, 18, 41, 32, 41,
        11, 32, 19, 41, 17, 41, 41, 41, 17,  3, 42,  6, 32, 41, 41, 11, 41, 12,
        18, 41, 41, 41, 18, 39, 26, 33, 18, 41,  6, 41, 41, 18, 32, 41, 41, 33,
         2, 18, 48, 41, 41, 18, 41, 41, 16, 12, 32, 41, 19, 18, 33, 41,  9, 48,
        41, 41, 41, 29, 41,  2,  3, 17, 41, 30, 41, 32,  2, 18, 41,  6, 19, 16,
        44, 41, 41,  3, 33, 15, 34, 17, 32, 30, 18, 30, 41, 41, 18, 42, 26, 48,
        32, 41, 34, 18, 41, 41, 11,  2, 41, 33,  2, 48, 41, 18, 44, 44, 41,  1,
         2, 26], device='cuda:0')
2025-02-27 18:59:42,265 - TrainingScript - INFO - Batch 11 - Input shapes:
2025-02-27 18:59:42,265 - TrainingScript - INFO - Images: torch.Size([128, 3, 224, 224]), Heatmaps: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-02-27 18:59:42,418 - TrainingScript - ERROR - Invalid category labels found: tensor([11, 17, 18, 18, 32, 16, 41, 17, 18, 16, 42, 30, 18, 32, 17, 34,  3, 18,
        17, 26, 16, 48,  3, 33, 32, 41, 16, 41, 41, 42,  3, 16, 41, 48,  6, 18,
         3, 11, 48, 22, 48,  3, 41, 33, 26, 26, 48,  3, 26,  6,  3, 16,  6, 30,
        17, 41, 41, 18,  6, 17, 33,  3, 19, 29, 41,  6, 41, 18, 18, 17,  3, 18,
        32, 41,  3, 41, 41, 41, 41, 18, 19, 16, 18, 32,  6,  6, 32, 29,  2, 11,
         5, 41,  6, 18, 48, 41, 18, 41, 18, 16,  2, 41, 11, 41, 19, 19, 41, 42,
        30, 11, 18,  9, 33, 17, 33, 41, 11,  2, 24,  6, 26, 16, 11, 24, 33, 41,
        18, 32], device='cuda:0')
2025-02-27 18:59:45,308 - TrainingScript - INFO - Batch 12 - Input shapes:
2025-02-27 18:59:45,308 - TrainingScript - INFO - Images: torch.Size([128, 3, 224, 224]), Heatmaps: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-02-27 18:59:45,487 - TrainingScript - ERROR - Invalid category labels found: tensor([10, 42, 41,  9, 41, 41, 18, 33, 32, 26, 41, 11, 33, 41,  3, 41, 41, 32,
        18, 19, 16, 41, 16, 29, 16, 17, 17, 41, 24, 17, 36, 39, 42, 32, 33, 32,
        29, 41, 17, 41, 41, 11, 48, 41, 18, 41, 26, 33, 41, 22, 16, 41, 29, 41,
        41, 16, 17, 41,  2, 41, 41, 19,  6, 41,  6, 18, 41, 25, 26, 33, 17, 42,
        32, 41, 11,  2, 29, 41, 32, 18, 41, 18, 41, 32, 41, 12, 18, 18, 41, 41,
        41,  3, 30, 17, 18,  3, 32, 41, 18, 33, 41,  6, 17, 32, 33, 17, 32, 33,
        30, 41,  6,  3, 19,  6, 41, 48, 41,  6,  3, 18, 41, 42, 42, 41, 18, 34,
         3, 34], device='cuda:0')
2025-02-27 18:59:45,487 - TrainingScript - INFO - Batch 13 - Input shapes:
2025-02-27 18:59:45,487 - TrainingScript - INFO - Images: torch.Size([128, 3, 224, 224]), Heatmaps: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-02-27 18:59:45,608 - TrainingScript - ERROR - Invalid category labels found: tensor([ 6, 30, 33, 18, 41, 41, 30, 26, 26,  3, 41, 33, 11, 41, 16,  6, 18, 17,
        41, 18, 16, 41, 41, 10, 17, 11, 41, 32,  3, 41, 11,  2, 41, 11, 41, 39,
        32, 41, 33, 41,  6, 41, 16,  3, 33, 13, 26,  3,  3, 32, 41, 41, 41,  3,
        42,  6, 19,  3, 41, 42,  6, 32, 16, 11, 11, 19, 11,  2, 41, 19, 17, 18,
        44, 11, 41, 41, 33, 16, 33, 32,  6, 48, 33, 16, 32, 30, 18, 18, 32, 48,
        10, 41, 42,  3,  6, 32, 30, 32, 26, 33, 18, 41, 18, 19, 41, 44,  6, 41,
        42, 32,  3,  3, 41, 16, 41, 41, 33, 16,  3, 19, 17, 26, 41, 19, 41, 41,
        33, 33], device='cuda:0')
2025-02-27 18:59:48,704 - TrainingScript - INFO - Batch 14 - Input shapes:
2025-02-27 18:59:48,704 - TrainingScript - INFO - Images: torch.Size([128, 3, 224, 224]), Heatmaps: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-02-27 18:59:48,882 - TrainingScript - ERROR - Invalid category type labels found: tensor([1, 3, 3, 1, 1, 1, 1, 1, 1, 1, 3, 1, 2, 1, 2, 1, 1, 3, 1, 1, 3, 1, 2, 3,
        3, 3, 1, 2, 2, 1, 1, 2, 1, 3, 3, 1, 2, 1, 1, 2, 2, 3, 1, 2, 2, 2, 2, 1,
        3, 3, 2, 2, 1, 2, 2, 2, 3, 1, 1, 1, 3, 3, 1, 1, 3, 1, 1, 3, 1, 1, 1, 3,
        1, 3, 1, 3, 1, 3, 3, 3, 1, 3, 2, 1, 1, 3, 3, 2, 3, 3, 1, 1, 2, 1, 1, 2,
        3, 1, 3, 1, 3, 3, 1, 3, 1, 1, 3, 2, 1, 1, 3, 3, 1, 2, 1, 1, 3, 1, 2, 3,
        3, 1, 1, 2, 3, 2, 1, 3], device='cuda:0')
2025-02-27 18:59:48,890 - TrainingScript - INFO - Batch 15 - Input shapes:
2025-02-27 18:59:48,890 - TrainingScript - INFO - Images: torch.Size([128, 3, 224, 224]), Heatmaps: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-02-27 18:59:49,003 - TrainingScript - ERROR - Invalid category labels found: tensor([34, 19, 29, 41, 41, 41, 33, 17, 17, 34, 41, 33, 18,  6, 18, 32, 11, 41,
        33, 16, 33, 16, 32, 16, 17,  3, 26, 17, 19, 44, 32, 41, 41, 19, 41, 18,
        32, 41,  3, 18, 11, 19, 41, 42, 32, 41, 48, 27, 19, 26, 41,  3, 41,  6,
        48,  3, 17, 41, 33, 41, 41, 16,  7, 48,  2, 41, 19, 41, 41, 18, 18, 41,
        16, 19, 39, 41, 33, 41, 19, 41, 26, 41, 16, 11, 44, 41, 18,  3, 32, 32,
         6, 41,  2, 41, 19, 36, 32, 17, 41, 42, 41,  6, 18, 42, 11, 26, 32, 18,
        41, 41, 41, 32, 41, 18,  3, 19, 18, 32, 32, 41, 19, 41, 11, 18, 35, 18,
        39, 41], device='cuda:0')
2025-02-27 18:59:51,991 - TrainingScript - INFO - Batch 16 - Input shapes:
2025-02-27 18:59:51,991 - TrainingScript - INFO - Images: torch.Size([128, 3, 224, 224]), Heatmaps: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-02-27 18:59:52,179 - TrainingScript - ERROR - Invalid category labels found: tensor([18, 41, 41, 41, 11, 18, 41, 41, 42, 17, 41, 41,  3, 32,  2, 41, 32, 41,
        26, 41, 32, 16,  3, 41,  2, 32, 33, 41, 41, 11, 18,  2,  2,  6, 33, 16,
        16, 32, 11, 26, 48, 19, 18, 18, 17, 41, 10,  2, 41, 41, 18, 41, 41, 41,
        16, 10, 41,  6, 41, 48, 35, 48, 26, 11,  3, 19, 33, 33,  6, 17,  9, 18,
        16, 17, 32, 16,  6,  3, 18,  6,  3, 12, 41, 41,  3, 26, 41, 41, 41, 44,
        39, 17, 29, 41, 18, 18, 32,  6, 41, 17, 33, 32, 41, 30, 35,  6, 41, 41,
        18, 32, 32, 48, 18, 16, 19, 41, 32, 41, 29, 32, 11, 11, 26, 16, 33, 41,
        11, 41], device='cuda:0')
2025-02-27 18:59:52,182 - TrainingScript - INFO - Batch 17 - Input shapes:
2025-02-27 18:59:52,182 - TrainingScript - INFO - Images: torch.Size([128, 3, 224, 224]), Heatmaps: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-02-27 18:59:52,229 - TrainingScript - ERROR - Invalid category labels found: tensor([ 3, 11, 16, 16, 41, 22, 33, 10, 26, 17, 18, 41, 18, 19,  3, 41, 33, 32,
        41,  3,  6, 41, 41,  2, 33, 29, 17, 41, 29, 18,  6, 10, 41, 16, 41, 22,
         2, 24,  3, 32, 41, 18, 18,  6, 41, 18, 41, 18, 32, 17, 41, 41, 41, 35,
        41, 18, 17, 19, 41, 41, 17, 41, 41,  2,  3, 11, 18, 18,  6, 41, 41, 18,
        34, 16, 18,  6,  2, 33, 41, 32,  6,  6, 41, 29, 18, 48, 32, 41, 41, 17,
        41, 33,  2, 48, 30, 17, 18, 32, 32, 17, 19,  2, 41,  3, 41, 41, 32, 41,
        17, 18, 33, 41, 16, 32,  3, 42,  3, 33,  3,  2, 18, 41, 41, 18, 41, 17,
        41, 16], device='cuda:0')
2025-02-27 18:59:55,254 - TrainingScript - INFO - Batch 18 - Input shapes:
2025-02-27 18:59:55,254 - TrainingScript - INFO - Images: torch.Size([128, 3, 224, 224]), Heatmaps: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-02-27 18:59:55,434 - TrainingScript - ERROR - Invalid category labels found: tensor([11, 41,  3, 41, 32, 33,  3, 33, 18, 17, 42, 18, 41, 11, 18, 33, 39, 17,
        33, 41, 36, 16,  3, 18, 16, 19, 18, 26, 16,  6, 41,  2, 32, 41, 18, 42,
        11, 18,  3, 41,  6,  3, 41, 32, 33, 29, 42, 41, 33, 18,  3, 41, 10, 41,
        33, 41, 17, 41, 41, 19, 16,  3, 18, 32, 41, 18, 41, 32, 16, 32, 11,  3,
        33, 41, 41, 11, 18, 17, 41,  6, 19,  3,  6, 16, 41, 33, 17, 33, 41,  1,
         3, 34, 18, 19, 32, 10,  2, 48, 18, 42, 41, 41, 41,  3, 17, 26, 18,  3,
        11, 41, 18, 18, 33, 41, 41, 41, 19,  6, 41, 32, 33, 42, 18, 17,  6, 18,
        11, 32], device='cuda:0')
2025-02-27 18:59:55,434 - TrainingScript - INFO - Batch 19 - Input shapes:
2025-02-27 18:59:55,434 - TrainingScript - INFO - Images: torch.Size([128, 3, 224, 224]), Heatmaps: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-02-27 18:59:55,620 - TrainingScript - ERROR - Invalid category labels found: tensor([10, 17, 18, 18, 16, 41, 41,  3,  2, 41, 10, 29,  4,  6,  6, 33, 26,  3,
        26,  2, 41, 32, 32, 41, 41, 32, 10,  3, 41, 41, 44, 34, 41, 11, 18, 18,
        42, 32, 41, 32, 26, 41, 17, 19, 41, 18, 18, 26, 41, 17, 48,  3, 41, 18,
        33,  6, 33, 41, 33, 41,  3, 17, 18, 17, 26, 32, 33, 18, 32, 17, 41, 41,
        16, 32, 16, 41,  5, 41,  3, 41, 41, 16, 16, 25, 18, 41, 17,  3, 41, 18,
        41, 41, 33, 16, 17,  6, 41, 41, 41, 41,  3, 32, 16, 18,  6, 41,  2, 41,
        18, 41, 17, 11, 18, 33,  6, 41, 41, 10, 41,  6, 11, 18, 18, 26, 18, 32,
        16, 18], device='cuda:0')
2025-02-27 18:59:58,501 - TrainingScript - INFO - Batch 20 - Input shapes:
2025-02-27 18:59:58,501 - TrainingScript - INFO - Images: torch.Size([128, 3, 224, 224]), Heatmaps: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-02-27 18:59:58,680 - TrainingScript - ERROR - Invalid category labels found: tensor([41, 16, 41, 17, 41, 26, 19, 41, 16, 32, 18, 35, 41,  3, 17,  3, 11, 11,
        16,  3, 18,  3, 35, 17, 33, 32, 18, 32, 39, 42, 33, 17, 41, 17, 32, 41,
        32, 18, 17, 34, 41, 41, 36,  3,  3,  3, 19, 17,  3, 41, 41, 42, 18, 17,
        35,  6, 32, 48, 29, 18,  6, 41, 41, 43, 33, 41, 11, 35, 41, 18, 10,  2,
         2, 32, 41, 41, 41, 30, 41, 26,  2,  3, 18, 10, 18,  3, 41, 41, 18, 16,
        26, 41, 32, 41, 19,  6, 41, 17,  2, 26, 41,  6, 42, 41,  3, 41,  3, 10,
        41, 18, 19, 18, 32,  3, 16, 48, 33, 30, 41, 17, 32, 41, 33,  3, 19, 16,
        41,  3], device='cuda:0')
2025-02-27 18:59:58,685 - TrainingScript - INFO - Batch 21 - Input shapes:
2025-02-27 18:59:58,685 - TrainingScript - INFO - Images: torch.Size([128, 3, 224, 224]), Heatmaps: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-02-27 18:59:58,813 - TrainingScript - ERROR - Invalid category labels found: tensor([26,  5, 16,  3, 48, 11, 32, 17, 18, 29,  3, 41,  3, 18, 41, 44, 41, 48,
        33, 41, 18, 19, 33, 18, 18, 11,  3, 26, 16,  6, 18, 32, 16, 41, 33, 41,
        19, 33, 17, 41, 41, 48,  3, 10, 41,  6, 18,  3, 29, 16, 41, 41,  3, 19,
        42, 18, 18,  3, 19, 32, 32, 33, 41, 13, 41, 41, 32, 42, 41, 41, 18, 16,
         6, 41,  3,  3, 48,  3, 16, 34, 18, 17, 26, 41, 41, 41, 18, 19, 17, 11,
        19, 32, 26, 41, 11, 41, 17,  3, 41, 17,  3, 18, 18, 32,  3, 41, 32, 41,
        41,  2, 10,  3, 33,  6, 16, 32, 18, 16, 33, 41, 19, 42, 41, 18, 42,  6,
        41, 18], device='cuda:0')
2025-02-27 19:00:01,753 - TrainingScript - INFO - Batch 22 - Input shapes:
2025-02-27 19:00:01,753 - TrainingScript - INFO - Images: torch.Size([128, 3, 224, 224]), Heatmaps: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-02-27 19:00:01,939 - TrainingScript - ERROR - Invalid category labels found: tensor([17, 41, 34, 13,  3, 48, 18,  6, 11, 41, 41, 41,  6, 41, 41, 32, 41,  6,
        41, 12, 11, 33,  6, 18, 41, 12, 17, 41, 41, 41, 33, 41, 48, 17, 41, 18,
        41, 27, 41, 18,  3, 18, 41, 33, 17, 17, 18, 48, 41,  2, 41, 11, 48,  6,
        41,  2, 19, 32, 16, 33, 17, 41, 42, 19,  2,  3,  2, 32, 18, 16, 41, 41,
        32, 48, 42, 41, 18, 18, 41, 41, 18,  3, 41, 41, 41, 34, 33, 16, 33, 41,
        32, 19,  3,  6,  3, 33, 18, 32, 18, 11, 34, 16, 18, 24, 41, 41, 17, 32,
        41, 33, 41, 19, 15, 42, 48, 41, 18, 17, 41, 16,  6, 41,  6,  2, 33, 26,
        41, 18], device='cuda:0')
2025-02-27 19:00:01,941 - TrainingScript - INFO - Batch 23 - Input shapes:
2025-02-27 19:00:01,941 - TrainingScript - INFO - Images: torch.Size([128, 3, 224, 224]), Heatmaps: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-02-27 19:00:02,014 - TrainingScript - ERROR - Invalid category labels found: tensor([ 6, 27, 16, 41, 16, 16,  3, 10, 32, 41, 16, 33, 11, 19, 10, 15, 48, 26,
        41, 17, 41, 18,  3, 41,  6,  2, 41, 16, 39,  6,  2,  9, 33, 42, 18, 16,
        41, 18, 41, 18, 18, 34, 42, 17, 18, 32, 16, 18, 33, 26, 46, 16, 41, 16,
         6,  2, 41, 26, 26, 17, 41, 41, 18, 41, 29, 18, 17,  3, 33, 19, 41, 18,
         3, 29, 19, 41, 41, 41, 33, 42, 17, 48, 41, 10, 18, 16,  9, 48, 32, 11,
         2, 16, 41, 32, 41,  3, 33,  3, 44,  3, 18, 18, 41, 32, 19,  6, 30, 17,
        41, 18, 26,  3, 17, 41, 41, 17, 18, 16, 41,  2, 11, 16, 41, 32,  2, 41,
         3, 34], device='cuda:0')
2025-02-27 19:00:05,255 - TrainingScript - INFO - Batch 24 - Input shapes:
2025-02-27 19:00:05,255 - TrainingScript - INFO - Images: torch.Size([128, 3, 224, 224]), Heatmaps: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-02-27 19:00:05,442 - TrainingScript - ERROR - Invalid category labels found: tensor([16, 18, 34, 17, 32, 17, 41, 32, 18, 41, 41, 18, 16, 41,  3, 41, 41, 18,
        41, 33, 10, 30, 41, 41, 16, 18, 18, 41, 11, 17, 32,  3, 41, 11, 41,  6,
         6, 41, 41, 18,  3, 18, 18, 17, 33, 33, 41, 29, 26, 29, 32, 19, 32,  3,
        18,  6, 11, 41, 33, 41, 24, 41, 41, 19,  6, 41, 18, 16, 17, 41, 18, 26,
         2, 19, 16, 18, 26, 41,  2, 10, 19, 41,  2, 34, 32, 48, 48, 18,  3, 19,
        41, 41, 17,  3, 18, 41, 41, 41,  3, 41, 11,  3,  3, 33, 18,  2, 15, 41,
        41, 41, 18, 33,  2,  3, 18, 22, 33,  6, 18,  3, 33, 18, 18,  3, 26, 32,
        41, 41], device='cuda:0')
2025-02-27 19:00:05,442 - TrainingScript - INFO - Batch 25 - Input shapes:
2025-02-27 19:00:05,442 - TrainingScript - INFO - Images: torch.Size([128, 3, 224, 224]), Heatmaps: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-02-27 19:00:05,612 - TrainingScript - ERROR - Invalid category labels found: tensor([18, 18, 18, 11, 18, 18, 11, 41,  3,  2, 41, 29, 48, 11, 11, 41, 32, 18,
         6, 41, 41, 16, 48, 18, 18, 41, 41, 32, 41, 41, 19, 16, 42, 41, 16, 41,
        41, 18, 26, 32, 32, 32, 32, 41, 41, 48,  3, 32,  3, 33, 41,  3, 11, 41,
        27, 41, 41, 19, 17, 41, 41, 16, 41,  3, 18, 35, 41,  6, 26, 41, 18, 41,
        41, 10, 33, 18,  3, 17, 33, 17,  6, 41, 18, 19, 17, 41,  7, 41, 41, 26,
        19, 36, 19,  6, 32, 41, 41, 17, 41, 32, 17,  3,  3, 10,  2, 18, 16, 18,
        48, 18, 19, 19, 11, 17, 41, 33, 44, 18, 41,  6, 16, 33, 16, 32,  6, 17,
        41, 18], device='cuda:0')
2025-02-27 19:00:08,723 - TrainingScript - INFO - Batch 26 - Input shapes:
2025-02-27 19:00:08,723 - TrainingScript - INFO - Images: torch.Size([128, 3, 224, 224]), Heatmaps: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-02-27 19:00:08,908 - TrainingScript - ERROR - Invalid category labels found: tensor([44, 41, 17, 24,  3, 19, 30, 16, 11, 41, 43, 18, 41, 10,  3,  3, 18, 11,
        32, 42, 10,  2,  3, 41, 41, 17, 32, 32, 32, 18,  6, 22, 33,  6,  3, 12,
        41, 41, 41, 39, 41, 41, 17, 48, 48, 41, 41, 30, 35, 41,  3,  3, 18, 30,
        16,  3, 33, 41, 41, 18, 42, 10, 11, 17, 41, 42, 30,  3, 42, 18, 46, 18,
         5, 10, 17, 16, 42, 41, 41,  2, 30, 32, 18, 41, 41, 17,  3, 41, 18, 41,
         3, 32, 18, 41, 32, 41, 48,  2, 33, 41,  3, 41,  2,  9, 24, 17, 41, 18,
        11, 17, 32,  3, 41, 48, 41, 18, 18, 42, 42, 41, 18, 33,  5, 19, 41, 11,
        11,  3], device='cuda:0')
2025-02-27 19:00:08,908 - TrainingScript - INFO - Batch 27 - Input shapes:
2025-02-27 19:00:08,908 - TrainingScript - INFO - Images: torch.Size([128, 3, 224, 224]), Heatmaps: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-02-27 19:00:09,015 - TrainingScript - ERROR - Invalid category labels found: tensor([17,  3, 42, 18, 18, 32, 33, 16, 41, 18,  6, 17, 41, 44, 11,  3, 16, 16,
        17, 16, 11, 42, 41, 18, 33,  3, 18, 42, 18, 18, 17, 11, 41, 11, 41, 18,
        41, 41, 32, 41, 11, 29, 33, 41, 41,  6, 17, 32, 26,  3, 35, 30, 41,  2,
        48,  3, 41,  2, 41, 26, 19, 48, 35, 41, 33, 11, 42,  6, 16, 41, 36, 41,
        41, 18, 41,  6, 32, 18, 17, 32, 19,  2, 11, 18, 16, 41, 41, 41, 33, 41,
        17,  3, 42,  3, 11, 19, 41, 34, 11, 10, 41, 18, 41, 18, 41, 41, 18, 30,
         3, 18, 16,  6, 41, 44, 24,  3,  6, 41, 33, 48, 10, 41, 11,  3, 32, 26,
        42, 17], device='cuda:0')
2025-02-27 19:00:11,993 - TrainingScript - INFO - Batch 28 - Input shapes:
2025-02-27 19:00:11,994 - TrainingScript - INFO - Images: torch.Size([128, 3, 224, 224]), Heatmaps: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-02-27 19:00:12,176 - TrainingScript - ERROR - Invalid category labels found: tensor([41, 33, 18, 41, 32, 18, 39, 11, 41, 16, 41,  6, 18, 17, 41, 16, 16,  2,
         3,  3, 18, 41, 41, 41, 24, 48, 41, 41, 30, 19, 41, 32,  6,  6, 32, 41,
         6, 18, 41, 33, 30, 11, 30,  3,  6, 41, 18, 41, 41, 41, 32, 18, 19, 39,
        26, 30, 19, 41, 27, 41,  6, 42, 17, 19, 44, 41, 32, 42,  2, 41, 44, 41,
        34, 19,  2, 41, 33, 34, 16, 18, 41, 41, 16, 41,  3, 18, 18, 41, 16, 44,
         3, 26, 41, 33, 35,  2, 41, 19, 11,  6,  2, 32,  6, 32, 19, 48, 41, 33,
        16, 18, 18, 18, 42, 26, 41, 18, 41,  3, 18, 33,  6, 16, 42, 11, 19, 17,
         3, 32], device='cuda:0')
2025-02-27 19:00:12,176 - TrainingScript - INFO - Batch 29 - Input shapes:
2025-02-27 19:00:12,176 - TrainingScript - INFO - Images: torch.Size([128, 3, 224, 224]), Heatmaps: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-02-27 19:00:12,226 - TrainingScript - ERROR - Invalid category labels found: tensor([26,  6,  1, 18, 41,  3, 39, 32, 33, 32, 41, 41, 18, 41, 41, 33, 41, 26,
        18, 41,  2, 26, 18, 41, 44, 41, 41, 11, 18, 41, 41, 41, 10, 41, 48, 16,
         3, 39, 32, 19, 16, 39, 18, 39, 18, 19, 41, 19, 41, 41, 17, 18,  3, 32,
        41, 41, 10, 41, 17, 17, 41, 18, 41, 11, 39, 32, 42, 41, 41, 48, 18, 41,
         2,  3, 16, 18, 29, 41, 42, 18, 18, 34, 41, 33, 42, 30, 41, 33, 18, 19,
        41, 32, 18, 16, 18,  3, 16, 26, 18, 41, 41, 41,  3, 41, 19, 33, 41, 35,
        26, 26, 41, 41, 19, 41, 17, 17, 41, 41, 41, 11, 41, 29, 19, 39, 18, 41,
         6, 30], device='cuda:0')
2025-02-27 19:00:15,438 - TrainingScript - INFO - Batch 30 - Input shapes:
2025-02-27 19:00:15,438 - TrainingScript - INFO - Images: torch.Size([128, 3, 224, 224]), Heatmaps: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-02-27 19:00:15,619 - TrainingScript - ERROR - Invalid category labels found: tensor([26, 30, 10, 33, 39, 18, 34, 32, 29, 44, 41, 33, 11, 41, 11, 18, 34, 18,
         6, 18, 41, 18, 10, 24, 17, 30, 41, 39, 18, 41, 24, 10, 19, 11, 19,  6,
        33, 18, 18, 42,  3, 18, 33, 41, 18, 18, 32, 30, 17, 41, 18, 41, 41, 41,
         9, 29, 18, 41, 18, 18, 42, 26, 41, 32, 33,  6, 17, 18, 41, 29, 26, 18,
        17, 30,  3,  3, 16, 44, 47, 41, 16, 41, 41, 10, 11, 41, 33, 32, 19, 17,
        17,  6, 35, 41, 41, 48, 32, 41, 42, 32, 16, 41, 41, 17,  3, 41, 17,  2,
         3, 41, 17, 33, 18, 48, 41, 41, 32, 41, 34, 18, 41, 41, 18, 41, 33, 11,
        18, 11], device='cuda:0')
2025-02-27 19:00:15,619 - TrainingScript - INFO - Batch 31 - Input shapes:
2025-02-27 19:00:15,619 - TrainingScript - INFO - Images: torch.Size([128, 3, 224, 224]), Heatmaps: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-02-27 19:00:15,652 - TrainingScript - ERROR - Invalid category labels found: tensor([19,  3, 41, 29, 29, 41, 17, 41, 32, 48, 32,  3,  6, 42, 11, 41, 41, 48,
        32, 41, 30, 17, 16, 10,  6, 18, 41, 18, 41,  3,  3, 32, 18, 41,  6, 41,
        29, 48, 41, 41, 42, 41, 41,  3, 26, 41, 19, 15, 32, 32,  6,  6, 33, 41,
        41, 41, 17, 17, 11,  3, 16, 41, 42, 29, 32, 41,  3, 32, 30, 18,  3, 41,
        41, 41, 32,  3, 18, 19, 19,  3, 41, 41, 18, 41, 16,  3,  3,  3, 11, 18,
        16, 16,  3, 41,  3, 16, 41,  3, 16, 41, 41, 17, 11, 16, 41, 41, 41,  3,
        41,  3, 18, 32,  2, 17,  3, 32, 41, 18, 41,  2,  3, 41,  3,  3,  6, 41,
        48,  2], device='cuda:0')
2025-02-27 19:00:19,157 - TrainingScript - INFO - Batch 32 - Input shapes:
2025-02-27 19:00:19,157 - TrainingScript - INFO - Images: torch.Size([128, 3, 224, 224]), Heatmaps: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-02-27 19:00:19,345 - TrainingScript - ERROR - Invalid category labels found: tensor([19, 33, 18, 41, 41, 19,  9, 18, 41,  6, 48, 41, 41, 19,  6, 41, 33, 11,
         3,  2,  6, 18, 17, 26, 41, 16, 17, 41,  3, 18, 18, 18,  6, 33, 41,  2,
        41, 41, 19, 26,  6,  3, 11, 41, 41,  3, 44, 32, 33, 18, 10, 41,  2,  3,
         3, 10, 17,  2, 41, 41, 33,  3, 41, 17, 17, 16, 18,  6,  3,  6, 17, 32,
        41, 41, 32,  3,  3, 18, 41, 41, 16, 41,  3,  3,  3, 16, 18,  6, 19, 18,
        33, 18, 16,  3,  6, 11, 41,  3, 33, 32, 11, 24, 32, 16,  2,  6, 30, 19,
        11, 32,  6, 18,  3, 33, 11, 41, 41, 41, 41, 10, 30, 41,  2, 41, 34, 33,
        11,  3], device='cuda:0')
2025-02-27 19:00:19,345 - TrainingScript - INFO - Batch 33 - Input shapes:
2025-02-27 19:00:19,345 - TrainingScript - INFO - Images: torch.Size([128, 3, 224, 224]), Heatmaps: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-02-27 19:00:19,415 - TrainingScript - ERROR - Invalid category labels found: tensor([36, 41,  3, 41, 41, 18, 18, 16, 18, 41, 41,  3, 41, 32, 18, 41, 19, 12,
        41, 26, 10, 41,  6, 41,  2, 41, 41, 18, 33, 41, 48, 32,  3, 41, 17, 48,
        18, 41, 32, 42, 30, 26, 41,  3, 17, 41, 41, 32, 11, 41, 32,  2, 41, 41,
        18, 33, 24,  6, 30, 16, 32, 44, 41, 32,  3, 41,  3, 41, 41, 41, 11, 11,
        18, 41, 41,  4, 29, 41, 41, 33, 16, 41,  3, 33, 16, 41,  3, 10, 32, 41,
        17, 17, 16,  3,  3, 41, 17,  6, 41, 33, 17, 33, 44, 12, 41, 41, 16,  3,
        32, 33,  2, 17, 10, 18, 41,  3,  2,  3, 18, 30, 18, 41,  2,  3,  6, 41,
         2, 18], device='cuda:0')
2025-02-27 19:00:22,581 - TrainingScript - INFO - Batch 34 - Input shapes:
2025-02-27 19:00:22,583 - TrainingScript - INFO - Images: torch.Size([128, 3, 224, 224]), Heatmaps: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-02-27 19:00:22,752 - TrainingScript - ERROR - Invalid category labels found: tensor([ 7, 41, 41, 18, 11,  6, 18, 33, 41, 41, 11, 41, 19,  2, 33, 41,  3, 16,
         3, 30, 33, 26, 48, 41, 19, 41, 48,  3, 32, 17, 32, 41, 33, 32, 41, 41,
        32, 18, 41, 26, 41, 41, 33,  5, 17, 44,  2, 19, 16, 44, 41,  9, 18, 41,
        18, 11, 32,  3, 41, 18, 39, 48, 32, 41, 34, 18, 41, 41, 26, 18, 32, 18,
         3,  3, 17, 32, 33, 32,  2, 22, 26, 34, 17,  6, 17, 41,  3, 29,  6, 33,
        11, 48, 17, 16, 33, 48, 39, 26, 32, 41, 33, 34, 34, 18, 18,  3,  6, 41,
        34, 18, 32,  3, 44, 29, 41, 29, 18, 41,  3, 44, 33, 18, 16,  6, 41, 18,
        41, 30], device='cuda:0')
2025-02-27 19:00:22,752 - TrainingScript - INFO - Batch 35 - Input shapes:
2025-02-27 19:00:22,752 - TrainingScript - INFO - Images: torch.Size([128, 3, 224, 224]), Heatmaps: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-02-27 19:00:22,817 - TrainingScript - ERROR - Invalid category labels found: tensor([41, 16, 48, 18, 11, 32, 41, 18, 41,  3, 17, 18,  6, 42, 48,  2,  6, 19,
        32, 32, 41, 11, 18, 18,  6, 12,  3, 41, 41, 41, 41, 33,  3, 17, 32, 18,
        18, 33, 19, 48, 15, 48, 41, 41, 16, 41, 33,  2, 29,  1, 11, 17, 16, 17,
        41, 32, 11, 41, 41, 18, 18, 41, 30, 11, 29, 48,  3,  3, 41, 33, 18, 11,
         6, 41, 41,  3, 41,  6, 41, 41,  6,  3, 41, 32, 18, 33, 18,  1, 18, 48,
        16, 41, 17,  2, 41, 18, 32,  2, 17, 42, 33, 41, 24,  3, 41, 29,  3, 41,
        18, 41, 16, 33, 41, 41, 17, 32, 18, 41, 41, 41, 41, 41,  3,  3, 10, 41,
        41, 19], device='cuda:0')
2025-02-27 19:00:25,953 - TrainingScript - INFO - Batch 36 - Input shapes:
2025-02-27 19:00:25,953 - TrainingScript - INFO - Images: torch.Size([128, 3, 224, 224]), Heatmaps: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-02-27 19:00:26,135 - TrainingScript - ERROR - Invalid category labels found: tensor([32, 41,  2, 41, 41, 41,  3, 32, 33, 41,  3, 18, 32, 18,  2, 41, 17, 18,
        33, 16, 47, 32, 33,  3, 32, 42, 19, 42, 32, 32, 18, 41, 41, 39, 42, 32,
        26, 41, 41, 41, 48, 21, 48, 41, 41, 19, 48, 18, 41, 10,  6, 33, 41, 15,
        41, 33, 16, 27, 32, 19, 18,  2, 18, 34, 18, 32, 32, 11, 41, 32, 16, 10,
        17, 30, 41, 19, 19, 32, 10, 18, 11, 19, 29, 42, 41, 41,  3, 19, 10, 29,
        11, 29, 30, 18,  3, 41,  2, 33, 48, 18,  2, 17, 17, 41, 29, 41,  3, 13,
        10, 41, 34, 48,  3, 32, 18, 32, 17,  3, 18, 18, 41, 41, 11, 41, 16, 10,
        18, 10], device='cuda:0')
2025-02-27 19:00:26,137 - TrainingScript - INFO - Batch 37 - Input shapes:
2025-02-27 19:00:26,137 - TrainingScript - INFO - Images: torch.Size([128, 3, 224, 224]), Heatmaps: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-02-27 19:00:26,210 - TrainingScript - ERROR - Invalid category labels found: tensor([17, 34, 19,  3, 30, 19, 29, 33, 19, 18, 19, 41, 33, 41, 41, 41, 26, 33,
        41, 32, 32,  3, 17, 41, 32, 33, 27, 26, 26, 16, 33, 26, 41,  3, 32, 41,
        29, 33, 41, 41, 11,  6, 41, 18,  3, 41, 16,  2, 41,  3, 39, 24, 32, 41,
        42, 41, 41, 18, 41, 48, 32, 33, 44, 41, 26, 42, 11, 41, 18, 30, 41, 19,
        13, 33, 42, 41, 48, 41, 10, 26, 48,  6, 41, 33, 41,  6, 19, 16, 17, 32,
        41, 16, 32, 41, 11, 33, 42, 18, 18, 41, 18, 33, 17, 17,  3, 18, 18, 10,
         3, 10, 11, 41, 44, 19, 41, 32, 33, 33, 41,  3, 48, 29,  3,  6, 41,  3,
        41, 33], device='cuda:0')
2025-02-27 19:53:07,058 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-02-27 19:53:07,894 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-02-27 19:53:07,894 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-02-27 19:53:07,897 - FashionDataset - INFO - Extracted 50 attribute columns
2025-02-27 19:53:07,898 - FashionDataset - INFO - Created category mapping with 46 categories
2025-02-27 19:53:07,898 - FashionDataset - INFO - Validating dataset files...
2025-02-27 19:53:07,952 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-02-27 19:53:07,952 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-02-27 19:53:08,131 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-02-27 19:53:08,131 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-02-27 19:53:08,131 - FashionDataset - INFO - Extracted 50 attribute columns
2025-02-27 19:53:08,131 - FashionDataset - INFO - Created category mapping with 46 categories
2025-02-27 19:53:08,131 - FashionDataset - INFO - Validating dataset files...
2025-02-27 19:53:08,183 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-02-27 19:53:08,183 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-02-27 19:53:08,183 - FashionHybridModel - INFO - Parameters: num_categories=46, num_category_types=3, num_attributes=50, embed_dim=256
2025-02-27 19:53:08,636 - FashionHybridModel - INFO - Heatmap encoder initialized with output dimension: 256
2025-02-27 20:20:54,711 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-02-27 20:20:55,586 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-02-27 20:20:55,591 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-02-27 20:20:55,591 - FashionDataset - INFO - Extracted 50 attribute columns
2025-02-27 20:20:55,599 - FashionDataset - INFO - Original unique categories: [18 17 41 32 33  3 19 30 10 16 48 23 44 42 15  6 29  2 11 34 26 24 35 27
 12 39  7  9 22  5 20 36 13 14 21 25  1 47 43  8 46  4 37 28 40 31]
2025-02-27 20:20:55,600 - FashionDataset - INFO - Category mapping: {np.int64(1): 0, np.int64(2): 1, np.int64(3): 2, np.int64(4): 3, np.int64(5): 4, np.int64(6): 5, np.int64(7): 6, np.int64(8): 7, np.int64(9): 8, np.int64(10): 9, np.int64(11): 10, np.int64(12): 11, np.int64(13): 12, np.int64(14): 13, np.int64(15): 14, np.int64(16): 15, np.int64(17): 16, np.int64(18): 17, np.int64(19): 18, np.int64(20): 19, np.int64(21): 20, np.int64(22): 21, np.int64(23): 22, np.int64(24): 23, np.int64(25): 24, np.int64(26): 25, np.int64(27): 26, np.int64(28): 27, np.int64(29): 28, np.int64(30): 29, np.int64(31): 30, np.int64(32): 31, np.int64(33): 32, np.int64(34): 33, np.int64(35): 34, np.int64(36): 35, np.int64(37): 36, np.int64(39): 37, np.int64(40): 38, np.int64(41): 39, np.int64(42): 40, np.int64(43): 41, np.int64(44): 42, np.int64(46): 43, np.int64(47): 44, np.int64(48): 45}
2025-02-27 20:20:55,612 - FashionDataset - INFO - Remapped unique categories: [17 16 39 31 32  2 18 29  9 15 45 22 42 40 14  5 28  1 10 33 25 23 34 26
 11 37  6  8 21  4 19 35 12 13 20 24  0 44 41  7 43  3 36 27 38 30]
2025-02-27 20:20:55,616 - FashionDataset - INFO - Created category mapping with 46 categories
2025-02-27 20:20:55,616 - FashionDataset - INFO - Validating dataset files...
2025-02-27 20:20:55,687 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-02-27 20:20:55,687 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-02-27 20:20:55,874 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-02-27 20:20:55,874 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-02-27 20:20:55,874 - FashionDataset - INFO - Extracted 50 attribute columns
2025-02-27 20:20:55,874 - FashionDataset - INFO - Original unique categories: [18 17 41 32 33  3 19 30 10 16 48 23 44 42 15  6 29  2 11 34 26 24 35 27
 12 39  7  9 22  5 20 36 13 14 21 25  1 47 43  8 46  4 37 28 40 31]
2025-02-27 20:20:55,874 - FashionDataset - INFO - Category mapping: {np.int64(1): 0, np.int64(2): 1, np.int64(3): 2, np.int64(4): 3, np.int64(5): 4, np.int64(6): 5, np.int64(7): 6, np.int64(8): 7, np.int64(9): 8, np.int64(10): 9, np.int64(11): 10, np.int64(12): 11, np.int64(13): 12, np.int64(14): 13, np.int64(15): 14, np.int64(16): 15, np.int64(17): 16, np.int64(18): 17, np.int64(19): 18, np.int64(20): 19, np.int64(21): 20, np.int64(22): 21, np.int64(23): 22, np.int64(24): 23, np.int64(25): 24, np.int64(26): 25, np.int64(27): 26, np.int64(28): 27, np.int64(29): 28, np.int64(30): 29, np.int64(31): 30, np.int64(32): 31, np.int64(33): 32, np.int64(34): 33, np.int64(35): 34, np.int64(36): 35, np.int64(37): 36, np.int64(39): 37, np.int64(40): 38, np.int64(41): 39, np.int64(42): 40, np.int64(43): 41, np.int64(44): 42, np.int64(46): 43, np.int64(47): 44, np.int64(48): 45}
2025-02-27 20:20:55,874 - FashionDataset - INFO - Remapped unique categories: [17 16 39 31 32  2 18 29  9 15 45 22 42 40 14  5 28  1 10 33 25 23 34 26
 11 37  6  8 21  4 19 35 12 13 20 24  0 44 41  7 43  3 36 27 38 30]
2025-02-27 20:20:55,874 - FashionDataset - INFO - Created category mapping with 46 categories
2025-02-27 20:20:55,874 - FashionDataset - INFO - Validating dataset files...
2025-02-27 20:20:55,913 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-02-27 20:20:55,913 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-02-27 20:20:55,913 - FashionHybridModel - INFO - Parameters: num_categories=50, num_category_types=3, num_attributes=50, embed_dim=256
2025-02-27 20:20:56,381 - FashionHybridModel - INFO - Heatmap encoder initialized with output dimension: 256
2025-02-27 20:41:54,875 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-02-27 20:41:55,680 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-02-27 20:41:55,680 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-02-27 20:41:55,686 - FashionDataset - INFO - Extracted 50 attribute columns
2025-02-27 20:41:55,689 - FashionDataset - INFO - Original unique categories: [18 17 41 32 33  3 19 30 10 16 48 23 44 42 15  6 29  2 11 34 26 24 35 27
 12 39  7  9 22  5 20 36 13 14 21 25  1 47 43  8 46  4 37 28 40 31]
2025-02-27 20:41:55,689 - FashionDataset - INFO - Category mapping: {np.int64(1): 0, np.int64(2): 1, np.int64(3): 2, np.int64(4): 3, np.int64(5): 4, np.int64(6): 5, np.int64(7): 6, np.int64(8): 7, np.int64(9): 8, np.int64(10): 9, np.int64(11): 10, np.int64(12): 11, np.int64(13): 12, np.int64(14): 13, np.int64(15): 14, np.int64(16): 15, np.int64(17): 16, np.int64(18): 17, np.int64(19): 18, np.int64(20): 19, np.int64(21): 20, np.int64(22): 21, np.int64(23): 22, np.int64(24): 23, np.int64(25): 24, np.int64(26): 25, np.int64(27): 26, np.int64(28): 27, np.int64(29): 28, np.int64(30): 29, np.int64(31): 30, np.int64(32): 31, np.int64(33): 32, np.int64(34): 33, np.int64(35): 34, np.int64(36): 35, np.int64(37): 36, np.int64(39): 37, np.int64(40): 38, np.int64(41): 39, np.int64(42): 40, np.int64(43): 41, np.int64(44): 42, np.int64(46): 43, np.int64(47): 44, np.int64(48): 45}
2025-02-27 20:41:55,692 - FashionDataset - INFO - Remapped unique categories: [17 16 39 31 32  2 18 29  9 15 45 22 42 40 14  5 28  1 10 33 25 23 34 26
 11 37  6  8 21  4 19 35 12 13 20 24  0 44 41  7 43  3 36 27 38 30]
2025-02-27 20:41:55,696 - FashionDataset - INFO - Created category mapping with 46 categories
2025-02-27 20:41:55,696 - FashionDataset - INFO - Validating dataset files...
2025-02-27 20:41:55,737 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-02-27 20:41:55,737 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-02-27 20:41:55,874 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-02-27 20:41:55,874 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-02-27 20:41:55,890 - FashionDataset - INFO - Extracted 50 attribute columns
2025-02-27 20:41:55,890 - FashionDataset - INFO - Original unique categories: [18 17 41 32 33  3 19 30 10 16 48 23 44 42 15  6 29  2 11 34 26 24 35 27
 12 39  7  9 22  5 20 36 13 14 21 25  1 47 43  8 46  4 37 28 40 31]
2025-02-27 20:41:55,890 - FashionDataset - INFO - Category mapping: {np.int64(1): 0, np.int64(2): 1, np.int64(3): 2, np.int64(4): 3, np.int64(5): 4, np.int64(6): 5, np.int64(7): 6, np.int64(8): 7, np.int64(9): 8, np.int64(10): 9, np.int64(11): 10, np.int64(12): 11, np.int64(13): 12, np.int64(14): 13, np.int64(15): 14, np.int64(16): 15, np.int64(17): 16, np.int64(18): 17, np.int64(19): 18, np.int64(20): 19, np.int64(21): 20, np.int64(22): 21, np.int64(23): 22, np.int64(24): 23, np.int64(25): 24, np.int64(26): 25, np.int64(27): 26, np.int64(28): 27, np.int64(29): 28, np.int64(30): 29, np.int64(31): 30, np.int64(32): 31, np.int64(33): 32, np.int64(34): 33, np.int64(35): 34, np.int64(36): 35, np.int64(37): 36, np.int64(39): 37, np.int64(40): 38, np.int64(41): 39, np.int64(42): 40, np.int64(43): 41, np.int64(44): 42, np.int64(46): 43, np.int64(47): 44, np.int64(48): 45}
2025-02-27 20:41:55,890 - FashionDataset - INFO - Remapped unique categories: [17 16 39 31 32  2 18 29  9 15 45 22 42 40 14  5 28  1 10 33 25 23 34 26
 11 37  6  8 21  4 19 35 12 13 20 24  0 44 41  7 43  3 36 27 38 30]
2025-02-27 20:41:55,890 - FashionDataset - INFO - Created category mapping with 46 categories
2025-02-27 20:41:55,890 - FashionDataset - INFO - Validating dataset files...
2025-02-27 20:41:55,920 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-02-27 20:41:55,929 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-02-27 20:41:55,929 - FashionHybridModel - INFO - Parameters: num_categories=50, num_category_types=3, num_attributes=50, embed_dim=256
2025-02-27 20:41:56,249 - FashionHybridModel - INFO - Heatmap encoder initialized with output dimension: 256
2025-02-27 20:49:35,284 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-02-27 20:49:36,048 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-02-27 20:49:36,048 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-02-27 20:49:36,048 - FashionDataset - INFO - Extracted 50 attribute columns
2025-02-27 20:49:36,052 - FashionDataset - INFO - Original unique categories: [18 17 41 32 33  3 19 30 10 16 48 23 44 42 15  6 29  2 11 34 26 24 35 27
 12 39  7  9 22  5 20 36 13 14 21 25  1 47 43  8 46  4 37 28 40 31]
2025-02-27 20:49:36,053 - FashionDataset - INFO - Category mapping: {np.int64(1): 0, np.int64(2): 1, np.int64(3): 2, np.int64(4): 3, np.int64(5): 4, np.int64(6): 5, np.int64(7): 6, np.int64(8): 7, np.int64(9): 8, np.int64(10): 9, np.int64(11): 10, np.int64(12): 11, np.int64(13): 12, np.int64(14): 13, np.int64(15): 14, np.int64(16): 15, np.int64(17): 16, np.int64(18): 17, np.int64(19): 18, np.int64(20): 19, np.int64(21): 20, np.int64(22): 21, np.int64(23): 22, np.int64(24): 23, np.int64(25): 24, np.int64(26): 25, np.int64(27): 26, np.int64(28): 27, np.int64(29): 28, np.int64(30): 29, np.int64(31): 30, np.int64(32): 31, np.int64(33): 32, np.int64(34): 33, np.int64(35): 34, np.int64(36): 35, np.int64(37): 36, np.int64(39): 37, np.int64(40): 38, np.int64(41): 39, np.int64(42): 40, np.int64(43): 41, np.int64(44): 42, np.int64(46): 43, np.int64(47): 44, np.int64(48): 45}
2025-02-27 20:49:36,053 - FashionDataset - INFO - Remapped unique categories: [17 16 39 31 32  2 18 29  9 15 45 22 42 40 14  5 28  1 10 33 25 23 34 26
 11 37  6  8 21  4 19 35 12 13 20 24  0 44 41  7 43  3 36 27 38 30]
2025-02-27 20:49:36,059 - FashionDataset - INFO - Created category mapping with 46 categories
2025-02-27 20:49:36,059 - FashionDataset - INFO - Validating dataset files...
2025-02-27 20:49:36,091 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-02-27 20:49:36,091 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-02-27 20:49:36,239 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-02-27 20:49:36,239 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-02-27 20:49:36,239 - FashionDataset - INFO - Extracted 50 attribute columns
2025-02-27 20:49:36,239 - FashionDataset - INFO - Original unique categories: [18 17 41 32 33  3 19 30 10 16 48 23 44 42 15  6 29  2 11 34 26 24 35 27
 12 39  7  9 22  5 20 36 13 14 21 25  1 47 43  8 46  4 37 28 40 31]
2025-02-27 20:49:36,239 - FashionDataset - INFO - Category mapping: {np.int64(1): 0, np.int64(2): 1, np.int64(3): 2, np.int64(4): 3, np.int64(5): 4, np.int64(6): 5, np.int64(7): 6, np.int64(8): 7, np.int64(9): 8, np.int64(10): 9, np.int64(11): 10, np.int64(12): 11, np.int64(13): 12, np.int64(14): 13, np.int64(15): 14, np.int64(16): 15, np.int64(17): 16, np.int64(18): 17, np.int64(19): 18, np.int64(20): 19, np.int64(21): 20, np.int64(22): 21, np.int64(23): 22, np.int64(24): 23, np.int64(25): 24, np.int64(26): 25, np.int64(27): 26, np.int64(28): 27, np.int64(29): 28, np.int64(30): 29, np.int64(31): 30, np.int64(32): 31, np.int64(33): 32, np.int64(34): 33, np.int64(35): 34, np.int64(36): 35, np.int64(37): 36, np.int64(39): 37, np.int64(40): 38, np.int64(41): 39, np.int64(42): 40, np.int64(43): 41, np.int64(44): 42, np.int64(46): 43, np.int64(47): 44, np.int64(48): 45}
2025-02-27 20:49:36,239 - FashionDataset - INFO - Remapped unique categories: [17 16 39 31 32  2 18 29  9 15 45 22 42 40 14  5 28  1 10 33 25 23 34 26
 11 37  6  8 21  4 19 35 12 13 20 24  0 44 41  7 43  3 36 27 38 30]
2025-02-27 20:49:36,239 - FashionDataset - INFO - Created category mapping with 46 categories
2025-02-27 20:49:36,239 - FashionDataset - INFO - Validating dataset files...
2025-02-27 20:49:36,286 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-02-27 20:49:36,287 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-02-27 20:49:36,287 - FashionHybridModel - INFO - Parameters: num_categories=50, num_category_types=3, num_attributes=50, embed_dim=256
2025-02-27 20:49:36,686 - FashionHybridModel - INFO - Heatmap encoder initialized with output dimension: 256
2025-02-27 21:01:59,142 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-02-27 21:01:59,847 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-02-27 21:01:59,847 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-02-27 21:01:59,847 - FashionDataset - INFO - Extracted 50 attribute columns
2025-02-27 21:01:59,847 - FashionDataset - INFO - Original unique categories: [18 17 41 32 33  3 19 30 10 16 48 23 44 42 15  6 29  2 11 34 26 24 35 27
 12 39  7  9 22  5 20 36 13 14 21 25  1 47 43  8 46  4 37 28 40 31]
2025-02-27 21:01:59,847 - FashionDataset - INFO - Category mapping: {np.int64(1): 0, np.int64(2): 1, np.int64(3): 2, np.int64(4): 3, np.int64(5): 4, np.int64(6): 5, np.int64(7): 6, np.int64(8): 7, np.int64(9): 8, np.int64(10): 9, np.int64(11): 10, np.int64(12): 11, np.int64(13): 12, np.int64(14): 13, np.int64(15): 14, np.int64(16): 15, np.int64(17): 16, np.int64(18): 17, np.int64(19): 18, np.int64(20): 19, np.int64(21): 20, np.int64(22): 21, np.int64(23): 22, np.int64(24): 23, np.int64(25): 24, np.int64(26): 25, np.int64(27): 26, np.int64(28): 27, np.int64(29): 28, np.int64(30): 29, np.int64(31): 30, np.int64(32): 31, np.int64(33): 32, np.int64(34): 33, np.int64(35): 34, np.int64(36): 35, np.int64(37): 36, np.int64(39): 37, np.int64(40): 38, np.int64(41): 39, np.int64(42): 40, np.int64(43): 41, np.int64(44): 42, np.int64(46): 43, np.int64(47): 44, np.int64(48): 45}
2025-02-27 21:01:59,863 - FashionDataset - INFO - Remapped unique categories: [17 16 39 31 32  2 18 29  9 15 45 22 42 40 14  5 28  1 10 33 25 23 34 26
 11 37  6  8 21  4 19 35 12 13 20 24  0 44 41  7 43  3 36 27 38 30]
2025-02-27 21:01:59,868 - FashionDataset - INFO - Created category mapping with 46 categories
2025-02-27 21:01:59,868 - FashionDataset - INFO - Validating dataset files...
2025-02-27 21:01:59,902 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-02-27 21:01:59,909 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-02-27 21:02:00,061 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-02-27 21:02:00,061 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-02-27 21:02:00,067 - FashionDataset - INFO - Extracted 50 attribute columns
2025-02-27 21:02:00,068 - FashionDataset - INFO - Original unique categories: [18 17 41 32 33  3 19 30 10 16 48 23 44 42 15  6 29  2 11 34 26 24 35 27
 12 39  7  9 22  5 20 36 13 14 21 25  1 47 43  8 46  4 37 28 40 31]
2025-02-27 21:02:00,068 - FashionDataset - INFO - Category mapping: {np.int64(1): 0, np.int64(2): 1, np.int64(3): 2, np.int64(4): 3, np.int64(5): 4, np.int64(6): 5, np.int64(7): 6, np.int64(8): 7, np.int64(9): 8, np.int64(10): 9, np.int64(11): 10, np.int64(12): 11, np.int64(13): 12, np.int64(14): 13, np.int64(15): 14, np.int64(16): 15, np.int64(17): 16, np.int64(18): 17, np.int64(19): 18, np.int64(20): 19, np.int64(21): 20, np.int64(22): 21, np.int64(23): 22, np.int64(24): 23, np.int64(25): 24, np.int64(26): 25, np.int64(27): 26, np.int64(28): 27, np.int64(29): 28, np.int64(30): 29, np.int64(31): 30, np.int64(32): 31, np.int64(33): 32, np.int64(34): 33, np.int64(35): 34, np.int64(36): 35, np.int64(37): 36, np.int64(39): 37, np.int64(40): 38, np.int64(41): 39, np.int64(42): 40, np.int64(43): 41, np.int64(44): 42, np.int64(46): 43, np.int64(47): 44, np.int64(48): 45}
2025-02-27 21:02:00,069 - FashionDataset - INFO - Remapped unique categories: [17 16 39 31 32  2 18 29  9 15 45 22 42 40 14  5 28  1 10 33 25 23 34 26
 11 37  6  8 21  4 19 35 12 13 20 24  0 44 41  7 43  3 36 27 38 30]
2025-02-27 21:02:00,069 - FashionDataset - INFO - Created category mapping with 46 categories
2025-02-27 21:02:00,069 - FashionDataset - INFO - Validating dataset files...
2025-02-27 21:02:00,103 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-02-27 21:02:00,103 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-02-27 21:02:00,103 - FashionHybridModel - INFO - Parameters: num_categories=50, num_category_types=3, num_attributes=50, embed_dim=256
2025-02-27 21:02:00,409 - FashionHybridModel - INFO - Heatmap encoder initialized with output dimension: 256
2025-02-27 21:23:21,412 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-02-27 21:23:22,180 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-02-27 21:23:22,180 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-02-27 21:23:22,180 - FashionDataset - INFO - Extracted 50 attribute columns
2025-02-27 21:23:22,196 - FashionDataset - INFO - Created category mapping with 46 categories
2025-02-27 21:23:22,196 - FashionDataset - INFO - Validating dataset files...
2025-02-27 21:23:22,240 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-02-27 21:23:22,240 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-02-27 21:23:22,404 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-02-27 21:23:22,404 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-02-27 21:23:22,404 - FashionDataset - INFO - Extracted 50 attribute columns
2025-02-27 21:23:22,404 - FashionDataset - INFO - Created category mapping with 46 categories
2025-02-27 21:23:22,404 - FashionDataset - INFO - Validating dataset files...
2025-02-27 21:23:22,459 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-02-27 21:23:22,459 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-02-27 21:23:22,459 - FashionHybridModel - INFO - Parameters: num_categories=50, num_category_types=3, num_attributes=50, embed_dim=256
2025-02-27 21:23:22,759 - FashionHybridModel - INFO - Heatmap encoder initialized with output dimension: 256
2025-02-28 03:34:09,875 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-02-28 03:34:10,662 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-02-28 03:34:10,662 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-02-28 03:34:10,662 - FashionDataset - INFO - Extracted 50 attribute columns
2025-02-28 03:34:10,677 - FashionDataset - INFO - Created category mapping with 46 categories
2025-02-28 03:34:10,677 - FashionDataset - INFO - Validating dataset files...
2025-02-28 03:34:10,729 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-02-28 03:34:10,729 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-02-28 03:34:10,882 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-02-28 03:34:10,882 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-02-28 03:34:10,882 - FashionDataset - INFO - Extracted 50 attribute columns
2025-02-28 03:34:10,882 - FashionDataset - INFO - Created category mapping with 46 categories
2025-02-28 03:34:10,882 - FashionDataset - INFO - Validating dataset files...
2025-02-28 03:34:10,946 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-02-28 03:34:10,946 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-02-28 03:34:10,946 - FashionHybridModel - INFO - Parameters: num_categories=50, num_category_types=3, num_attributes=50, embed_dim=256
2025-02-28 03:34:11,388 - FashionHybridModel - INFO - Heatmap encoder initialized with output dimension: 256
2025-02-28 03:49:01,219 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-02-28 03:49:02,023 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-02-28 03:49:02,023 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-02-28 03:49:02,023 - FashionDataset - INFO - Extracted 50 attribute columns
2025-02-28 03:49:02,023 - FashionDataset - INFO - Created category mapping with 46 categories
2025-02-28 03:49:02,023 - FashionDataset - INFO - Validating dataset files...
2025-02-28 03:49:02,099 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-02-28 03:49:02,099 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-02-28 03:49:02,251 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-02-28 03:49:02,251 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-02-28 03:49:02,251 - FashionDataset - INFO - Extracted 50 attribute columns
2025-02-28 03:49:02,251 - FashionDataset - INFO - Created category mapping with 46 categories
2025-02-28 03:49:02,251 - FashionDataset - INFO - Validating dataset files...
2025-02-28 03:49:02,311 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-02-28 03:49:02,311 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-02-28 03:49:02,312 - FashionHybridModel - INFO - Parameters: num_categories=50, num_category_types=3, num_attributes=50, embed_dim=256
2025-02-28 03:49:02,602 - FashionHybridModel - INFO - Heatmap encoder initialized with output dimension: 256
2025-02-28 04:05:22,815 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-02-28 04:05:23,622 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-02-28 04:05:23,623 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-02-28 04:05:23,623 - FashionDataset - INFO - Extracted 50 attribute columns
2025-02-28 04:05:23,626 - FashionDataset - INFO - Created category mapping with 46 categories
2025-02-28 04:05:23,627 - FashionDataset - INFO - Validating dataset files...
2025-02-28 04:05:23,676 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-02-28 04:05:23,676 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-02-28 04:05:23,823 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-02-28 04:05:23,823 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-02-28 04:05:23,823 - FashionDataset - INFO - Extracted 50 attribute columns
2025-02-28 04:05:23,832 - FashionDataset - INFO - Created category mapping with 46 categories
2025-02-28 04:05:23,832 - FashionDataset - INFO - Validating dataset files...
2025-02-28 04:05:23,881 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-02-28 04:05:23,881 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-02-28 04:05:23,881 - FashionHybridModel - INFO - Parameters: num_categories=50, num_category_types=3, num_attributes=50, embed_dim=256
2025-02-28 04:05:24,163 - FashionHybridModel - INFO - Heatmap encoder initialized with output dimension: 256
2025-02-28 04:09:46,003 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-02-28 04:09:47,003 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-02-28 04:09:47,003 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-02-28 04:09:47,003 - FashionDataset - INFO - Extracted 50 attribute columns
2025-02-28 04:09:47,003 - FashionDataset - INFO - Created category mapping with 46 categories
2025-02-28 04:09:47,003 - FashionDataset - INFO - Validating dataset files...
2025-02-28 04:09:47,089 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-02-28 04:09:47,089 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-02-28 04:09:47,282 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-02-28 04:09:47,282 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-02-28 04:09:47,286 - FashionDataset - INFO - Extracted 50 attribute columns
2025-02-28 04:09:47,286 - FashionDataset - INFO - Created category mapping with 46 categories
2025-02-28 04:09:47,286 - FashionDataset - INFO - Validating dataset files...
2025-02-28 04:09:47,360 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-02-28 04:09:47,360 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-02-28 04:09:47,360 - FashionHybridModel - INFO - Parameters: num_categories=50, num_category_types=3, num_attributes=50, embed_dim=256
2025-02-28 04:09:47,699 - FashionHybridModel - INFO - Heatmap encoder initialized with output dimension: 256
2025-02-28 04:10:08,220 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([128, 3, 224, 224]), Heatmap: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-02-28 04:20:11,356 - FashionHybridModel - INFO - Using device: cuda
2025-02-28 04:20:11,356 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-02-28 04:20:11,356 - FashionHybridModel - INFO - Parameters: num_categories=46, num_category_types=3, num_attributes=50, embed_dim=256
2025-02-28 04:20:11,774 - FashionHybridModel - INFO - Initialized resnet50 backbone with feature dimension: 2048
2025-02-28 04:20:11,782 - FashionHybridModel - INFO - Heatmap encoder initialized with output dimension: 256
2025-02-28 04:20:11,782 - FashionHybridModel - INFO - Attribute encoder initialized with output dimension: 64
2025-02-28 04:20:11,782 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2368
2025-02-28 04:20:11,791 - FashionHybridModel - INFO - Model initialization complete
2025-02-28 04:20:12,731 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([4, 3, 224, 224]), Heatmap: torch.Size([4, 1, 224, 224]), Attributes: torch.Size([4, 50])
2025-02-28 04:20:13,042 - FashionHybridModel - INFO - Image features shape: torch.Size([4, 2048])
2025-02-28 04:20:13,054 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([4, 256])
2025-02-28 04:20:13,084 - FashionHybridModel - INFO - Attribute features shape: torch.Size([4, 64])
2025-02-28 04:20:13,092 - FashionHybridModel - INFO - Fused features shape: torch.Size([4, 256])
2025-02-28 04:20:13,119 - FashionHybridModel - INFO - Forward pass successful!
2025-02-28 04:20:13,120 - FashionHybridModel - INFO - category_logits: Shape=torch.Size([4, 46])
2025-02-28 04:20:13,120 - FashionHybridModel - INFO - category_probs: Shape=torch.Size([4, 46])
2025-02-28 04:20:13,120 - FashionHybridModel - INFO - category_type_logits: Shape=torch.Size([4, 3])
2025-02-28 04:20:13,121 - FashionHybridModel - INFO - category_type_probs: Shape=torch.Size([4, 3])
2025-02-28 04:20:13,121 - FashionHybridModel - INFO - attribute_preds: Shape=torch.Size([4, 50])
2025-02-28 04:20:13,121 - FashionHybridModel - INFO - attribute_probs: Shape=torch.Size([4, 50])
2025-02-28 04:20:13,121 - FashionHybridModel - INFO - compatibility_score: Shape=torch.Size([4, 1])
2025-02-28 04:46:09,359 - FashionHybridModel - INFO - Using device: cuda
2025-02-28 04:46:09,359 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-02-28 04:46:09,359 - FashionHybridModel - INFO - Parameters: num_categories=46, num_category_types=3, num_attributes=50, embed_dim=256
2025-02-28 04:46:09,728 - FashionHybridModel - INFO - Initialized resnet50 backbone with feature dimension: 2048
2025-02-28 04:46:09,731 - FashionHybridModel - INFO - Heatmap encoder initialized with output dimension: 256
2025-02-28 04:46:09,731 - FashionHybridModel - INFO - Attribute encoder initialized with output dimension: 64
2025-02-28 04:46:09,731 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2368
2025-02-28 04:46:09,740 - FashionHybridModel - INFO - Model initialization complete
2025-02-28 04:46:10,678 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([4, 3, 224, 224]), Heatmap: torch.Size([4, 1, 224, 224]), Attributes: torch.Size([4, 50])
2025-02-28 04:46:10,889 - FashionHybridModel - INFO - Image features shape: torch.Size([4, 2048])
2025-02-28 04:46:10,906 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([4, 256])
2025-02-28 04:46:10,930 - FashionHybridModel - INFO - Attribute features shape: torch.Size([4, 64])
2025-02-28 04:46:10,937 - FashionHybridModel - INFO - Fused features shape: torch.Size([4, 256])
2025-02-28 04:46:10,949 - FashionHybridModel - INFO - Forward pass successful!
2025-02-28 04:46:10,949 - FashionHybridModel - INFO - category_logits: Shape=torch.Size([4, 46])
2025-02-28 04:46:10,949 - FashionHybridModel - INFO - category_probs: Shape=torch.Size([4, 46])
2025-02-28 04:46:10,949 - FashionHybridModel - INFO - category_type_logits: Shape=torch.Size([4, 3])
2025-02-28 04:46:10,961 - FashionHybridModel - INFO - category_type_probs: Shape=torch.Size([4, 3])
2025-02-28 04:46:10,961 - FashionHybridModel - INFO - attribute_preds: Shape=torch.Size([4, 50])
2025-02-28 04:46:10,961 - FashionHybridModel - INFO - attribute_probs: Shape=torch.Size([4, 50])
2025-02-28 04:46:10,961 - FashionHybridModel - INFO - compatibility_score: Shape=torch.Size([4, 1])
2025-02-28 04:50:54,320 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-02-28 04:50:55,054 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-02-28 04:50:55,054 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-02-28 04:50:55,054 - FashionDataset - INFO - Extracted 50 attribute columns
2025-02-28 04:50:55,054 - FashionDataset - INFO - Created category mapping with 46 categories
2025-02-28 04:50:55,054 - FashionDataset - INFO - Validating dataset files...
2025-02-28 04:50:55,115 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-02-28 04:50:55,115 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-02-28 04:50:55,267 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-02-28 04:50:55,267 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-02-28 04:50:55,273 - FashionDataset - INFO - Extracted 50 attribute columns
2025-02-28 04:50:55,273 - FashionDataset - INFO - Created category mapping with 46 categories
2025-02-28 04:50:55,273 - FashionDataset - INFO - Validating dataset files...
2025-02-28 04:50:55,312 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-02-28 04:50:55,312 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-02-28 04:50:55,312 - FashionHybridModel - INFO - Parameters: num_categories=50, num_category_types=3, num_attributes=50, embed_dim=256
2025-02-28 04:50:55,669 - FashionHybridModel - INFO - Initialized resnet50 backbone with feature dimension: 2048
2025-02-28 04:50:55,669 - FashionHybridModel - INFO - Heatmap encoder initialized with output dimension: 256
2025-02-28 04:50:55,669 - FashionHybridModel - INFO - Attribute encoder initialized with output dimension: 64
2025-02-28 04:50:55,669 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2368
2025-02-28 04:50:55,690 - FashionHybridModel - INFO - Model initialization complete
2025-02-28 04:50:56,429 - FashionHybridModel - INFO - Image encoder backbone has been frozen
2025-02-28 04:51:09,581 - FashionDataset - ERROR - Error in __getitem__: 'compatibility_score'
2025-02-28 04:51:09,606 - FashionDataset - ERROR - Error in __getitem__: 'compatibility_score'
2025-02-28 04:51:09,664 - FashionDataset - ERROR - Error in __getitem__: 'compatibility_score'
2025-02-28 04:51:09,664 - FashionDataset - ERROR - Error in __getitem__: 'compatibility_score'
2025-02-28 04:51:09,677 - FashionDataset - ERROR - Error in __getitem__: 'compatibility_score'
2025-02-28 13:08:15,100 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-02-28 13:08:15,888 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-02-28 13:08:15,888 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-02-28 13:08:15,888 - FashionDataset - INFO - Extracted 50 attribute columns
2025-02-28 13:08:15,890 - FashionDataset - INFO - Created category mapping with 46 categories
2025-02-28 13:08:15,890 - FashionDataset - INFO - Validating dataset files...
2025-02-28 13:08:15,993 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-02-28 13:08:15,993 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-02-28 13:08:16,149 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-02-28 13:08:16,149 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-02-28 13:08:16,149 - FashionDataset - INFO - Extracted 50 attribute columns
2025-02-28 13:08:16,149 - FashionDataset - INFO - Created category mapping with 46 categories
2025-02-28 13:08:16,149 - FashionDataset - INFO - Validating dataset files...
2025-02-28 13:08:16,269 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-02-28 13:08:16,269 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-02-28 13:08:16,269 - FashionHybridModel - INFO - Parameters: num_categories=50, num_category_types=3, num_attributes=50, embed_dim=256
2025-02-28 13:08:16,751 - FashionHybridModel - INFO - Initialized resnet50 backbone with feature dimension: 2048
2025-02-28 13:08:16,755 - FashionHybridModel - INFO - Heatmap encoder initialized with output dimension: 256
2025-02-28 13:08:16,755 - FashionHybridModel - INFO - Attribute encoder initialized with output dimension: 64
2025-02-28 13:08:16,755 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2368
2025-02-28 13:08:16,761 - FashionHybridModel - INFO - Model initialization complete
2025-02-28 13:08:17,189 - FashionHybridModel - INFO - Image encoder backbone has been frozen
2025-02-28 13:08:34,693 - TrainingScript - ERROR - Error during forward pass or loss computation: autocast.__init__() got an unexpected keyword argument 'device_type'
2025-02-28 13:08:34,693 - TrainingScript - ERROR - Input shapes - Images: torch.Size([128, 3, 224, 224]), Heatmaps: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-02-28 13:16:06,405 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-02-28 13:16:07,153 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-02-28 13:16:07,153 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-02-28 13:16:07,153 - FashionDataset - INFO - Extracted 50 attribute columns
2025-02-28 13:16:07,153 - FashionDataset - INFO - Created category mapping with 46 categories
2025-02-28 13:16:07,153 - FashionDataset - INFO - Validating dataset files...
2025-02-28 13:16:07,211 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-02-28 13:16:07,211 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-02-28 13:16:07,484 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-02-28 13:16:07,484 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-02-28 13:16:07,484 - FashionDataset - INFO - Extracted 50 attribute columns
2025-02-28 13:16:07,484 - FashionDataset - INFO - Created category mapping with 46 categories
2025-02-28 13:16:07,484 - FashionDataset - INFO - Validating dataset files...
2025-02-28 13:16:07,552 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-02-28 13:16:07,552 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-02-28 13:16:07,552 - FashionHybridModel - INFO - Parameters: num_categories=50, num_category_types=3, num_attributes=50, embed_dim=256
2025-02-28 13:16:08,180 - FashionHybridModel - INFO - Initialized resnet50 backbone with feature dimension: 2048
2025-02-28 13:16:08,180 - FashionHybridModel - INFO - Heatmap encoder initialized with output dimension: 256
2025-02-28 13:16:08,180 - FashionHybridModel - INFO - Attribute encoder initialized with output dimension: 64
2025-02-28 13:16:08,180 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2368
2025-02-28 13:16:08,194 - FashionHybridModel - INFO - Model initialization complete
2025-02-28 13:16:08,198 - FashionHybridModel - INFO - Image encoder backbone has been frozen
2025-02-28 13:16:26,488 - TrainingScript - ERROR - Error during forward pass or loss computation: autocast.__init__() got an unexpected keyword argument 'device_type'
2025-02-28 13:16:26,488 - TrainingScript - ERROR - Input shapes - Images: torch.Size([128, 3, 224, 224]), Heatmaps: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-02-28 13:18:19,118 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-02-28 13:18:19,961 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-02-28 13:18:19,961 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-02-28 13:18:19,961 - FashionDataset - INFO - Extracted 50 attribute columns
2025-02-28 13:18:19,965 - FashionDataset - INFO - Created category mapping with 46 categories
2025-02-28 13:18:19,965 - FashionDataset - INFO - Validating dataset files...
2025-02-28 13:18:20,011 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-02-28 13:18:20,011 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-02-28 13:18:20,182 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-02-28 13:18:20,188 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-02-28 13:18:20,188 - FashionDataset - INFO - Extracted 50 attribute columns
2025-02-28 13:18:20,189 - FashionDataset - INFO - Created category mapping with 46 categories
2025-02-28 13:18:20,190 - FashionDataset - INFO - Validating dataset files...
2025-02-28 13:18:20,244 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-02-28 13:18:20,244 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-02-28 13:18:20,244 - FashionHybridModel - INFO - Parameters: num_categories=50, num_category_types=3, num_attributes=50, embed_dim=256
2025-02-28 13:18:20,544 - FashionHybridModel - INFO - Initialized resnet50 backbone with feature dimension: 2048
2025-02-28 13:18:20,547 - FashionHybridModel - INFO - Heatmap encoder initialized with output dimension: 256
2025-02-28 13:18:20,547 - FashionHybridModel - INFO - Attribute encoder initialized with output dimension: 64
2025-02-28 13:18:20,547 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2368
2025-02-28 13:18:20,547 - FashionHybridModel - INFO - Model initialization complete
2025-02-28 13:18:20,556 - FashionHybridModel - INFO - Image encoder backbone has been frozen
2025-02-28 13:18:37,393 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([128, 3, 224, 224]), Heatmap: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-02-28 13:18:49,067 - FashionHybridModel - INFO - Image features shape: torch.Size([128, 2048])
2025-02-28 13:18:51,974 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([128, 256])
2025-02-28 13:18:51,992 - FashionHybridModel - INFO - Attribute features shape: torch.Size([128, 64])
2025-02-28 13:18:51,997 - FashionHybridModel - INFO - Fused features shape: torch.Size([128, 256])
2025-02-28 13:18:52,050 - TrainingScript - ERROR - Error during forward pass or loss computation: Target 3 is out of bounds.
2025-02-28 13:18:52,050 - TrainingScript - ERROR - Input shapes - Images: torch.Size([128, 3, 224, 224]), Heatmaps: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-02-28 13:34:34,128 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-02-28 13:34:34,858 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-02-28 13:34:34,858 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-02-28 13:34:34,858 - FashionDataset - INFO - Extracted 50 attribute columns
2025-02-28 13:34:34,858 - FashionDataset - INFO - Original unique categories: [18 17 41 32 33  3 19 30 10 16 48 23 44 42 15  6 29  2 11 34 26 24 35 27
 12 39  7  9 22  5 20 36 13 14 21 25  1 47 43  8 46  4 37 28 40 31]
2025-02-28 13:34:34,858 - FashionDataset - INFO - Category mapping: {np.int64(1): 0, np.int64(2): 1, np.int64(3): 2, np.int64(4): 3, np.int64(5): 4, np.int64(6): 5, np.int64(7): 6, np.int64(8): 7, np.int64(9): 8, np.int64(10): 9, np.int64(11): 10, np.int64(12): 11, np.int64(13): 12, np.int64(14): 13, np.int64(15): 14, np.int64(16): 15, np.int64(17): 16, np.int64(18): 17, np.int64(19): 18, np.int64(20): 19, np.int64(21): 20, np.int64(22): 21, np.int64(23): 22, np.int64(24): 23, np.int64(25): 24, np.int64(26): 25, np.int64(27): 26, np.int64(28): 27, np.int64(29): 28, np.int64(30): 29, np.int64(31): 30, np.int64(32): 31, np.int64(33): 32, np.int64(34): 33, np.int64(35): 34, np.int64(36): 35, np.int64(37): 36, np.int64(39): 37, np.int64(40): 38, np.int64(41): 39, np.int64(42): 40, np.int64(43): 41, np.int64(44): 42, np.int64(46): 43, np.int64(47): 44, np.int64(48): 45}
2025-02-28 13:34:34,867 - FashionDataset - INFO - Remapped unique categories: [17 16 39 31 32  2 18 29  9 15 45 22 42 40 14  5 28  1 10 33 25 23 34 26
 11 37  6  8 21  4 19 35 12 13 20 24  0 44 41  7 43  3 36 27 38 30]
2025-02-28 13:34:34,869 - FashionDataset - INFO - Created category mapping with 46 categories
2025-02-28 13:34:34,869 - FashionDataset - INFO - Validating dataset files...
2025-02-28 13:34:34,969 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-02-28 13:34:34,969 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-02-28 13:34:35,114 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-02-28 13:34:35,114 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-02-28 13:34:35,114 - FashionDataset - INFO - Extracted 50 attribute columns
2025-02-28 13:34:35,114 - FashionDataset - INFO - Original unique categories: [18 17 41 32 33  3 19 30 10 16 48 23 44 42 15  6 29  2 11 34 26 24 35 27
 12 39  7  9 22  5 20 36 13 14 21 25  1 47 43  8 46  4 37 28 40 31]
2025-02-28 13:34:35,114 - FashionDataset - INFO - Category mapping: {np.int64(1): 0, np.int64(2): 1, np.int64(3): 2, np.int64(4): 3, np.int64(5): 4, np.int64(6): 5, np.int64(7): 6, np.int64(8): 7, np.int64(9): 8, np.int64(10): 9, np.int64(11): 10, np.int64(12): 11, np.int64(13): 12, np.int64(14): 13, np.int64(15): 14, np.int64(16): 15, np.int64(17): 16, np.int64(18): 17, np.int64(19): 18, np.int64(20): 19, np.int64(21): 20, np.int64(22): 21, np.int64(23): 22, np.int64(24): 23, np.int64(25): 24, np.int64(26): 25, np.int64(27): 26, np.int64(28): 27, np.int64(29): 28, np.int64(30): 29, np.int64(31): 30, np.int64(32): 31, np.int64(33): 32, np.int64(34): 33, np.int64(35): 34, np.int64(36): 35, np.int64(37): 36, np.int64(39): 37, np.int64(40): 38, np.int64(41): 39, np.int64(42): 40, np.int64(43): 41, np.int64(44): 42, np.int64(46): 43, np.int64(47): 44, np.int64(48): 45}
2025-02-28 13:34:35,130 - FashionDataset - INFO - Remapped unique categories: [17 16 39 31 32  2 18 29  9 15 45 22 42 40 14  5 28  1 10 33 25 23 34 26
 11 37  6  8 21  4 19 35 12 13 20 24  0 44 41  7 43  3 36 27 38 30]
2025-02-28 13:34:35,130 - FashionDataset - INFO - Created category mapping with 46 categories
2025-02-28 13:34:35,130 - FashionDataset - INFO - Validating dataset files...
2025-02-28 13:34:35,237 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-02-28 13:34:35,237 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-02-28 13:34:35,237 - FashionHybridModel - INFO - Parameters: num_categories=50, num_category_types=3, num_attributes=50, embed_dim=256
2025-02-28 13:34:35,671 - FashionHybridModel - INFO - Initialized resnet50 backbone with feature dimension: 2048
2025-02-28 13:34:35,673 - FashionHybridModel - INFO - Heatmap encoder initialized with output dimension: 256
2025-02-28 13:34:35,675 - FashionHybridModel - INFO - Attribute encoder initialized with output dimension: 64
2025-02-28 13:34:35,675 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2368
2025-02-28 13:34:35,675 - FashionHybridModel - INFO - Model initialization complete
2025-02-28 13:34:35,686 - FashionHybridModel - INFO - Image encoder backbone has been frozen
2025-02-28 13:34:51,528 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([128, 3, 224, 224]), Heatmap: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-02-28 13:35:07,667 - FashionHybridModel - INFO - Image features shape: torch.Size([128, 2048])
2025-02-28 13:35:12,004 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([128, 256])
2025-02-28 13:35:12,014 - FashionHybridModel - INFO - Attribute features shape: torch.Size([128, 64])
2025-02-28 13:35:12,024 - FashionHybridModel - INFO - Fused features shape: torch.Size([128, 256])
2025-02-28 13:35:12,045 - TrainingScript - ERROR - Error during forward pass or loss computation: Target 3 is out of bounds.
2025-02-28 13:35:12,045 - TrainingScript - ERROR - Input shapes - Images: torch.Size([128, 3, 224, 224]), Heatmaps: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-02-28 13:47:08,780 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-02-28 13:47:09,613 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-02-28 13:47:09,614 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-02-28 13:47:09,614 - FashionDataset - INFO - Extracted 50 attribute columns
2025-02-28 13:47:09,616 - FashionDataset - INFO - Original unique categories: [18 17 41 32 33  3 19 30 10 16 48 23 44 42 15  6 29  2 11 34 26 24 35 27
 12 39  7  9 22  5 20 36 13 14 21 25  1 47 43  8 46  4 37 28 40 31]
2025-02-28 13:47:09,616 - FashionDataset - INFO - Category mapping: {np.int64(1): 0, np.int64(2): 1, np.int64(3): 2, np.int64(4): 3, np.int64(5): 4, np.int64(6): 5, np.int64(7): 6, np.int64(8): 7, np.int64(9): 8, np.int64(10): 9, np.int64(11): 10, np.int64(12): 11, np.int64(13): 12, np.int64(14): 13, np.int64(15): 14, np.int64(16): 15, np.int64(17): 16, np.int64(18): 17, np.int64(19): 18, np.int64(20): 19, np.int64(21): 20, np.int64(22): 21, np.int64(23): 22, np.int64(24): 23, np.int64(25): 24, np.int64(26): 25, np.int64(27): 26, np.int64(28): 27, np.int64(29): 28, np.int64(30): 29, np.int64(31): 30, np.int64(32): 31, np.int64(33): 32, np.int64(34): 33, np.int64(35): 34, np.int64(36): 35, np.int64(37): 36, np.int64(39): 37, np.int64(40): 38, np.int64(41): 39, np.int64(42): 40, np.int64(43): 41, np.int64(44): 42, np.int64(46): 43, np.int64(47): 44, np.int64(48): 45}
2025-02-28 13:47:09,622 - FashionDataset - INFO - Remapped unique categories: [17 16 39 31 32  2 18 29  9 15 45 22 42 40 14  5 28  1 10 33 25 23 34 26
 11 37  6  8 21  4 19 35 12 13 20 24  0 44 41  7 43  3 36 27 38 30]
2025-02-28 13:47:09,625 - FashionDataset - INFO - Created category mapping with 46 categories
2025-02-28 13:47:09,625 - FashionDataset - INFO - Validating dataset files...
2025-02-28 13:47:09,713 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-02-28 13:47:09,713 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-02-28 13:47:09,878 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-02-28 13:47:09,878 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-02-28 13:47:09,878 - FashionDataset - INFO - Extracted 50 attribute columns
2025-02-28 13:47:09,878 - FashionDataset - INFO - Original unique categories: [18 17 41 32 33  3 19 30 10 16 48 23 44 42 15  6 29  2 11 34 26 24 35 27
 12 39  7  9 22  5 20 36 13 14 21 25  1 47 43  8 46  4 37 28 40 31]
2025-02-28 13:47:09,878 - FashionDataset - INFO - Category mapping: {np.int64(1): 0, np.int64(2): 1, np.int64(3): 2, np.int64(4): 3, np.int64(5): 4, np.int64(6): 5, np.int64(7): 6, np.int64(8): 7, np.int64(9): 8, np.int64(10): 9, np.int64(11): 10, np.int64(12): 11, np.int64(13): 12, np.int64(14): 13, np.int64(15): 14, np.int64(16): 15, np.int64(17): 16, np.int64(18): 17, np.int64(19): 18, np.int64(20): 19, np.int64(21): 20, np.int64(22): 21, np.int64(23): 22, np.int64(24): 23, np.int64(25): 24, np.int64(26): 25, np.int64(27): 26, np.int64(28): 27, np.int64(29): 28, np.int64(30): 29, np.int64(31): 30, np.int64(32): 31, np.int64(33): 32, np.int64(34): 33, np.int64(35): 34, np.int64(36): 35, np.int64(37): 36, np.int64(39): 37, np.int64(40): 38, np.int64(41): 39, np.int64(42): 40, np.int64(43): 41, np.int64(44): 42, np.int64(46): 43, np.int64(47): 44, np.int64(48): 45}
2025-02-28 13:47:09,878 - FashionDataset - INFO - Remapped unique categories: [17 16 39 31 32  2 18 29  9 15 45 22 42 40 14  5 28  1 10 33 25 23 34 26
 11 37  6  8 21  4 19 35 12 13 20 24  0 44 41  7 43  3 36 27 38 30]
2025-02-28 13:47:09,878 - FashionDataset - INFO - Created category mapping with 46 categories
2025-02-28 13:47:09,878 - FashionDataset - INFO - Validating dataset files...
2025-02-28 13:47:09,964 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-02-28 13:47:09,964 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-02-28 13:47:09,964 - FashionHybridModel - INFO - Parameters: num_categories=50, num_category_types=3, num_attributes=50, embed_dim=256
2025-02-28 13:47:10,346 - FashionHybridModel - INFO - Initialized resnet50 backbone with feature dimension: 2048
2025-02-28 13:47:10,362 - FashionHybridModel - INFO - Heatmap encoder initialized with output dimension: 256
2025-02-28 13:47:10,364 - FashionHybridModel - INFO - Attribute encoder initialized with output dimension: 64
2025-02-28 13:47:10,364 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2368
2025-02-28 13:47:10,371 - FashionHybridModel - INFO - Model initialization complete
2025-02-28 13:47:10,373 - FashionHybridModel - INFO - Image encoder backbone has been frozen
2025-02-28 13:47:28,233 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([128, 3, 224, 224]), Heatmap: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-02-28 13:47:39,253 - FashionHybridModel - INFO - Image features shape: torch.Size([128, 2048])
2025-02-28 13:47:42,047 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([128, 256])
2025-02-28 13:47:42,052 - FashionHybridModel - INFO - Attribute features shape: torch.Size([128, 64])
2025-02-28 13:47:42,056 - FashionHybridModel - INFO - Fused features shape: torch.Size([128, 256])
2025-02-28 13:47:42,065 - TrainingScript - ERROR - Error during forward pass or loss computation: Target 3 is out of bounds.
2025-02-28 13:47:42,066 - TrainingScript - ERROR - Input shapes - Images: torch.Size([128, 3, 224, 224]), Heatmaps: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-02-28 13:55:04,214 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-02-28 13:55:04,927 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-02-28 13:55:04,927 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-02-28 13:55:04,927 - FashionDataset - INFO - Extracted 50 attribute columns
2025-02-28 13:55:04,927 - FashionDataset - INFO - Original unique categories: [18 17 41 32 33  3 19 30 10 16 48 23 44 42 15  6 29  2 11 34 26 24 35 27
 12 39  7  9 22  5 20 36 13 14 21 25  1 47 43  8 46  4 37 28 40 31]
2025-02-28 13:55:04,927 - FashionDataset - INFO - Category mapping: {np.int64(1): 0, np.int64(2): 1, np.int64(3): 2, np.int64(4): 3, np.int64(5): 4, np.int64(6): 5, np.int64(7): 6, np.int64(8): 7, np.int64(9): 8, np.int64(10): 9, np.int64(11): 10, np.int64(12): 11, np.int64(13): 12, np.int64(14): 13, np.int64(15): 14, np.int64(16): 15, np.int64(17): 16, np.int64(18): 17, np.int64(19): 18, np.int64(20): 19, np.int64(21): 20, np.int64(22): 21, np.int64(23): 22, np.int64(24): 23, np.int64(25): 24, np.int64(26): 25, np.int64(27): 26, np.int64(28): 27, np.int64(29): 28, np.int64(30): 29, np.int64(31): 30, np.int64(32): 31, np.int64(33): 32, np.int64(34): 33, np.int64(35): 34, np.int64(36): 35, np.int64(37): 36, np.int64(39): 37, np.int64(40): 38, np.int64(41): 39, np.int64(42): 40, np.int64(43): 41, np.int64(44): 42, np.int64(46): 43, np.int64(47): 44, np.int64(48): 45}
2025-02-28 13:55:04,927 - FashionDataset - INFO - Remapped unique categories: [17 16 39 31 32  2 18 29  9 15 45 22 42 40 14  5 28  1 10 33 25 23 34 26
 11 37  6  8 21  4 19 35 12 13 20 24  0 44 41  7 43  3 36 27 38 30]
2025-02-28 13:55:04,943 - FashionDataset - INFO - Created category mapping with 46 categories
2025-02-28 13:55:04,943 - FashionDataset - INFO - Validating dataset files...
2025-02-28 13:55:05,038 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-02-28 13:55:05,038 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-02-28 13:55:05,181 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-02-28 13:55:05,181 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-02-28 13:55:05,181 - FashionDataset - INFO - Extracted 50 attribute columns
2025-02-28 13:55:05,181 - FashionDataset - INFO - Original unique categories: [18 17 41 32 33  3 19 30 10 16 48 23 44 42 15  6 29  2 11 34 26 24 35 27
 12 39  7  9 22  5 20 36 13 14 21 25  1 47 43  8 46  4 37 28 40 31]
2025-02-28 13:55:05,181 - FashionDataset - INFO - Category mapping: {np.int64(1): 0, np.int64(2): 1, np.int64(3): 2, np.int64(4): 3, np.int64(5): 4, np.int64(6): 5, np.int64(7): 6, np.int64(8): 7, np.int64(9): 8, np.int64(10): 9, np.int64(11): 10, np.int64(12): 11, np.int64(13): 12, np.int64(14): 13, np.int64(15): 14, np.int64(16): 15, np.int64(17): 16, np.int64(18): 17, np.int64(19): 18, np.int64(20): 19, np.int64(21): 20, np.int64(22): 21, np.int64(23): 22, np.int64(24): 23, np.int64(25): 24, np.int64(26): 25, np.int64(27): 26, np.int64(28): 27, np.int64(29): 28, np.int64(30): 29, np.int64(31): 30, np.int64(32): 31, np.int64(33): 32, np.int64(34): 33, np.int64(35): 34, np.int64(36): 35, np.int64(37): 36, np.int64(39): 37, np.int64(40): 38, np.int64(41): 39, np.int64(42): 40, np.int64(43): 41, np.int64(44): 42, np.int64(46): 43, np.int64(47): 44, np.int64(48): 45}
2025-02-28 13:55:05,197 - FashionDataset - INFO - Remapped unique categories: [17 16 39 31 32  2 18 29  9 15 45 22 42 40 14  5 28  1 10 33 25 23 34 26
 11 37  6  8 21  4 19 35 12 13 20 24  0 44 41  7 43  3 36 27 38 30]
2025-02-28 13:55:05,197 - FashionDataset - INFO - Created category mapping with 46 categories
2025-02-28 13:55:05,197 - FashionDataset - INFO - Validating dataset files...
2025-02-28 13:55:05,287 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-02-28 13:55:05,287 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-02-28 13:55:05,287 - FashionHybridModel - INFO - Parameters: num_categories=50, num_category_types=3, num_attributes=50, embed_dim=256
2025-02-28 13:55:05,824 - FashionHybridModel - INFO - Initialized resnet50 backbone with feature dimension: 2048
2025-02-28 13:55:05,826 - FashionHybridModel - INFO - Heatmap encoder initialized with output dimension: 256
2025-02-28 13:55:05,826 - FashionHybridModel - INFO - Attribute encoder initialized with output dimension: 64
2025-02-28 13:55:05,830 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2368
2025-02-28 13:55:05,838 - FashionHybridModel - INFO - Model initialization complete
2025-02-28 13:55:05,840 - FashionHybridModel - INFO - Image encoder backbone has been frozen
2025-02-28 13:55:22,265 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([128, 3, 224, 224]), Heatmap: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-02-28 13:55:32,842 - FashionHybridModel - INFO - Image features shape: torch.Size([128, 2048])
2025-02-28 13:55:35,007 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([128, 256])
2025-02-28 13:55:35,007 - FashionHybridModel - INFO - Attribute features shape: torch.Size([128, 64])
2025-02-28 13:55:35,007 - FashionHybridModel - INFO - Fused features shape: torch.Size([128, 256])
2025-02-28 13:55:35,018 - TrainingScript - ERROR - Error during forward pass or loss computation: Target 3 is out of bounds.
2025-02-28 13:55:35,019 - TrainingScript - ERROR - Input shapes - Images: torch.Size([128, 3, 224, 224]), Heatmaps: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-02-28 14:07:29,732 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-02-28 14:07:30,446 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-02-28 14:07:30,446 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-02-28 14:07:30,446 - FashionDataset - INFO - Extracted 50 attribute columns
2025-02-28 14:07:30,462 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-02-28 14:07:30,462 - FashionDataset - INFO - Category mapping: {np.int64(1): 0, np.int64(2): 1, np.int64(3): 2, np.int64(4): 3, np.int64(5): 4, np.int64(6): 5, np.int64(7): 6, np.int64(8): 7, np.int64(9): 8, np.int64(10): 9, np.int64(11): 10, np.int64(12): 11, np.int64(13): 12, np.int64(14): 13, np.int64(15): 14, np.int64(16): 15, np.int64(17): 16, np.int64(18): 17, np.int64(19): 18, np.int64(20): 19, np.int64(21): 20, np.int64(22): 21, np.int64(23): 22, np.int64(24): 23, np.int64(25): 24, np.int64(26): 25, np.int64(27): 26, np.int64(28): 27, np.int64(29): 28, np.int64(30): 29, np.int64(31): 30, np.int64(32): 31, np.int64(33): 32, np.int64(34): 33, np.int64(35): 34, np.int64(36): 35, np.int64(37): 36, np.int64(39): 37, np.int64(40): 38, np.int64(41): 39, np.int64(42): 40, np.int64(43): 41, np.int64(44): 42, np.int64(46): 43, np.int64(47): 44, np.int64(48): 45}
2025-02-28 14:07:30,467 - FashionDataset - INFO - Remapped unique categories: [17 16 39 31 32  2 18 29  9 15 45 22 42 40 14  5 28  1 10 33 25 23 34 26
 11 37  6  8 21  4 19 35 12 13 20 24  0 44 41  7 43  3 36 27 38 30]
2025-02-28 14:07:30,475 - FashionDataset - INFO - Created category mapping with 46 categories
2025-02-28 14:07:30,475 - FashionDataset - INFO - Validating dataset files...
2025-02-28 14:07:30,524 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-02-28 14:07:30,524 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-02-28 14:07:30,674 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-02-28 14:07:30,690 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-02-28 14:07:30,690 - FashionDataset - INFO - Extracted 50 attribute columns
2025-02-28 14:07:30,690 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-02-28 14:07:30,690 - FashionDataset - INFO - Category mapping: {np.int64(1): 0, np.int64(2): 1, np.int64(3): 2, np.int64(4): 3, np.int64(5): 4, np.int64(6): 5, np.int64(7): 6, np.int64(8): 7, np.int64(9): 8, np.int64(10): 9, np.int64(11): 10, np.int64(12): 11, np.int64(13): 12, np.int64(14): 13, np.int64(15): 14, np.int64(16): 15, np.int64(17): 16, np.int64(18): 17, np.int64(19): 18, np.int64(20): 19, np.int64(21): 20, np.int64(22): 21, np.int64(23): 22, np.int64(24): 23, np.int64(25): 24, np.int64(26): 25, np.int64(27): 26, np.int64(28): 27, np.int64(29): 28, np.int64(30): 29, np.int64(31): 30, np.int64(32): 31, np.int64(33): 32, np.int64(34): 33, np.int64(35): 34, np.int64(36): 35, np.int64(37): 36, np.int64(39): 37, np.int64(40): 38, np.int64(41): 39, np.int64(42): 40, np.int64(43): 41, np.int64(44): 42, np.int64(46): 43, np.int64(47): 44, np.int64(48): 45}
2025-02-28 14:07:30,690 - FashionDataset - INFO - Remapped unique categories: [17 16 39 31 32  2 18 29  9 15 45 22 42 40 14  5 28  1 10 33 25 23 34 26
 11 37  6  8 21  4 19 35 12 13 20 24  0 44 41  7 43  3 36 27 38 30]
2025-02-28 14:07:30,695 - FashionDataset - INFO - Created category mapping with 46 categories
2025-02-28 14:07:30,696 - FashionDataset - INFO - Validating dataset files...
2025-02-28 14:07:30,745 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-02-28 14:07:30,745 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-02-28 14:07:30,745 - FashionHybridModel - INFO - Parameters: num_categories=50, num_category_types=3, num_attributes=50, embed_dim=256
2025-02-28 14:07:31,060 - FashionHybridModel - INFO - Initialized resnet50 backbone with feature dimension: 2048
2025-02-28 14:07:31,060 - FashionHybridModel - INFO - Heatmap encoder initialized with output dimension: 256
2025-02-28 14:07:31,060 - FashionHybridModel - INFO - Attribute encoder initialized with output dimension: 64
2025-02-28 14:07:31,060 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2368
2025-02-28 14:07:31,072 - FashionHybridModel - INFO - Model initialization complete
2025-02-28 14:07:31,076 - FashionHybridModel - INFO - Image encoder backbone has been frozen
2025-02-28 14:07:49,066 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([128, 3, 224, 224]), Heatmap: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-02-28 14:08:00,318 - FashionHybridModel - INFO - Image features shape: torch.Size([128, 2048])
2025-02-28 14:08:03,635 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([128, 256])
2025-02-28 14:08:03,647 - FashionHybridModel - INFO - Attribute features shape: torch.Size([128, 64])
2025-02-28 14:08:03,651 - FashionHybridModel - INFO - Fused features shape: torch.Size([128, 256])
2025-02-28 14:23:37,633 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-02-28 14:23:38,364 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-02-28 14:23:38,364 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-02-28 14:23:38,364 - FashionDataset - INFO - Extracted 50 attribute columns
2025-02-28 14:23:38,364 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-02-28 14:23:38,364 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-02-28 14:23:38,364 - FashionDataset - INFO - Category mapping: {np.int64(1): 0, np.int64(2): 1, np.int64(3): 2, np.int64(4): 3, np.int64(5): 4, np.int64(6): 5, np.int64(7): 6, np.int64(8): 7, np.int64(9): 8, np.int64(10): 9, np.int64(11): 10, np.int64(12): 11, np.int64(13): 12, np.int64(14): 13, np.int64(15): 14, np.int64(16): 15, np.int64(17): 16, np.int64(18): 17, np.int64(19): 18, np.int64(20): 19, np.int64(21): 20, np.int64(22): 21, np.int64(23): 22, np.int64(24): 23, np.int64(25): 24, np.int64(26): 25, np.int64(27): 26, np.int64(28): 27, np.int64(29): 28, np.int64(30): 29, np.int64(31): 30, np.int64(32): 31, np.int64(33): 32, np.int64(34): 33, np.int64(35): 34, np.int64(36): 35, np.int64(37): 36, np.int64(39): 37, np.int64(40): 38, np.int64(41): 39, np.int64(42): 40, np.int64(43): 41, np.int64(44): 42, np.int64(46): 43, np.int64(47): 44, np.int64(48): 45}
2025-02-28 14:23:38,375 - FashionDataset - INFO - Remapped unique categories: [17 16 39 31 32  2 18 29  9 15 45 22 42 40 14  5 28  1 10 33 25 23 34 26
 11 37  6  8 21  4 19 35 12 13 20 24  0 44 41  7 43  3 36 27 38 30]
2025-02-28 14:23:38,376 - FashionDataset - INFO - Final category labels after remapping: [17 16 39 31 32  2 18 29  9 15 45 22 42 40 14  5 28  1 10 33 25 23 34 26
 11 37  6  8 21  4 19 35 12 13 20 24  0 44 41  7 43  3 36 27 38 30]
2025-02-28 14:23:38,380 - FashionDataset - INFO - Created category mapping with 46 categories
2025-02-28 14:23:38,380 - FashionDataset - INFO - Validating dataset files...
2025-02-28 14:23:38,471 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-02-28 14:23:38,471 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-02-28 14:23:38,675 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-02-28 14:23:38,675 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-02-28 14:23:38,675 - FashionDataset - INFO - Extracted 50 attribute columns
2025-02-28 14:23:38,675 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-02-28 14:23:38,675 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-02-28 14:23:38,675 - FashionDataset - INFO - Category mapping: {np.int64(1): 0, np.int64(2): 1, np.int64(3): 2, np.int64(4): 3, np.int64(5): 4, np.int64(6): 5, np.int64(7): 6, np.int64(8): 7, np.int64(9): 8, np.int64(10): 9, np.int64(11): 10, np.int64(12): 11, np.int64(13): 12, np.int64(14): 13, np.int64(15): 14, np.int64(16): 15, np.int64(17): 16, np.int64(18): 17, np.int64(19): 18, np.int64(20): 19, np.int64(21): 20, np.int64(22): 21, np.int64(23): 22, np.int64(24): 23, np.int64(25): 24, np.int64(26): 25, np.int64(27): 26, np.int64(28): 27, np.int64(29): 28, np.int64(30): 29, np.int64(31): 30, np.int64(32): 31, np.int64(33): 32, np.int64(34): 33, np.int64(35): 34, np.int64(36): 35, np.int64(37): 36, np.int64(39): 37, np.int64(40): 38, np.int64(41): 39, np.int64(42): 40, np.int64(43): 41, np.int64(44): 42, np.int64(46): 43, np.int64(47): 44, np.int64(48): 45}
2025-02-28 14:23:38,675 - FashionDataset - INFO - Remapped unique categories: [17 16 39 31 32  2 18 29  9 15 45 22 42 40 14  5 28  1 10 33 25 23 34 26
 11 37  6  8 21  4 19 35 12 13 20 24  0 44 41  7 43  3 36 27 38 30]
2025-02-28 14:23:38,675 - FashionDataset - INFO - Final category labels after remapping: [17 16 39 31 32  2 18 29  9 15 45 22 42 40 14  5 28  1 10 33 25 23 34 26
 11 37  6  8 21  4 19 35 12 13 20 24  0 44 41  7 43  3 36 27 38 30]
2025-02-28 14:23:38,675 - FashionDataset - INFO - Created category mapping with 46 categories
2025-02-28 14:23:38,675 - FashionDataset - INFO - Validating dataset files...
2025-02-28 14:23:38,764 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-02-28 14:23:38,764 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-02-28 14:23:38,764 - FashionHybridModel - INFO - Parameters: num_categories=46, num_category_types=3, num_attributes=50, embed_dim=256
2025-02-28 14:23:39,224 - FashionHybridModel - INFO - Initialized resnet50 backbone with feature dimension: 2048
2025-02-28 14:23:39,224 - FashionHybridModel - INFO - Heatmap encoder initialized with output dimension: 256
2025-02-28 14:23:39,224 - FashionHybridModel - INFO - Attribute encoder initialized with output dimension: 64
2025-02-28 14:23:39,224 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2368
2025-02-28 14:23:39,233 - FashionHybridModel - INFO - Model initialization complete
2025-02-28 14:23:39,236 - FashionHybridModel - INFO - Image encoder backbone has been frozen
2025-02-28 14:23:56,716 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([128, 3, 224, 224]), Heatmap: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-02-28 14:24:07,264 - FashionHybridModel - INFO - Image features shape: torch.Size([128, 2048])
2025-02-28 14:24:09,393 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([128, 256])
2025-02-28 14:24:09,393 - FashionHybridModel - INFO - Attribute features shape: torch.Size([128, 64])
2025-02-28 14:24:09,395 - FashionHybridModel - INFO - Fused features shape: torch.Size([128, 256])
2025-02-28 14:31:44,839 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-02-28 14:31:45,827 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-02-28 14:31:45,827 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-02-28 14:31:45,827 - FashionDataset - INFO - Extracted 50 attribute columns
2025-02-28 14:31:45,829 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-02-28 14:31:45,829 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-02-28 14:31:45,829 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-02-28 14:31:45,888 - FashionDataset - INFO - Final category labels after remapping: [17 16 39 31 32  2 18 29  9 15 45 22 42 40 14  5 28  1 10 33 25 23 34 26
 11 37  6  8 21  4 19 35 12 13 20 24  0 44 41  7 43  3 36 27 38 30]
2025-02-28 14:31:45,888 - FashionDataset - INFO - Created category mapping with 46 categories
2025-02-28 14:31:45,888 - FashionDataset - INFO - Validating dataset files...
2025-02-28 14:31:45,989 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-02-28 14:31:45,989 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-02-28 14:31:46,222 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-02-28 14:31:46,222 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-02-28 14:31:46,222 - FashionDataset - INFO - Extracted 50 attribute columns
2025-02-28 14:31:46,226 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-02-28 14:31:46,226 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-02-28 14:31:46,226 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-02-28 14:31:46,238 - FashionDataset - INFO - Final category labels after remapping: [17 16 39 31 32  2 18 29  9 15 45 22 42 40 14  5 28  1 10 33 25 23 34 26
 11 37  6  8 21  4 19 35 12 13 20 24  0 44 41  7 43  3 36 27 38 30]
2025-02-28 14:31:46,238 - FashionDataset - INFO - Created category mapping with 46 categories
2025-02-28 14:31:46,238 - FashionDataset - INFO - Validating dataset files...
2025-02-28 14:31:46,321 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-02-28 14:31:46,321 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-02-28 14:31:46,321 - FashionHybridModel - INFO - Parameters: num_categories=46, num_category_types=3, num_attributes=50, embed_dim=256
2025-02-28 14:31:46,676 - FashionHybridModel - INFO - Initialized resnet50 backbone with feature dimension: 2048
2025-02-28 14:31:46,683 - FashionHybridModel - INFO - Heatmap encoder initialized with output dimension: 256
2025-02-28 14:31:46,683 - FashionHybridModel - INFO - Attribute encoder initialized with output dimension: 64
2025-02-28 14:31:46,683 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2368
2025-02-28 14:31:46,690 - FashionHybridModel - INFO - Model initialization complete
2025-02-28 14:31:46,694 - FashionHybridModel - INFO - Image encoder backbone has been frozen
2025-02-28 14:32:06,193 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([128, 3, 224, 224]), Heatmap: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-02-28 14:32:18,390 - FashionHybridModel - INFO - Image features shape: torch.Size([128, 2048])
2025-02-28 14:32:21,011 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([128, 256])
2025-02-28 14:32:21,013 - FashionHybridModel - INFO - Attribute features shape: torch.Size([128, 64])
2025-02-28 14:32:21,017 - FashionHybridModel - INFO - Fused features shape: torch.Size([128, 256])
2025-02-28 14:37:53,579 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-02-28 14:37:54,320 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-02-28 14:37:54,320 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-02-28 14:37:54,320 - FashionDataset - INFO - Extracted 50 attribute columns
2025-02-28 14:37:54,320 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-02-28 14:37:54,320 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-02-28 14:37:54,320 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-02-28 14:37:54,366 - FashionDataset - INFO - Final category labels after remapping: [17 16 39 31 32  2 18 29  9 15 45 22 42 40 14  5 28  1 10 33 25 23 34 26
 11 37  6  8 21  4 19 35 12 13 20 24  0 44 41  7 43  3 36 27 38 30]
2025-02-28 14:37:54,379 - FashionDataset - INFO - Created category mapping with 46 categories
2025-02-28 14:37:54,380 - FashionDataset - INFO - Validating dataset files...
2025-02-28 14:37:54,462 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-02-28 14:37:54,462 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-02-28 14:37:54,610 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-02-28 14:37:54,610 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-02-28 14:37:54,610 - FashionDataset - INFO - Extracted 50 attribute columns
2025-02-28 14:37:54,610 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-02-28 14:37:54,610 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-02-28 14:37:54,610 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-02-28 14:37:54,630 - FashionDataset - INFO - Final category labels after remapping: [17 16 39 31 32  2 18 29  9 15 45 22 42 40 14  5 28  1 10 33 25 23 34 26
 11 37  6  8 21  4 19 35 12 13 20 24  0 44 41  7 43  3 36 27 38 30]
2025-02-28 14:37:54,632 - FashionDataset - INFO - Created category mapping with 46 categories
2025-02-28 14:37:54,632 - FashionDataset - INFO - Validating dataset files...
2025-02-28 14:37:54,687 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-02-28 14:37:54,704 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-02-28 14:37:54,704 - FashionHybridModel - INFO - Parameters: num_categories=46, num_category_types=3, num_attributes=50, embed_dim=256
2025-02-28 14:37:54,980 - FashionHybridModel - INFO - Initialized resnet50 backbone with feature dimension: 2048
2025-02-28 14:37:54,984 - FashionHybridModel - INFO - Heatmap encoder initialized with output dimension: 256
2025-02-28 14:37:54,984 - FashionHybridModel - INFO - Attribute encoder initialized with output dimension: 64
2025-02-28 14:37:54,984 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2368
2025-02-28 14:37:54,990 - FashionHybridModel - INFO - Model initialization complete
2025-02-28 14:37:54,993 - FashionHybridModel - INFO - Image encoder backbone has been frozen
2025-02-28 14:38:12,022 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([128, 3, 224, 224]), Heatmap: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-02-28 14:38:22,014 - FashionHybridModel - INFO - Image features shape: torch.Size([128, 2048])
2025-02-28 14:38:24,757 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([128, 256])
2025-02-28 14:38:24,797 - FashionHybridModel - INFO - Attribute features shape: torch.Size([128, 64])
2025-02-28 14:38:24,803 - FashionHybridModel - INFO - Fused features shape: torch.Size([128, 256])
2025-02-28 14:42:13,810 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-02-28 14:42:14,883 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-02-28 14:42:14,883 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-02-28 14:42:14,883 - FashionDataset - INFO - Extracted 50 attribute columns
2025-02-28 14:42:14,885 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-02-28 14:42:14,886 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-02-28 14:42:14,886 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-02-28 14:42:14,959 - FashionDataset - INFO - Final category labels after remapping: [17 16 39 31 32  2 18 29  9 15 45 22 42 40 14  5 28  1 10 33 25 23 34 26
 11 37  6  8 21  4 19 35 12 13 20 24  0 44 41  7 43  3 36 27 38 30]
2025-02-28 14:42:14,970 - FashionDataset - INFO - Created category mapping with 46 categories
2025-02-28 14:42:14,971 - FashionDataset - INFO - Validating dataset files...
2025-02-28 14:42:15,088 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-02-28 14:42:15,088 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-02-28 14:42:15,271 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-02-28 14:42:15,271 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-02-28 14:42:15,271 - FashionDataset - INFO - Extracted 50 attribute columns
2025-02-28 14:42:15,271 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-02-28 14:42:15,271 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-02-28 14:42:15,271 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-02-28 14:42:15,271 - FashionDataset - INFO - Final category labels after remapping: [17 16 39 31 32  2 18 29  9 15 45 22 42 40 14  5 28  1 10 33 25 23 34 26
 11 37  6  8 21  4 19 35 12 13 20 24  0 44 41  7 43  3 36 27 38 30]
2025-02-28 14:42:15,287 - FashionDataset - INFO - Created category mapping with 46 categories
2025-02-28 14:42:15,288 - FashionDataset - INFO - Validating dataset files...
2025-02-28 14:42:15,371 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-02-28 14:42:15,371 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-02-28 14:42:15,371 - FashionHybridModel - INFO - Parameters: num_categories=46, num_category_types=3, num_attributes=50, embed_dim=256
2025-02-28 14:42:15,819 - FashionHybridModel - INFO - Initialized resnet50 backbone with feature dimension: 2048
2025-02-28 14:42:15,823 - FashionHybridModel - INFO - Heatmap encoder initialized with output dimension: 256
2025-02-28 14:42:15,823 - FashionHybridModel - INFO - Attribute encoder initialized with output dimension: 64
2025-02-28 14:42:15,823 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2368
2025-02-28 14:42:15,830 - FashionHybridModel - INFO - Model initialization complete
2025-02-28 14:42:15,833 - FashionHybridModel - INFO - Image encoder backbone has been frozen
2025-02-28 14:42:33,791 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([128, 3, 224, 224]), Heatmap: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-02-28 14:42:44,309 - FashionHybridModel - INFO - Image features shape: torch.Size([128, 2048])
2025-02-28 14:42:46,612 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([128, 256])
2025-02-28 14:42:46,612 - FashionHybridModel - INFO - Attribute features shape: torch.Size([128, 64])
2025-02-28 14:42:46,612 - FashionHybridModel - INFO - Fused features shape: torch.Size([128, 256])
2025-02-28 16:16:05,859 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-02-28 16:16:06,733 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-02-28 16:16:06,733 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-02-28 16:16:06,733 - FashionDataset - INFO - Extracted 50 attribute columns
2025-02-28 16:16:06,733 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-02-28 16:16:06,733 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-02-28 16:16:06,733 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-02-28 16:16:06,796 - FashionDataset - INFO - Final category labels after remapping: [17 16 39 31 32  2 18 29  9 15 45 22 42 40 14  5 28  1 10 33 25 23 34 26
 11 37  6  8 21  4 19 35 12 13 20 24  0 44 41  7 43  3 36 27 38 30]
2025-02-28 16:16:06,796 - FashionDataset - INFO - Created category mapping with 46 categories
2025-02-28 16:16:06,796 - FashionDataset - INFO - Validating dataset files...
2025-02-28 16:16:06,877 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-02-28 16:16:06,877 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-02-28 16:16:07,096 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-02-28 16:16:07,096 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-02-28 16:16:07,097 - FashionDataset - INFO - Extracted 50 attribute columns
2025-02-28 16:16:07,097 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-02-28 16:16:07,097 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-02-28 16:16:07,097 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-02-28 16:16:07,097 - FashionDataset - INFO - Final category labels after remapping: [17 16 39 31 32  2 18 29  9 15 45 22 42 40 14  5 28  1 10 33 25 23 34 26
 11 37  6  8 21  4 19 35 12 13 20 24  0 44 41  7 43  3 36 27 38 30]
2025-02-28 16:16:07,097 - FashionDataset - INFO - Created category mapping with 46 categories
2025-02-28 16:16:07,108 - FashionDataset - INFO - Validating dataset files...
2025-02-28 16:16:07,187 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-02-28 16:16:07,187 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-02-28 16:16:07,187 - FashionHybridModel - INFO - Parameters: num_categories=46, num_category_types=3, num_attributes=50, embed_dim=256
2025-02-28 16:16:07,515 - FashionHybridModel - INFO - Initialized resnet50 backbone with feature dimension: 2048
2025-02-28 16:16:07,515 - FashionHybridModel - INFO - Heatmap encoder initialized with output dimension: 256
2025-02-28 16:16:07,515 - FashionHybridModel - INFO - Attribute encoder initialized with output dimension: 64
2025-02-28 16:16:07,515 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2368
2025-02-28 16:16:07,515 - FashionHybridModel - INFO - Model initialization complete
2025-02-28 16:16:07,529 - FashionHybridModel - INFO - Image encoder backbone has been frozen
2025-02-28 16:17:03,094 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-02-28 16:17:03,812 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-02-28 16:17:03,812 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-02-28 16:17:03,818 - FashionDataset - INFO - Extracted 50 attribute columns
2025-02-28 16:17:03,818 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-02-28 16:17:03,818 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-02-28 16:17:03,818 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-02-28 16:17:03,863 - FashionDataset - INFO - Final category labels after remapping: [17 16 39 31 32  2 18 29  9 15 45 22 42 40 14  5 28  1 10 33 25 23 34 26
 11 37  6  8 21  4 19 35 12 13 20 24  0 44 41  7 43  3 36 27 38 30]
2025-02-28 16:17:03,868 - FashionDataset - INFO - Created category mapping with 46 categories
2025-02-28 16:17:03,869 - FashionDataset - INFO - Validating dataset files...
2025-02-28 16:17:03,938 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-02-28 16:17:03,938 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-02-28 16:17:04,102 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-02-28 16:17:04,102 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-02-28 16:17:04,102 - FashionDataset - INFO - Extracted 50 attribute columns
2025-02-28 16:17:04,102 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-02-28 16:17:04,102 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-02-28 16:17:04,102 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-02-28 16:17:04,112 - FashionDataset - INFO - Final category labels after remapping: [17 16 39 31 32  2 18 29  9 15 45 22 42 40 14  5 28  1 10 33 25 23 34 26
 11 37  6  8 21  4 19 35 12 13 20 24  0 44 41  7 43  3 36 27 38 30]
2025-02-28 16:17:04,116 - FashionDataset - INFO - Created category mapping with 46 categories
2025-02-28 16:17:04,116 - FashionDataset - INFO - Validating dataset files...
2025-02-28 16:17:04,188 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-02-28 16:17:04,188 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-02-28 16:17:04,188 - FashionHybridModel - INFO - Parameters: num_categories=46, num_category_types=3, num_attributes=50, embed_dim=256
2025-02-28 16:17:04,473 - FashionHybridModel - INFO - Initialized resnet50 backbone with feature dimension: 2048
2025-02-28 16:17:04,475 - FashionHybridModel - INFO - Heatmap encoder initialized with output dimension: 256
2025-02-28 16:17:04,477 - FashionHybridModel - INFO - Attribute encoder initialized with output dimension: 64
2025-02-28 16:17:04,477 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2368
2025-02-28 16:17:04,483 - FashionHybridModel - INFO - Model initialization complete
2025-02-28 16:17:04,486 - FashionHybridModel - INFO - Image encoder backbone has been frozen
2025-02-28 16:19:34,863 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-02-28 16:19:35,627 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-02-28 16:19:35,627 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-02-28 16:19:35,627 - FashionDataset - INFO - Extracted 50 attribute columns
2025-02-28 16:19:35,627 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-02-28 16:19:35,627 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-02-28 16:19:35,627 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-02-28 16:19:35,694 - FashionDataset - INFO - Final category labels after remapping: [17 16 39 31 32  2 18 29  9 15 45 22 42 40 14  5 28  1 10 33 25 23 34 26
 11 37  6  8 21  4 19 35 12 13 20 24  0 44 41  7 43  3 36 27 38 30]
2025-02-28 16:19:35,700 - FashionDataset - INFO - Created category mapping with 46 categories
2025-02-28 16:19:35,700 - FashionDataset - INFO - Validating dataset files...
2025-02-28 16:19:35,767 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-02-28 16:19:35,767 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-02-28 16:19:35,923 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-02-28 16:19:35,923 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-02-28 16:19:35,923 - FashionDataset - INFO - Extracted 50 attribute columns
2025-02-28 16:19:35,923 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-02-28 16:19:35,923 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-02-28 16:19:35,923 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-02-28 16:19:35,945 - FashionDataset - INFO - Final category labels after remapping: [17 16 39 31 32  2 18 29  9 15 45 22 42 40 14  5 28  1 10 33 25 23 34 26
 11 37  6  8 21  4 19 35 12 13 20 24  0 44 41  7 43  3 36 27 38 30]
2025-02-28 16:19:35,947 - FashionDataset - INFO - Created category mapping with 46 categories
2025-02-28 16:19:35,947 - FashionDataset - INFO - Validating dataset files...
2025-02-28 16:19:36,019 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-02-28 16:19:36,019 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-02-28 16:19:36,019 - FashionHybridModel - INFO - Parameters: num_categories=46, num_category_types=3, num_attributes=50, embed_dim=256
2025-02-28 16:19:36,301 - FashionHybridModel - INFO - Initialized resnet50 backbone with feature dimension: 2048
2025-02-28 16:19:36,305 - FashionHybridModel - INFO - Heatmap encoder initialized with output dimension: 256
2025-02-28 16:19:36,305 - FashionHybridModel - INFO - Attribute encoder initialized with output dimension: 64
2025-02-28 16:19:36,305 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2368
2025-02-28 16:19:36,313 - FashionHybridModel - INFO - Model initialization complete
2025-02-28 16:19:36,315 - FashionHybridModel - INFO - Image encoder backbone has been frozen
2025-02-28 16:19:54,377 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([128, 3, 224, 224]), Heatmap: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-02-28 16:24:34,565 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-02-28 16:24:35,319 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-02-28 16:24:35,319 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-02-28 16:24:35,319 - FashionDataset - INFO - Extracted 50 attribute columns
2025-02-28 16:24:35,319 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-02-28 16:24:35,324 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-02-28 16:24:35,324 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-02-28 16:24:35,373 - FashionDataset - INFO - Final category labels after remapping: [17 16 39 31 32  2 18 29  9 15 45 22 42 40 14  5 28  1 10 33 25 23 34 26
 11 37  6  8 21  4 19 35 12 13 20 24  0 44 41  7 43  3 36 27 38 30]
2025-02-28 16:24:35,378 - FashionDataset - INFO - Created category mapping with 46 categories
2025-02-28 16:24:35,378 - FashionDataset - INFO - Validating dataset files...
2025-02-28 16:24:35,449 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-02-28 16:24:35,450 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-02-28 16:24:35,604 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-02-28 16:24:35,604 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-02-28 16:24:35,607 - FashionDataset - INFO - Extracted 50 attribute columns
2025-02-28 16:24:35,607 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-02-28 16:24:35,607 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-02-28 16:24:35,607 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-02-28 16:24:35,607 - FashionDataset - INFO - Final category labels after remapping: [17 16 39 31 32  2 18 29  9 15 45 22 42 40 14  5 28  1 10 33 25 23 34 26
 11 37  6  8 21  4 19 35 12 13 20 24  0 44 41  7 43  3 36 27 38 30]
2025-02-28 16:24:35,618 - FashionDataset - INFO - Created category mapping with 46 categories
2025-02-28 16:24:35,619 - FashionDataset - INFO - Validating dataset files...
2025-02-28 16:24:35,702 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-02-28 16:24:35,702 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-02-28 16:24:35,702 - FashionHybridModel - INFO - Parameters: num_categories=46, num_category_types=3, num_attributes=50, embed_dim=256
2025-02-28 16:24:36,023 - FashionHybridModel - INFO - Initialized resnet50 backbone with feature dimension: 2048
2025-02-28 16:24:36,027 - FashionHybridModel - INFO - Heatmap encoder initialized with output dimension: 256
2025-02-28 16:24:36,027 - FashionHybridModel - INFO - Attribute encoder initialized with output dimension: 64
2025-02-28 16:24:36,029 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2368
2025-02-28 16:24:36,036 - FashionHybridModel - INFO - Model initialization complete
2025-02-28 16:24:36,039 - FashionHybridModel - INFO - Image encoder backbone has been frozen
2025-02-28 16:24:52,341 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([128, 3, 224, 224]), Heatmap: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-02-28 16:25:02,623 - FashionHybridModel - INFO - Image features shape: torch.Size([128, 2048])
2025-02-28 16:25:05,189 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([128, 256])
2025-02-28 16:25:05,288 - FashionHybridModel - INFO - Attribute features shape: torch.Size([128, 64])
2025-02-28 16:25:05,296 - FashionHybridModel - INFO - Fused features shape: torch.Size([128, 256])
2025-02-28 18:09:05,749 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-02-28 18:09:06,683 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-02-28 18:09:06,683 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-02-28 18:09:06,683 - FashionDataset - INFO - Extracted 50 attribute columns
2025-02-28 18:09:06,683 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-02-28 18:09:06,683 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-02-28 18:09:06,683 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-02-28 18:09:06,810 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-02-28 18:09:06,826 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-02-28 18:09:06,826 - FashionDataset - INFO - Created category mapping with 46 categories
2025-02-28 18:09:06,826 - FashionDataset - INFO - Validating dataset files...
2025-02-28 18:09:06,889 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-02-28 18:09:06,889 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-02-28 18:09:07,062 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-02-28 18:09:07,062 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-02-28 18:09:07,062 - FashionDataset - INFO - Extracted 50 attribute columns
2025-02-28 18:09:07,062 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-02-28 18:09:07,062 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-02-28 18:09:07,062 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-02-28 18:09:07,078 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-02-28 18:09:07,078 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-02-28 18:09:07,091 - FashionDataset - INFO - Created category mapping with 46 categories
2025-02-28 18:09:07,091 - FashionDataset - INFO - Validating dataset files...
2025-02-28 18:09:07,153 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-02-28 18:09:07,157 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-02-28 18:09:07,157 - FashionHybridModel - INFO - Parameters: num_categories=46, num_category_types=3, num_attributes=50, embed_dim=256
2025-02-28 18:09:07,584 - FashionHybridModel - INFO - Initialized resnet50 backbone with feature dimension: 2048
2025-02-28 18:09:07,600 - FashionHybridModel - INFO - Heatmap encoder initialized with output dimension: 256
2025-02-28 18:09:07,600 - FashionHybridModel - INFO - Attribute encoder initialized with output dimension: 64
2025-02-28 18:09:07,600 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2368
2025-02-28 18:09:07,606 - FashionHybridModel - INFO - Model initialization complete
2025-02-28 18:09:07,606 - FashionHybridModel - INFO - Image encoder backbone has been frozen
2025-02-28 18:09:25,070 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([128, 3, 224, 224]), Heatmap: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-02-28 18:09:35,598 - FashionHybridModel - INFO - Image features shape: torch.Size([128, 2048])
2025-02-28 18:09:38,251 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([128, 256])
2025-02-28 18:09:38,268 - FashionHybridModel - INFO - Attribute features shape: torch.Size([128, 64])
2025-02-28 18:09:38,283 - FashionHybridModel - INFO - Fused features shape: torch.Size([128, 256])
2025-03-02 15:46:33,430 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-03-02 15:46:34,246 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-03-02 15:46:34,246 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-02 15:46:34,246 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-02 15:46:34,253 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-02 15:46:34,253 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-02 15:46:34,253 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-02 15:46:34,329 - FashionDataset - INFO - After remapping: category_label min=-1, max=44
2025-03-02 15:46:34,337 - FashionDataset - INFO - Final category labels after remapping: [np.int64(-1), np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44)]
2025-03-02 15:46:34,337 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-02 15:46:34,337 - FashionDataset - INFO - Validating dataset files...
2025-03-02 15:46:34,448 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-02 15:46:34,448 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-03-02 15:46:34,678 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-03-02 15:46:34,678 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-02 15:46:34,678 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-02 15:46:34,678 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-02 15:46:34,678 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-02 15:46:34,678 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-02 15:46:34,695 - FashionDataset - INFO - After remapping: category_label min=-1, max=44
2025-03-02 15:46:34,703 - FashionDataset - INFO - Final category labels after remapping: [np.int64(-1), np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44)]
2025-03-02 15:46:34,704 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-02 15:46:34,704 - FashionDataset - INFO - Validating dataset files...
2025-03-02 15:46:34,842 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-02 16:00:59,136 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-03-02 16:00:59,981 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-03-02 16:00:59,981 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-02 16:00:59,981 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-02 16:00:59,983 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-02 16:00:59,985 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-02 16:00:59,987 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-02 16:01:00,111 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-02 16:01:00,116 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-02 16:01:00,123 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-02 16:01:00,123 - FashionDataset - INFO - Validating dataset files...
2025-03-02 16:01:00,265 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-02 16:01:00,267 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-03-02 16:01:00,537 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-03-02 16:01:00,538 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-02 16:01:00,538 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-02 16:01:00,539 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-02 16:01:00,539 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-02 16:01:00,539 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-02 16:01:00,560 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-02 16:01:00,583 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-02 16:01:00,604 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-02 16:01:00,604 - FashionDataset - INFO - Validating dataset files...
2025-03-02 16:01:00,717 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-02 16:01:00,779 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-03-02 16:01:00,779 - FashionHybridModel - INFO - Parameters: num_categories=46, num_category_types=3, num_attributes=50, embed_dim=256
2025-03-02 16:01:01,256 - FashionHybridModel - INFO - Initialized resnet50 backbone with feature dimension: 2048
2025-03-02 16:01:01,256 - FashionHybridModel - INFO - Heatmap encoder initialized with output dimension: 256
2025-03-02 16:01:01,256 - FashionHybridModel - INFO - Attribute encoder initialized with output dimension: 64
2025-03-02 16:01:01,256 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2368
2025-03-02 16:01:01,268 - FashionHybridModel - INFO - Model initialization complete
2025-03-02 16:01:01,273 - FashionHybridModel - INFO - Image encoder backbone has been frozen
2025-03-02 16:01:19,326 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([128, 3, 224, 224]), Heatmap: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-03-02 16:01:30,795 - FashionHybridModel - INFO - Image features shape: torch.Size([128, 2048])
2025-03-02 16:01:33,795 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([128, 256])
2025-03-02 16:01:33,816 - FashionHybridModel - INFO - Attribute features shape: torch.Size([128, 64])
2025-03-02 16:01:33,820 - FashionHybridModel - INFO - Fused features shape: torch.Size([128, 256])
2025-03-02 16:17:33,208 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-03-02 16:17:33,962 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-03-02 16:17:33,962 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-02 16:17:33,962 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-02 16:17:33,965 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-02 16:17:33,965 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-02 16:17:33,971 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-02 16:17:34,073 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-02 16:17:34,073 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-02 16:17:34,089 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-02 16:17:34,089 - FashionDataset - INFO - Validating dataset files...
2025-03-02 16:17:34,244 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-02 16:17:34,246 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-03-02 16:17:34,519 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-03-02 16:17:34,519 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-02 16:17:34,519 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-02 16:17:34,519 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-02 16:17:34,519 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-02 16:17:34,534 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-02 16:17:34,551 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-02 16:17:34,552 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-02 16:17:34,556 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-02 16:17:34,556 - FashionDataset - INFO - Validating dataset files...
2025-03-02 16:17:34,708 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-02 16:17:34,726 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-03-02 16:17:34,726 - FashionHybridModel - INFO - Parameters: num_categories=46, num_category_types=3, num_attributes=50, embed_dim=256
2025-03-02 16:17:35,284 - FashionHybridModel - INFO - Initialized resnet50 backbone with feature dimension: 2048
2025-03-02 16:17:35,288 - FashionHybridModel - INFO - Heatmap encoder initialized with output dimension: 256
2025-03-02 16:17:35,288 - FashionHybridModel - INFO - Attribute encoder initialized with output dimension: 64
2025-03-02 16:17:35,291 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2368
2025-03-02 16:17:35,299 - FashionHybridModel - INFO - Model initialization complete
2025-03-02 16:17:35,303 - FashionHybridModel - INFO - Image encoder backbone has been frozen
2025-03-02 16:17:54,112 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([128, 3, 224, 224]), Heatmap: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-03-02 16:18:05,054 - FashionHybridModel - INFO - Image features shape: torch.Size([128, 2048])
2025-03-02 16:18:07,687 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([128, 256])
2025-03-02 16:18:07,692 - FashionHybridModel - INFO - Attribute features shape: torch.Size([128, 64])
2025-03-02 16:18:07,693 - FashionHybridModel - INFO - Fused features shape: torch.Size([128, 256])
2025-03-02 16:27:35,882 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-03-02 16:27:36,719 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-03-02 16:27:36,719 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-02 16:27:36,719 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-02 16:27:36,721 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-02 16:27:36,721 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-02 16:27:36,723 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-02 16:27:36,886 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-02 16:27:36,891 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-02 16:27:36,898 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-02 16:27:36,898 - FashionDataset - INFO - Validating dataset files...
2025-03-02 16:27:36,980 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-02 16:27:36,981 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-03-02 16:27:37,242 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-03-02 16:27:37,242 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-02 16:27:37,242 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-02 16:27:37,242 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-02 16:27:37,242 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-02 16:27:37,242 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-02 16:27:37,274 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-02 16:27:37,277 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-02 16:27:37,280 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-02 16:27:37,281 - FashionDataset - INFO - Validating dataset files...
2025-03-02 16:27:37,345 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-02 16:27:37,357 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-03-02 16:27:37,359 - FashionHybridModel - INFO - Parameters: num_categories=46, num_category_types=3, num_attributes=50, embed_dim=256
2025-03-02 16:27:37,711 - FashionHybridModel - INFO - Initialized resnet50 backbone with feature dimension: 2048
2025-03-02 16:27:37,727 - FashionHybridModel - INFO - Heatmap encoder initialized with output dimension: 256
2025-03-02 16:27:37,727 - FashionHybridModel - INFO - Attribute encoder initialized with output dimension: 64
2025-03-02 16:27:37,727 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2368
2025-03-02 16:27:37,739 - FashionHybridModel - INFO - Model initialization complete
2025-03-02 16:27:37,743 - FashionHybridModel - INFO - Image encoder backbone has been frozen
2025-03-02 16:27:54,883 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([128, 3, 224, 224]), Heatmap: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-03-02 16:28:06,629 - FashionHybridModel - INFO - Image features shape: torch.Size([128, 2048])
2025-03-02 16:28:09,162 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([128, 256])
2025-03-02 16:28:09,182 - FashionHybridModel - INFO - Attribute features shape: torch.Size([128, 64])
2025-03-02 16:28:09,187 - FashionHybridModel - INFO - Fused features shape: torch.Size([128, 256])
2025-03-02 16:33:21,908 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-03-02 16:33:22,636 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-03-02 16:33:22,637 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-02 16:33:22,637 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-02 16:33:22,638 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-02 16:33:22,638 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-02 16:33:22,638 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-02 16:33:22,713 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-02 16:33:22,721 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-02 16:33:22,726 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-02 16:33:22,726 - FashionDataset - INFO - Validating dataset files...
2025-03-02 16:33:22,781 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-02 16:33:22,781 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-03-02 16:33:22,944 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-03-02 16:33:22,944 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-02 16:33:22,944 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-02 16:33:22,944 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-02 16:33:22,944 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-02 16:33:22,944 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-02 16:33:22,959 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-02 16:33:22,964 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-02 16:33:22,966 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-02 16:33:22,966 - FashionDataset - INFO - Validating dataset files...
2025-03-02 16:33:23,022 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-02 16:33:23,038 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-03-02 16:33:23,038 - FashionHybridModel - INFO - Parameters: num_categories=46, num_category_types=3, num_attributes=50, embed_dim=256
2025-03-02 16:33:23,469 - FashionHybridModel - INFO - Initialized resnet50 backbone with feature dimension: 2048
2025-03-02 16:33:23,475 - FashionHybridModel - INFO - Heatmap encoder initialized with output dimension: 256
2025-03-02 16:33:23,475 - FashionHybridModel - INFO - Attribute encoder initialized with output dimension: 64
2025-03-02 16:33:23,475 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2368
2025-03-02 16:33:23,483 - FashionHybridModel - INFO - Model initialization complete
2025-03-02 16:33:23,486 - FashionHybridModel - INFO - Image encoder backbone has been frozen
2025-03-02 16:33:39,186 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([128, 3, 224, 224]), Heatmap: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-03-02 16:33:49,524 - FashionHybridModel - INFO - Image features shape: torch.Size([128, 2048])
2025-03-02 16:33:51,611 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([128, 256])
2025-03-02 16:33:51,611 - FashionHybridModel - INFO - Attribute features shape: torch.Size([128, 64])
2025-03-02 16:33:51,615 - FashionHybridModel - INFO - Fused features shape: torch.Size([128, 256])
2025-03-02 16:53:27,706 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-03-02 16:53:28,471 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-03-02 16:53:28,471 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-02 16:53:28,471 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-02 16:53:28,471 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-02 16:53:28,471 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-02 16:53:28,471 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-02 16:53:28,558 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-02 16:53:28,558 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-02 16:53:28,571 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-02 16:53:28,571 - FashionDataset - INFO - Validating dataset files...
2025-03-02 16:53:28,625 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-02 16:53:28,625 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-03-02 16:53:28,781 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-03-02 16:53:28,781 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-02 16:53:28,781 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-02 16:53:28,781 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-02 16:53:28,781 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-02 16:53:28,781 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-02 16:53:28,816 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-02 16:53:28,818 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-02 16:53:28,820 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-02 16:53:28,820 - FashionDataset - INFO - Validating dataset files...
2025-03-02 16:53:28,884 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-02 16:53:28,921 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-03-02 16:53:28,922 - FashionHybridModel - INFO - Parameters: num_categories=46, num_category_types=3, num_attributes=50, embed_dim=256
2025-03-02 16:53:29,202 - FashionHybridModel - INFO - Initialized resnet50 backbone with feature dimension: 2048
2025-03-02 16:53:29,206 - FashionHybridModel - INFO - Heatmap encoder initialized with output dimension: 256
2025-03-02 16:53:29,206 - FashionHybridModel - INFO - Attribute encoder initialized with output dimension: 64
2025-03-02 16:53:29,206 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2368
2025-03-02 16:53:29,213 - FashionHybridModel - INFO - Model initialization complete
2025-03-02 16:53:29,213 - FashionHybridModel - INFO - Image encoder backbone has been frozen
2025-03-02 16:59:06,622 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-03-02 16:59:07,532 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-03-02 16:59:07,548 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-02 16:59:07,548 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-02 16:59:07,548 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-02 16:59:07,548 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-02 16:59:07,548 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-02 16:59:07,635 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-02 16:59:07,648 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-02 16:59:07,652 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-02 16:59:07,653 - FashionDataset - INFO - Validating dataset files...
2025-03-02 16:59:07,719 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-02 16:59:07,719 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-03-02 16:59:07,902 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-03-02 16:59:07,902 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-02 16:59:07,902 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-02 16:59:07,902 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-02 16:59:07,902 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-02 16:59:07,902 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-02 16:59:07,932 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-02 16:59:07,932 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-02 16:59:07,932 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-02 16:59:07,932 - FashionDataset - INFO - Validating dataset files...
2025-03-02 16:59:07,985 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-02 16:59:08,027 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-03-02 16:59:08,027 - FashionHybridModel - INFO - Parameters: num_categories=46, num_category_types=3, num_attributes=50, embed_dim=256
2025-03-02 16:59:08,305 - FashionHybridModel - INFO - Initialized resnet50 backbone with feature dimension: 2048
2025-03-02 16:59:08,324 - FashionHybridModel - INFO - Heatmap encoder initialized with output dimension: 256
2025-03-02 16:59:08,324 - FashionHybridModel - INFO - Attribute encoder initialized with output dimension: 64
2025-03-02 16:59:08,324 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2368
2025-03-02 16:59:08,330 - FashionHybridModel - INFO - Model initialization complete
2025-03-02 16:59:08,333 - FashionHybridModel - INFO - Image encoder backbone has been frozen
2025-03-02 17:04:29,665 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-03-02 17:04:30,711 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-03-02 17:04:30,726 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-02 17:04:30,726 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-02 17:04:30,727 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-02 17:04:30,727 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-02 17:04:30,731 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-02 17:04:30,838 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-02 17:04:30,842 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-02 17:04:30,850 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-02 17:04:30,850 - FashionDataset - INFO - Validating dataset files...
2025-03-02 17:04:30,914 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-02 17:04:30,914 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-03-02 17:04:31,223 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-03-02 17:04:31,225 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-02 17:04:31,225 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-02 17:04:31,225 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-02 17:04:31,225 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-02 17:04:31,225 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-02 17:04:31,250 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-02 17:04:31,251 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-02 17:04:31,254 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-02 17:04:31,254 - FashionDataset - INFO - Validating dataset files...
2025-03-02 17:04:31,315 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-02 17:06:03,678 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-03-02 17:06:04,420 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-03-02 17:06:04,420 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-02 17:06:04,420 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-02 17:06:04,436 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-02 17:06:04,436 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-02 17:06:04,436 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-02 17:06:04,503 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-02 17:06:04,521 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-02 17:06:04,526 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-02 17:06:04,526 - FashionDataset - INFO - Validating dataset files...
2025-03-02 17:06:04,576 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-02 17:06:04,576 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-03-02 17:06:04,742 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-03-02 17:06:04,742 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-02 17:06:04,742 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-02 17:06:04,742 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-02 17:06:04,742 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-02 17:06:04,742 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-02 17:06:04,761 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-02 17:06:04,763 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-02 17:06:04,765 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-02 17:06:04,765 - FashionDataset - INFO - Validating dataset files...
2025-03-02 17:06:04,824 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-02 17:06:04,845 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-03-02 17:06:04,845 - FashionHybridModel - INFO - Parameters: num_categories=46, num_category_types=3, num_attributes=50, embed_dim=256
2025-03-02 17:06:05,132 - FashionHybridModel - INFO - Initialized resnet50 backbone with feature dimension: 2048
2025-03-02 17:06:05,136 - FashionHybridModel - INFO - Heatmap encoder initialized with output dimension: 256
2025-03-02 17:06:05,136 - FashionHybridModel - INFO - Attribute encoder initialized with output dimension: 64
2025-03-02 17:06:05,136 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2368
2025-03-02 17:06:05,144 - FashionHybridModel - INFO - Model initialization complete
2025-03-02 17:06:05,147 - FashionHybridModel - INFO - Image encoder backbone has been frozen
2025-03-02 17:06:20,813 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([128, 3, 224, 224]), Heatmap: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-03-02 17:06:31,431 - FashionHybridModel - INFO - Image features shape: torch.Size([128, 2048])
2025-03-02 17:06:34,327 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([128, 256])
2025-03-02 17:06:34,350 - FashionHybridModel - INFO - Attribute features shape: torch.Size([128, 64])
2025-03-02 17:06:34,352 - FashionHybridModel - INFO - Fused features shape: torch.Size([128, 256])
2025-03-02 17:10:18,086 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-03-02 17:10:19,080 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-03-02 17:10:19,080 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-02 17:10:19,085 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-02 17:10:19,087 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-02 17:10:19,087 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-02 17:10:19,089 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-02 17:10:19,182 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-02 17:10:19,199 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-02 17:10:19,203 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-02 17:10:19,203 - FashionDataset - INFO - Validating dataset files...
2025-03-02 17:10:19,339 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-02 17:10:19,339 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-03-02 17:10:19,574 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-03-02 17:10:19,574 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-02 17:10:19,574 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-02 17:10:19,574 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-02 17:10:19,574 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-02 17:10:19,574 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-02 17:10:19,623 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-02 17:10:19,625 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-02 17:10:19,625 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-02 17:10:19,625 - FashionDataset - INFO - Validating dataset files...
2025-03-02 17:10:19,763 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-02 17:10:19,819 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-03-02 17:10:19,819 - FashionHybridModel - INFO - Parameters: num_categories=46, num_category_types=3, num_attributes=50, embed_dim=256
2025-03-02 17:10:20,254 - FashionHybridModel - INFO - Initialized resnet50 backbone with feature dimension: 2048
2025-03-02 17:10:20,265 - FashionHybridModel - INFO - Heatmap encoder initialized with output dimension: 256
2025-03-02 17:10:20,265 - FashionHybridModel - INFO - Attribute encoder initialized with output dimension: 64
2025-03-02 17:10:20,265 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2368
2025-03-02 17:10:20,272 - FashionHybridModel - INFO - Model initialization complete
2025-03-02 17:10:20,275 - FashionHybridModel - INFO - Image encoder backbone has been frozen
2025-03-02 17:10:38,588 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([128, 3, 224, 224]), Heatmap: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-03-02 17:10:49,484 - FashionHybridModel - INFO - Image features shape: torch.Size([128, 2048])
2025-03-02 17:10:51,542 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([128, 256])
2025-03-02 17:10:51,543 - FashionHybridModel - INFO - Attribute features shape: torch.Size([128, 64])
2025-03-02 17:10:51,543 - FashionHybridModel - INFO - Fused features shape: torch.Size([128, 256])
2025-03-02 17:18:04,837 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-03-02 17:18:05,711 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-03-02 17:18:05,711 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-15.0, 15.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.7, 1.3), contrast=(0.7, 1.3), saturation=(0.7, 1.3), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-02 17:18:05,711 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-02 17:18:05,711 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-02 17:18:05,711 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-02 17:18:05,711 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-02 17:18:05,801 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-02 17:18:05,801 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-02 17:18:05,808 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-02 17:18:05,808 - FashionDataset - INFO - Validating dataset files...
2025-03-02 17:18:05,868 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-02 17:18:05,868 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-03-02 17:18:06,132 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-03-02 17:18:06,132 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-15.0, 15.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.7, 1.3), contrast=(0.7, 1.3), saturation=(0.7, 1.3), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-02 17:18:06,132 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-02 17:18:06,132 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-02 17:18:06,132 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-02 17:18:06,132 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-02 17:18:06,157 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-02 17:18:06,160 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-02 17:18:06,161 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-02 17:18:06,161 - FashionDataset - INFO - Validating dataset files...
2025-03-02 17:18:06,205 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-02 17:29:21,151 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-03-02 17:29:22,102 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-03-02 17:29:22,103 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-02 17:29:22,103 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-02 17:29:22,105 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-02 17:29:22,105 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-02 17:29:22,108 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-02 17:29:22,225 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-02 17:29:22,227 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-02 17:29:22,234 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-02 17:29:22,235 - FashionDataset - INFO - Validating dataset files...
2025-03-02 17:29:22,301 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-02 17:29:22,301 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-03-02 17:29:22,529 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-03-02 17:29:22,529 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-02 17:29:22,530 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-02 17:29:22,530 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-02 17:29:22,530 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-02 17:29:22,530 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-02 17:29:22,553 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-02 17:29:22,554 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-02 17:29:22,555 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-02 17:29:22,557 - FashionDataset - INFO - Validating dataset files...
2025-03-02 17:29:22,616 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-02 17:29:22,657 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-03-02 17:29:22,657 - FashionHybridModel - INFO - Parameters: num_categories=46, num_category_types=3, num_attributes=50, embed_dim=256
2025-03-02 17:29:23,046 - FashionHybridModel - INFO - Initialized resnet50 backbone with feature dimension: 2048
2025-03-02 17:29:23,050 - FashionHybridModel - INFO - Heatmap encoder initialized with output dimension: 256
2025-03-02 17:29:23,050 - FashionHybridModel - INFO - Attribute encoder initialized with output dimension: 64
2025-03-02 17:29:23,050 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2368
2025-03-02 17:29:23,057 - FashionHybridModel - INFO - Model initialization complete
2025-03-02 17:29:23,060 - FashionHybridModel - INFO - Image encoder backbone has been frozen
2025-03-02 17:29:41,506 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([128, 3, 224, 224]), Heatmap: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-03-02 17:29:52,893 - FashionHybridModel - INFO - Image features shape: torch.Size([128, 2048])
2025-03-02 17:29:56,275 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([128, 256])
2025-03-02 17:29:56,288 - FashionHybridModel - INFO - Attribute features shape: torch.Size([128, 64])
2025-03-02 17:29:56,300 - FashionHybridModel - INFO - Fused features shape: torch.Size([128, 256])
2025-03-02 17:29:56,342 - TrainingScript - ERROR - Error during forward pass or loss computation: 'FashionMultiTaskLoss' object has no attribute 'category_type_loss_fn'
2025-03-02 17:29:56,342 - TrainingScript - ERROR - Input shapes - Images: torch.Size([128, 3, 224, 224]), Heatmaps: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-03-02 17:33:14,861 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-03-02 17:33:15,830 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-03-02 17:33:15,830 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-02 17:33:15,831 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-02 17:33:15,838 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-02 17:33:15,838 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-02 17:33:15,841 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-02 17:33:15,937 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-02 17:33:15,943 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-02 17:33:15,947 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-02 17:33:15,948 - FashionDataset - INFO - Validating dataset files...
2025-03-02 17:33:16,082 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-02 17:33:16,082 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-03-02 17:33:16,325 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-03-02 17:33:16,328 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-02 17:33:16,328 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-02 17:33:16,328 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-02 17:33:16,328 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-02 17:33:16,328 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-02 17:33:16,356 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-02 17:33:16,357 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-02 17:33:16,359 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-02 17:33:16,359 - FashionDataset - INFO - Validating dataset files...
2025-03-02 17:33:16,460 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-02 17:33:16,460 - TrainingScript - INFO - Category labels are correctly indexed from 0 to 45.
2025-03-02 17:33:16,505 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-03-02 17:33:16,507 - FashionHybridModel - INFO - Parameters: num_categories=46, num_category_types=3, num_attributes=50, embed_dim=256
2025-03-02 17:33:16,994 - FashionHybridModel - INFO - Initialized resnet50 backbone with feature dimension: 2048
2025-03-02 17:33:16,998 - FashionHybridModel - INFO - Heatmap encoder initialized with output dimension: 256
2025-03-02 17:33:16,999 - FashionHybridModel - INFO - Attribute encoder initialized with output dimension: 64
2025-03-02 17:33:16,999 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2368
2025-03-02 17:33:17,007 - FashionHybridModel - INFO - Model initialization complete
2025-03-02 17:33:17,011 - FashionHybridModel - INFO - Image encoder backbone has been frozen
2025-03-02 17:33:39,671 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([128, 3, 224, 224]), Heatmap: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-03-02 17:33:49,404 - FashionHybridModel - INFO - Image features shape: torch.Size([128, 2048])
2025-03-02 17:33:51,689 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([128, 256])
2025-03-02 17:33:51,693 - FashionHybridModel - INFO - Attribute features shape: torch.Size([128, 64])
2025-03-02 17:33:51,709 - FashionHybridModel - INFO - Fused features shape: torch.Size([128, 256])
2025-03-02 17:33:51,741 - TrainingScript - ERROR - Error during forward pass or loss computation: 'FashionMultiTaskLoss' object has no attribute 'category_type_loss_fn'
2025-03-02 17:33:51,741 - TrainingScript - ERROR - Input shapes - Images: torch.Size([128, 3, 224, 224]), Heatmaps: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-03-02 17:36:02,662 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-03-02 17:36:04,230 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-03-02 17:36:04,230 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-02 17:36:04,230 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-02 17:36:04,244 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-02 17:36:04,244 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-02 17:36:04,247 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-02 17:36:04,356 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-02 17:36:04,362 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-02 17:36:04,369 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-02 17:36:04,369 - FashionDataset - INFO - Validating dataset files...
2025-03-02 17:36:04,488 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-02 17:36:04,488 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-03-02 17:36:04,749 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-03-02 17:36:04,749 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-02 17:36:04,749 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-02 17:36:04,749 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-02 17:36:04,749 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-02 17:36:04,749 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-02 17:36:04,780 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-02 17:36:04,782 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-02 17:36:04,782 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-02 17:36:04,782 - FashionDataset - INFO - Validating dataset files...
2025-03-02 17:36:04,896 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-02 17:36:04,945 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-03-02 17:36:04,947 - FashionHybridModel - INFO - Parameters: num_categories=46, num_category_types=3, num_attributes=50, embed_dim=256
2025-03-02 17:36:05,458 - FashionHybridModel - INFO - Initialized resnet50 backbone with feature dimension: 2048
2025-03-02 17:36:05,462 - FashionHybridModel - INFO - Heatmap encoder initialized with output dimension: 256
2025-03-02 17:36:05,462 - FashionHybridModel - INFO - Attribute encoder initialized with output dimension: 64
2025-03-02 17:36:05,462 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2368
2025-03-02 17:36:05,468 - FashionHybridModel - INFO - Model initialization complete
2025-03-02 17:36:05,476 - FashionHybridModel - INFO - Image encoder backbone has been frozen
2025-03-02 17:36:25,769 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([128, 3, 224, 224]), Heatmap: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-03-02 17:36:35,813 - FashionHybridModel - INFO - Image features shape: torch.Size([128, 2048])
2025-03-02 17:36:37,946 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([128, 256])
2025-03-02 17:36:37,952 - FashionHybridModel - INFO - Attribute features shape: torch.Size([128, 64])
2025-03-02 17:36:37,957 - FashionHybridModel - INFO - Fused features shape: torch.Size([128, 256])
2025-03-02 17:36:37,968 - TrainingScript - ERROR - Error during forward pass or loss computation: 'FashionMultiTaskLoss' object has no attribute 'category_type_loss_fn'
2025-03-02 17:36:37,968 - TrainingScript - ERROR - Input shapes - Images: torch.Size([128, 3, 224, 224]), Heatmaps: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-03-02 17:44:02,923 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-03-02 17:44:03,841 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-03-02 17:44:03,841 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-02 17:44:03,841 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-02 17:44:03,844 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-02 17:44:03,844 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-02 17:44:03,845 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-02 17:44:03,945 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-02 17:44:03,945 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-02 17:44:03,954 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-02 17:44:03,954 - FashionDataset - INFO - Validating dataset files...
2025-03-02 17:44:04,063 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-02 17:44:04,063 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-03-02 17:44:04,255 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-03-02 17:44:04,255 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-02 17:44:04,255 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-02 17:44:04,255 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-02 17:44:04,255 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-02 17:44:04,267 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-02 17:44:04,267 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-02 17:44:04,283 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-02 17:44:04,284 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-02 17:44:04,284 - FashionDataset - INFO - Validating dataset files...
2025-03-02 17:44:04,382 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-02 17:44:04,382 - TrainingScript - INFO -  Category labels are correctly indexed from 0 to 45.
2025-03-02 17:44:04,413 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-03-02 17:44:04,413 - FashionHybridModel - INFO - Parameters: num_categories=46, num_category_types=3, num_attributes=50, embed_dim=256
2025-03-02 17:44:04,699 - FashionHybridModel - INFO - Initialized resnet50 backbone with feature dimension: 2048
2025-03-02 17:44:04,703 - FashionHybridModel - INFO - Heatmap encoder initialized with output dimension: 256
2025-03-02 17:44:04,703 - FashionHybridModel - INFO - Attribute encoder initialized with output dimension: 64
2025-03-02 17:44:04,703 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2368
2025-03-02 17:44:04,710 - FashionHybridModel - INFO - Model initialization complete
2025-03-02 17:44:04,713 - FashionHybridModel - INFO - Image encoder backbone has been frozen
2025-03-02 17:44:21,727 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([128, 3, 224, 224]), Heatmap: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-03-02 17:44:31,877 - FashionHybridModel - INFO - Image features shape: torch.Size([128, 2048])
2025-03-02 17:44:34,352 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([128, 256])
2025-03-02 17:44:34,374 - FashionHybridModel - INFO - Attribute features shape: torch.Size([128, 64])
2025-03-02 17:44:34,379 - FashionHybridModel - INFO - Fused features shape: torch.Size([128, 256])
2025-03-02 17:44:34,394 - TrainingScript - ERROR - Error during forward pass or loss computation: 'FashionMultiTaskLoss' object has no attribute 'category_type_loss_fn'
2025-03-02 17:44:34,394 - TrainingScript - ERROR - Input shapes - Images: torch.Size([128, 3, 224, 224]), Heatmaps: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-03-02 17:48:10,262 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-03-02 17:48:11,240 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-03-02 17:48:11,241 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-02 17:48:11,241 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-02 17:48:11,243 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-02 17:48:11,243 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-02 17:48:11,246 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-02 17:48:11,337 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-02 17:48:11,337 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-02 17:48:11,347 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-02 17:48:11,348 - FashionDataset - INFO - Validating dataset files...
2025-03-02 17:48:11,453 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-02 17:48:11,453 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-03-02 17:48:11,625 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-03-02 17:48:11,625 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-10.0, 10.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.8, 1.2), contrast=(0.8, 1.2), saturation=(0.8, 1.2), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-02 17:48:11,625 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-02 17:48:11,625 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-02 17:48:11,625 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-02 17:48:11,625 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-02 17:48:11,644 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-02 17:48:11,646 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-02 17:48:11,647 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-02 17:48:11,647 - FashionDataset - INFO - Validating dataset files...
2025-03-02 17:48:11,738 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-02 17:48:11,738 - TrainingScript - INFO -  Category labels are correctly indexed from 0 to 45.
2025-03-02 17:48:11,780 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-03-02 17:48:11,780 - FashionHybridModel - INFO - Parameters: num_categories=46, num_category_types=3, num_attributes=50, embed_dim=256
2025-03-02 17:48:12,079 - FashionHybridModel - INFO - Initialized resnet50 backbone with feature dimension: 2048
2025-03-02 17:48:12,079 - FashionHybridModel - INFO - Heatmap encoder initialized with output dimension: 256
2025-03-02 17:48:12,084 - FashionHybridModel - INFO - Attribute encoder initialized with output dimension: 64
2025-03-02 17:48:12,084 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2368
2025-03-02 17:48:12,090 - FashionHybridModel - INFO - Model initialization complete
2025-03-02 17:48:12,091 - FashionHybridModel - INFO - Image encoder backbone has been frozen
2025-03-02 17:48:28,898 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([128, 3, 224, 224]), Heatmap: torch.Size([128, 1, 224, 224]), Attributes: torch.Size([128, 50])
2025-03-02 17:48:39,737 - FashionHybridModel - INFO - Image features shape: torch.Size([128, 2048])
2025-03-02 17:48:41,963 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([128, 256])
2025-03-02 17:48:41,963 - FashionHybridModel - INFO - Attribute features shape: torch.Size([128, 64])
2025-03-02 17:48:41,963 - FashionHybridModel - INFO - Fused features shape: torch.Size([128, 256])
2025-03-02 18:20:12,957 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-03-02 18:20:13,713 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-03-02 18:20:13,713 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-02 18:20:13,713 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-02 18:20:13,713 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-02 18:20:13,713 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-02 18:20:13,713 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-02 18:20:13,799 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-02 18:20:13,815 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-02 18:20:13,820 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-02 18:20:13,821 - FashionDataset - INFO - Validating dataset files...
2025-03-02 18:20:13,889 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-02 18:20:13,890 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-03-02 18:20:14,033 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-03-02 18:20:14,033 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-02 18:20:14,033 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-02 18:20:14,048 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-02 18:20:14,048 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-02 18:20:14,049 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-02 18:20:14,060 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-02 18:20:14,064 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-02 18:20:14,065 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-02 18:20:14,066 - FashionDataset - INFO - Validating dataset files...
2025-03-02 18:20:14,130 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-02 18:20:14,131 - TrainingScript - INFO -  Category labels are correctly indexed from 0 to 45.
2025-03-02 18:22:24,602 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-03-02 18:22:25,489 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-03-02 18:22:25,489 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-02 18:22:25,490 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-02 18:22:25,493 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-02 18:22:25,493 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-02 18:22:25,494 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-02 18:22:25,585 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-02 18:22:25,585 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-02 18:22:25,596 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-02 18:22:25,596 - FashionDataset - INFO - Validating dataset files...
2025-03-02 18:22:25,650 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-02 18:22:25,650 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-03-02 18:22:25,816 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-03-02 18:22:25,816 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-02 18:22:25,816 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-02 18:22:25,818 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-02 18:22:25,818 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-02 18:22:25,818 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-02 18:22:25,841 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-02 18:22:25,841 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-02 18:22:25,843 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-02 18:22:25,843 - FashionDataset - INFO - Validating dataset files...
2025-03-02 18:22:25,915 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-02 18:22:25,916 - TrainingScript - INFO -  Category labels are correctly indexed from 0 to 45.
2025-03-02 18:22:25,945 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-03-02 18:22:25,946 - FashionHybridModel - INFO - Parameters: num_categories=46, num_category_types=3, num_attributes=50, embed_dim=256
2025-03-02 18:22:26,359 - FashionHybridModel - INFO - Initialized resnet50 backbone with feature dimension: 2048
2025-03-02 18:22:26,362 - FashionHybridModel - INFO - Heatmap encoder initialized with output dimension: 256
2025-03-02 18:22:26,363 - FashionHybridModel - INFO - Attribute encoder initialized with output dimension: 64
2025-03-02 18:22:26,363 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2368
2025-03-02 18:22:26,370 - FashionHybridModel - INFO - Model initialization complete
2025-03-02 18:22:26,373 - FashionHybridModel - INFO - Image encoder backbone has been frozen
2025-03-02 18:22:41,868 - FashionDataset - ERROR - Error in __getitem__: 'Image' object has no attribute 'shape'
2025-03-02 18:39:48,452 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-03-02 18:39:49,358 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-03-02 18:39:49,358 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-02 18:39:49,359 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-02 18:39:49,361 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-02 18:39:49,361 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-02 18:39:49,363 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-02 18:39:49,455 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-02 18:39:49,455 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-02 18:39:49,466 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-02 18:39:49,466 - FashionDataset - INFO - Validating dataset files...
2025-03-02 18:39:49,529 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-02 18:39:49,529 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-03-02 18:39:49,710 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-03-02 18:39:49,710 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-02 18:39:49,710 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-02 18:39:49,710 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-02 18:39:49,710 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-02 18:39:49,710 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-02 18:39:49,731 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-02 18:39:49,734 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-02 18:39:49,735 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-02 18:39:49,735 - FashionDataset - INFO - Validating dataset files...
2025-03-02 18:39:49,791 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-02 18:39:49,791 - TrainingScript - INFO -  Category labels are correctly indexed from 0 to 45.
2025-03-02 18:39:49,822 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-03-02 18:39:49,822 - FashionHybridModel - INFO - Parameters: num_categories=46, num_category_types=3, num_attributes=50, embed_dim=256
2025-03-02 18:39:50,105 - FashionHybridModel - INFO - Initialized resnet50 backbone with feature dimension: 2048
2025-03-02 18:39:50,111 - FashionHybridModel - INFO - Heatmap encoder initialized with output dimension: 256
2025-03-02 18:39:50,111 - FashionHybridModel - INFO - Attribute encoder initialized with output dimension: 64
2025-03-02 18:39:50,111 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2368
2025-03-02 18:39:50,119 - FashionHybridModel - INFO - Model initialization complete
2025-03-02 18:39:50,122 - FashionHybridModel - INFO - Image encoder backbone has been frozen
2025-03-02 18:43:17,418 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-03-02 18:43:18,320 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-03-02 18:43:18,320 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-02 18:43:18,320 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-02 18:43:18,320 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-02 18:43:18,320 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-02 18:43:18,325 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-02 18:43:18,412 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-02 18:43:18,427 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-02 18:43:18,432 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-02 18:43:18,432 - FashionDataset - INFO - Validating dataset files...
2025-03-02 18:43:18,515 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-02 18:43:18,515 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-03-02 18:43:18,675 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-03-02 18:43:18,675 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-02 18:43:18,675 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-02 18:43:18,675 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-02 18:43:18,675 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-02 18:43:18,691 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-02 18:43:18,702 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-02 18:43:18,706 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-02 18:43:18,707 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-02 18:43:18,707 - FashionDataset - INFO - Validating dataset files...
2025-03-02 18:43:18,791 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-02 18:43:18,791 - TrainingScript - INFO -  Category labels are correctly indexed from 0 to 45.
2025-03-02 18:43:18,826 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-03-02 18:43:18,827 - FashionHybridModel - INFO - Parameters: num_categories=46, num_category_types=3, num_attributes=50, embed_dim=256
2025-03-02 18:43:19,191 - FashionHybridModel - INFO - Initialized resnet50 backbone with feature dimension: 2048
2025-03-02 18:43:19,195 - FashionHybridModel - INFO - Heatmap encoder initialized with output dimension: 256
2025-03-02 18:43:19,197 - FashionHybridModel - INFO - Attribute encoder initialized with output dimension: 64
2025-03-02 18:43:19,197 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2368
2025-03-02 18:43:19,205 - FashionHybridModel - INFO - Model initialization complete
2025-03-02 18:43:19,208 - FashionHybridModel - INFO - Image encoder backbone has been frozen
2025-03-02 18:45:19,141 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-03-02 18:45:20,028 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-03-02 18:45:20,029 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-02 18:45:20,030 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-02 18:45:20,030 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-02 18:45:20,033 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-02 18:45:20,035 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-02 18:45:20,127 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-02 18:45:20,134 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-02 18:45:20,138 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-02 18:45:20,138 - FashionDataset - INFO - Validating dataset files...
2025-03-02 18:45:20,248 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-02 18:45:20,248 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-03-02 18:45:20,407 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-03-02 18:45:20,407 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-02 18:45:20,407 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-02 18:45:20,407 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-02 18:45:20,407 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-02 18:45:20,407 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-02 18:45:20,440 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-02 18:45:20,441 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-02 18:45:20,442 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-02 18:45:20,443 - FashionDataset - INFO - Validating dataset files...
2025-03-02 18:45:20,563 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-02 18:45:20,563 - TrainingScript - INFO -  Category labels are correctly indexed from 0 to 45.
2025-03-02 18:45:20,595 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-03-02 18:45:20,596 - FashionHybridModel - INFO - Parameters: num_categories=46, num_category_types=3, num_attributes=50, embed_dim=256
2025-03-02 18:45:20,872 - FashionHybridModel - INFO - Initialized resnet50 backbone with feature dimension: 2048
2025-03-02 18:45:20,884 - FashionHybridModel - INFO - Heatmap encoder initialized with output dimension: 256
2025-03-02 18:45:20,884 - FashionHybridModel - INFO - Attribute encoder initialized with output dimension: 64
2025-03-02 18:45:20,884 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2368
2025-03-02 18:45:20,893 - FashionHybridModel - INFO - Model initialization complete
2025-03-02 18:45:20,896 - FashionHybridModel - INFO - Image encoder backbone has been frozen
2025-03-02 20:32:43,260 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-03-02 20:32:44,419 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-03-02 20:32:44,419 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-02 20:32:44,419 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-02 20:32:44,427 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-02 20:32:44,427 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-02 20:32:44,429 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-02 20:32:44,531 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-02 20:32:44,531 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-02 20:32:44,542 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-02 20:32:44,542 - FashionDataset - INFO - Validating dataset files...
2025-03-02 20:32:44,592 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-02 20:32:44,592 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-03-02 20:32:44,820 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-03-02 20:32:44,820 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-02 20:32:44,820 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-02 20:32:44,820 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-02 20:32:44,820 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-02 20:32:44,820 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-02 20:32:44,847 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-02 20:32:44,850 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-02 20:32:44,851 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-02 20:32:44,852 - FashionDataset - INFO - Validating dataset files...
2025-03-02 20:32:44,893 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-02 20:32:44,893 - TrainingScript - INFO -  Category labels are correctly indexed from 0 to 45.
2025-03-02 20:32:44,949 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-03-02 20:32:44,949 - FashionHybridModel - INFO - Parameters: num_categories=46, num_category_types=3, num_attributes=50, embed_dim=256
2025-03-02 20:32:45,440 - FashionHybridModel - INFO - Initialized resnet50 backbone with feature dimension: 2048
2025-03-02 20:32:45,446 - FashionHybridModel - INFO - Heatmap encoder initialized with output dimension: 256
2025-03-02 20:32:45,448 - FashionHybridModel - INFO - Attribute encoder initialized with output dimension: 64
2025-03-02 20:32:45,448 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2368
2025-03-02 20:32:45,455 - FashionHybridModel - INFO - Model initialization complete
2025-03-02 20:32:45,458 - FashionHybridModel - INFO - Image encoder backbone has been frozen
2025-03-04 01:42:22,761 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-03-04 01:42:23,583 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-03-04 01:42:23,583 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-04 01:42:23,583 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-04 01:42:23,599 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-04 01:42:23,599 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-04 01:42:23,599 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-04 01:42:23,726 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-04 01:42:23,731 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-04 01:42:23,739 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-04 01:42:23,739 - FashionDataset - INFO - Validating dataset files...
2025-03-04 01:42:23,789 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-04 01:42:23,789 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-03-04 01:42:23,948 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-03-04 01:42:23,963 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-04 01:42:23,963 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-04 01:42:23,963 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-04 01:42:23,965 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-04 01:42:23,965 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-04 01:42:23,981 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-04 01:42:23,981 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-04 01:42:23,981 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-04 01:42:23,981 - FashionDataset - INFO - Validating dataset files...
2025-03-04 01:42:24,043 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-04 01:42:24,043 - TrainingScript - INFO -  Category labels are correctly indexed from 0 to 45.
2025-03-04 01:42:24,086 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-03-04 01:42:24,086 - FashionHybridModel - INFO - Parameters: num_categories=46, num_category_types=3, num_attributes=50, embed_dim=256
2025-03-04 01:42:24,609 - FashionHybridModel - INFO - Initialized resnet50 backbone with feature dimension: 2048
2025-03-04 01:42:24,613 - FashionHybridModel - INFO - Heatmap encoder initialized with output dimension: 256
2025-03-04 01:42:24,613 - FashionHybridModel - INFO - Attribute encoder initialized with output dimension: 64
2025-03-04 01:42:24,613 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2368
2025-03-04 01:42:24,621 - FashionHybridModel - INFO - Model initialization complete
2025-03-04 01:42:24,625 - FashionHybridModel - INFO - Image encoder backbone has been frozen
2025-03-04 01:42:39,856 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([32, 3, 224, 224]), Heatmap: torch.Size([32, 1, 224, 224]), Attributes: torch.Size([32, 50])
2025-03-04 01:42:42,496 - FashionHybridModel - INFO - Image features shape: torch.Size([32, 2048])
2025-03-04 01:42:43,029 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([32, 256])
2025-03-04 01:42:43,039 - FashionHybridModel - INFO - Attribute features shape: torch.Size([32, 64])
2025-03-04 01:42:43,045 - FashionHybridModel - INFO - Fused features shape: torch.Size([32, 256])
2025-03-04 01:42:43,065 - TrainingScript - ERROR - Error during forward pass or loss computation: 'compatibility_score'
2025-03-04 01:42:43,065 - TrainingScript - ERROR - Input shapes - Images: torch.Size([32, 3, 224, 224]), Heatmaps: torch.Size([32, 1, 224, 224]), Attributes: torch.Size([32, 50])
2025-03-04 01:47:25,918 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-03-04 01:47:26,689 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-03-04 01:47:26,689 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-04 01:47:26,689 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-04 01:47:26,689 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-04 01:47:26,693 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-04 01:47:26,693 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-04 01:47:26,767 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-04 01:47:26,767 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-04 01:47:26,774 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-04 01:47:26,774 - FashionDataset - INFO - Validating dataset files...
2025-03-04 01:47:26,879 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-04 01:47:26,879 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-03-04 01:47:27,030 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-03-04 01:47:27,030 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-04 01:47:27,030 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-04 01:47:27,032 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-04 01:47:27,032 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-04 01:47:27,033 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-04 01:47:27,045 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-04 01:47:27,045 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-04 01:47:27,050 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-04 01:47:27,050 - FashionDataset - INFO - Validating dataset files...
2025-03-04 01:47:27,151 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-04 01:47:27,151 - TrainingScript - INFO -  Category labels are correctly indexed from 0 to 45.
2025-03-04 01:47:27,194 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-03-04 01:47:27,194 - FashionHybridModel - INFO - Parameters: num_categories=46, num_category_types=3, num_attributes=50, embed_dim=256
2025-03-04 01:47:27,536 - FashionHybridModel - INFO - Initialized resnet50 backbone with feature dimension: 2048
2025-03-04 01:47:27,539 - FashionHybridModel - INFO - Heatmap encoder initialized with output dimension: 256
2025-03-04 01:47:27,541 - FashionHybridModel - INFO - Attribute encoder initialized with output dimension: 64
2025-03-04 01:47:27,541 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2368
2025-03-04 01:47:27,549 - FashionHybridModel - INFO - Model initialization complete
2025-03-04 01:47:27,549 - FashionHybridModel - INFO - Image encoder backbone has been frozen
2025-03-04 01:47:42,988 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([32, 3, 224, 224]), Heatmap: torch.Size([32, 1, 224, 224]), Attributes: torch.Size([32, 50])
2025-03-04 01:47:45,308 - FashionHybridModel - INFO - Image features shape: torch.Size([32, 2048])
2025-03-04 01:47:45,902 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([32, 256])
2025-03-04 01:47:45,903 - FashionHybridModel - INFO - Attribute features shape: torch.Size([32, 64])
2025-03-04 01:47:45,904 - FashionHybridModel - INFO - Fused features shape: torch.Size([32, 256])
2025-03-04 01:47:45,909 - TrainingScript - ERROR - Error during forward pass or loss computation: 'compatibility_score'
2025-03-04 01:47:45,909 - TrainingScript - ERROR - Input shapes - Images: torch.Size([32, 3, 224, 224]), Heatmaps: torch.Size([32, 1, 224, 224]), Attributes: torch.Size([32, 50])
2025-03-04 01:55:15,488 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-03-04 01:55:16,236 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-03-04 01:55:16,236 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-04 01:55:16,236 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-04 01:55:16,238 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-04 01:55:16,238 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-04 01:55:16,240 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-04 01:55:16,312 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-04 01:55:16,312 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-04 01:55:16,320 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-04 01:55:16,320 - FashionDataset - INFO - Validating dataset files...
2025-03-04 01:55:16,366 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-04 01:55:16,366 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-03-04 01:55:16,517 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-03-04 01:55:16,517 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-04 01:55:16,517 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-04 01:55:16,517 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-04 01:55:16,530 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-04 01:55:16,530 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-04 01:55:16,543 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-04 01:55:16,545 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-04 01:55:16,546 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-04 01:55:16,547 - FashionDataset - INFO - Validating dataset files...
2025-03-04 01:55:16,605 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-04 01:55:16,605 - TrainingScript - INFO -  Category labels are correctly indexed from 0 to 45.
2025-03-04 01:55:16,644 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-03-04 01:55:16,645 - FashionHybridModel - INFO - Parameters: num_categories=46, num_category_types=3, num_attributes=50, embed_dim=256
2025-03-04 01:55:16,961 - FashionHybridModel - INFO - Initialized resnet50 backbone with feature dimension: 2048
2025-03-04 01:55:16,975 - FashionHybridModel - INFO - Heatmap encoder initialized with output dimension: 256
2025-03-04 01:55:16,977 - FashionHybridModel - INFO - Attribute encoder initialized with output dimension: 64
2025-03-04 01:55:16,977 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2368
2025-03-04 01:55:16,982 - FashionHybridModel - INFO - Model initialization complete
2025-03-04 01:55:16,983 - FashionHybridModel - INFO - Image encoder backbone has been frozen
2025-03-04 01:56:27,780 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-03-04 01:56:28,524 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-03-04 01:56:28,524 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-04 01:56:28,524 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-04 01:56:28,534 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-04 01:56:28,535 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-04 01:56:28,536 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-04 01:56:28,603 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-04 01:56:28,603 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-04 01:56:28,603 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-04 01:56:28,603 - FashionDataset - INFO - Validating dataset files...
2025-03-04 01:56:28,667 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-04 01:56:28,667 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-03-04 01:56:28,806 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-03-04 01:56:28,806 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-04 01:56:28,806 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-04 01:56:28,806 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-04 01:56:28,806 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-04 01:56:28,822 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-04 01:56:28,822 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-04 01:56:28,837 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-04 01:56:28,838 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-04 01:56:28,839 - FashionDataset - INFO - Validating dataset files...
2025-03-04 01:56:28,881 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-04 01:56:28,881 - TrainingScript - INFO -  Category labels are correctly indexed from 0 to 45.
2025-03-04 01:56:28,924 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-03-04 01:56:28,924 - FashionHybridModel - INFO - Parameters: num_categories=46, num_category_types=3, num_attributes=50, embed_dim=256
2025-03-04 01:56:29,231 - FashionHybridModel - INFO - Initialized resnet50 backbone with feature dimension: 2048
2025-03-04 01:56:29,236 - FashionHybridModel - INFO - Heatmap encoder initialized with output dimension: 256
2025-03-04 01:56:29,238 - FashionHybridModel - INFO - Attribute encoder initialized with output dimension: 64
2025-03-04 01:56:29,238 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2368
2025-03-04 01:56:29,244 - FashionHybridModel - INFO - Model initialization complete
2025-03-04 01:56:29,247 - FashionHybridModel - INFO - Image encoder backbone has been frozen
2025-03-04 01:56:42,966 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([32, 3, 224, 224]), Heatmap: torch.Size([32, 1, 224, 224]), Attributes: torch.Size([32, 50])
2025-03-04 01:56:45,278 - FashionHybridModel - INFO - Image features shape: torch.Size([32, 2048])
2025-03-04 01:56:45,838 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([32, 256])
2025-03-04 01:56:45,841 - FashionHybridModel - INFO - Attribute features shape: torch.Size([32, 64])
2025-03-04 01:56:45,841 - FashionHybridModel - INFO - Fused features shape: torch.Size([32, 256])
2025-03-04 01:56:45,846 - TrainingScript - ERROR - Error during forward pass or loss computation: 'compatibility_score'
2025-03-04 01:56:45,847 - TrainingScript - ERROR - Input shapes - Images: torch.Size([32, 3, 224, 224]), Heatmaps: torch.Size([32, 1, 224, 224]), Attributes: torch.Size([32, 50])
2025-03-04 01:59:18,162 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-03-04 01:59:18,960 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-03-04 01:59:18,961 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-04 01:59:18,961 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-04 01:59:18,961 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-04 01:59:18,961 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-04 01:59:18,965 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-04 01:59:19,031 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-04 01:59:19,031 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-04 01:59:19,045 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-04 01:59:19,045 - FashionDataset - INFO - Validating dataset files...
2025-03-04 01:59:19,107 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-04 01:59:19,123 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-03-04 01:59:19,266 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-03-04 01:59:19,266 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-04 01:59:19,266 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-04 01:59:19,273 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-04 01:59:19,273 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-04 01:59:19,273 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-04 01:59:19,289 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-04 01:59:19,291 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-04 01:59:19,292 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-04 01:59:19,293 - FashionDataset - INFO - Validating dataset files...
2025-03-04 01:59:19,330 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-04 01:59:19,330 - TrainingScript - INFO -  Category labels are correctly indexed from 0 to 45.
2025-03-04 01:59:19,368 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-03-04 01:59:19,368 - FashionHybridModel - INFO - Parameters: num_categories=46, num_category_types=3, num_attributes=50, embed_dim=256
2025-03-04 01:59:19,639 - FashionHybridModel - INFO - Initialized resnet50 backbone with feature dimension: 2048
2025-03-04 01:59:19,650 - FashionHybridModel - INFO - Heatmap encoder initialized with output dimension: 256
2025-03-04 01:59:19,650 - FashionHybridModel - INFO - Attribute encoder initialized with output dimension: 64
2025-03-04 01:59:19,650 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2368
2025-03-04 01:59:19,659 - FashionHybridModel - INFO - Model initialization complete
2025-03-04 01:59:19,659 - FashionHybridModel - INFO - Image encoder backbone has been frozen
2025-03-04 01:59:34,265 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([32, 3, 224, 224]), Heatmap: torch.Size([32, 1, 224, 224]), Attributes: torch.Size([32, 50])
2025-03-04 01:59:36,704 - FashionHybridModel - INFO - Image features shape: torch.Size([32, 2048])
2025-03-04 01:59:37,249 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([32, 256])
2025-03-04 01:59:37,251 - FashionHybridModel - INFO - Attribute features shape: torch.Size([32, 64])
2025-03-04 01:59:37,251 - FashionHybridModel - INFO - Fused features shape: torch.Size([32, 256])
2025-03-04 01:59:37,255 - TrainingScript - ERROR - Error during forward pass or loss computation: 'compatibility_score'
2025-03-04 01:59:37,255 - TrainingScript - ERROR - Input shapes - Images: torch.Size([32, 3, 224, 224]), Heatmaps: torch.Size([32, 1, 224, 224]), Attributes: torch.Size([32, 50])
2025-03-04 02:06:50,783 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-03-04 02:06:51,528 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-03-04 02:06:51,528 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-04 02:06:51,528 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-04 02:06:51,528 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-04 02:06:51,528 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-04 02:06:51,528 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-04 02:06:51,605 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-04 02:06:51,617 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-04 02:06:51,622 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-04 02:06:51,622 - FashionDataset - INFO - Validating dataset files...
2025-03-04 02:06:51,656 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-04 02:06:51,656 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-03-04 02:06:51,814 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-03-04 02:06:51,814 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-04 02:06:51,814 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-04 02:06:51,814 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-04 02:06:51,814 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-04 02:06:51,822 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-04 02:06:51,840 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-04 02:06:51,841 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-04 02:06:51,843 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-04 02:06:51,843 - FashionDataset - INFO - Validating dataset files...
2025-03-04 02:06:51,885 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-04 02:06:51,885 - TrainingScript - INFO -  Category labels are correctly indexed from 0 to 45.
2025-03-04 02:06:51,915 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-03-04 02:06:51,916 - FashionHybridModel - INFO - Parameters: num_categories=46, num_category_types=3, num_attributes=50, embed_dim=256
2025-03-04 02:06:52,192 - FashionHybridModel - INFO - Initialized resnet50 backbone with feature dimension: 2048
2025-03-04 02:06:52,194 - FashionHybridModel - INFO - Heatmap encoder initialized with output dimension: 256
2025-03-04 02:06:52,196 - FashionHybridModel - INFO - Attribute encoder initialized with output dimension: 64
2025-03-04 02:06:52,196 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2368
2025-03-04 02:06:52,202 - FashionHybridModel - INFO - Model initialization complete
2025-03-04 02:06:52,205 - FashionHybridModel - INFO - Image encoder backbone has been frozen
2025-03-04 02:07:06,049 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([32, 3, 224, 224]), Heatmap: torch.Size([32, 1, 224, 224]), Attributes: torch.Size([32, 50])
2025-03-04 02:07:08,815 - FashionHybridModel - INFO - Image features shape: torch.Size([32, 2048])
2025-03-04 02:07:09,383 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([32, 256])
2025-03-04 02:07:09,397 - FashionHybridModel - INFO - Attribute features shape: torch.Size([32, 64])
2025-03-04 02:07:09,399 - FashionHybridModel - INFO - Fused features shape: torch.Size([32, 256])
2025-03-04 02:07:09,414 - TrainingScript - ERROR - Error during forward pass or loss computation: 'compatibility_score'
2025-03-04 02:07:09,415 - TrainingScript - ERROR - Input shapes - Images: torch.Size([32, 3, 224, 224]), Heatmaps: torch.Size([32, 1, 224, 224]), Attributes: torch.Size([32, 50])
2025-03-04 02:12:11,189 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-03-04 02:12:11,958 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-03-04 02:12:11,958 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-04 02:12:11,958 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-04 02:12:11,962 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-04 02:12:11,962 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-04 02:12:11,962 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-04 02:12:12,036 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-04 02:12:12,038 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-04 02:12:12,043 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-04 02:12:12,043 - FashionDataset - INFO - Validating dataset files...
2025-03-04 02:12:12,139 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-04 02:12:12,141 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-03-04 02:12:12,342 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-03-04 02:12:12,342 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-04 02:12:12,342 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-04 02:12:12,343 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-04 02:12:12,344 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-04 02:12:12,345 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-04 02:12:12,370 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-04 02:12:12,371 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-04 02:12:12,372 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-04 02:12:12,372 - FashionDataset - INFO - Validating dataset files...
2025-03-04 02:12:12,430 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-04 02:12:12,430 - TrainingScript - INFO -  Category labels are correctly indexed from 0 to 45.
2025-03-04 02:12:12,462 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-03-04 02:12:12,462 - FashionHybridModel - INFO - Parameters: num_categories=46, num_category_types=3, num_attributes=50, embed_dim=256
2025-03-04 02:12:12,779 - FashionHybridModel - INFO - Initialized resnet50 backbone with feature dimension: 2048
2025-03-04 02:12:12,783 - FashionHybridModel - INFO - Heatmap encoder initialized with output dimension: 256
2025-03-04 02:12:12,783 - FashionHybridModel - INFO - Attribute encoder initialized with output dimension: 64
2025-03-04 02:12:12,783 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2368
2025-03-04 02:12:12,789 - FashionHybridModel - INFO - Model initialization complete
2025-03-04 02:12:12,792 - FashionHybridModel - INFO - Image encoder backbone has been frozen
2025-03-04 02:12:27,775 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([32, 3, 224, 224]), Heatmap: torch.Size([32, 1, 224, 224]), Attributes: torch.Size([32, 50])
2025-03-04 02:12:30,167 - FashionHybridModel - INFO - Image features shape: torch.Size([32, 2048])
2025-03-04 02:12:30,746 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([32, 256])
2025-03-04 02:12:30,756 - FashionHybridModel - INFO - Attribute features shape: torch.Size([32, 64])
2025-03-04 02:12:30,759 - FashionHybridModel - INFO - Fused features shape: torch.Size([32, 256])
2025-03-04 02:12:30,778 - TrainingScript - ERROR - Error during forward pass or loss computation: 'compatibility_targets'
2025-03-04 02:12:30,778 - TrainingScript - ERROR - Input shapes - Images: torch.Size([32, 3, 224, 224]), Heatmaps: torch.Size([32, 1, 224, 224]), Attributes: torch.Size([32, 50])
2025-03-04 02:16:45,897 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-03-04 02:16:46,664 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-03-04 02:16:46,664 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-04 02:16:46,664 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-04 02:16:46,668 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-04 02:16:46,668 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-04 02:16:46,668 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-04 02:16:46,734 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-04 02:16:46,746 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-04 02:16:46,751 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-04 02:16:46,752 - FashionDataset - INFO - Validating dataset files...
2025-03-04 02:16:46,789 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-04 02:16:46,789 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-03-04 02:16:46,952 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-03-04 02:16:46,952 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-04 02:16:46,952 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-04 02:16:46,952 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-04 02:16:46,952 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-04 02:16:46,952 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-04 02:16:46,973 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-04 02:16:46,975 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-04 02:16:46,976 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-04 02:16:46,976 - FashionDataset - INFO - Validating dataset files...
2025-03-04 02:16:47,024 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-04 02:16:47,024 - TrainingScript - INFO -  Category labels are correctly indexed from 0 to 45.
2025-03-04 02:16:47,071 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-03-04 02:16:47,071 - FashionHybridModel - INFO - Parameters: num_categories=46, num_category_types=3, num_attributes=50, embed_dim=256
2025-03-04 02:16:47,380 - FashionHybridModel - INFO - Initialized resnet50 backbone with feature dimension: 2048
2025-03-04 02:16:47,380 - FashionHybridModel - INFO - Heatmap encoder initialized with output dimension: 256
2025-03-04 02:16:47,380 - FashionHybridModel - INFO - Attribute encoder initialized with output dimension: 64
2025-03-04 02:16:47,385 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2368
2025-03-04 02:16:47,385 - FashionHybridModel - INFO - Model initialization complete
2025-03-04 02:16:47,393 - FashionHybridModel - INFO - Image encoder backbone has been frozen
2025-03-04 02:17:01,453 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([32, 3, 224, 224]), Heatmap: torch.Size([32, 1, 224, 224]), Attributes: torch.Size([32, 50])
2025-03-04 02:17:03,779 - FashionHybridModel - INFO - Image features shape: torch.Size([32, 2048])
2025-03-04 02:17:04,336 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([32, 256])
2025-03-04 02:17:04,338 - FashionHybridModel - INFO - Attribute features shape: torch.Size([32, 64])
2025-03-04 02:17:04,340 - FashionHybridModel - INFO - Fused features shape: torch.Size([32, 256])
2025-03-04 02:17:04,345 - TrainingScript - ERROR - Error during forward pass or loss computation: 'compatibility_targets'
2025-03-04 02:17:04,346 - TrainingScript - ERROR - Input shapes - Images: torch.Size([32, 3, 224, 224]), Heatmaps: torch.Size([32, 1, 224, 224]), Attributes: torch.Size([32, 50])
2025-03-04 02:25:10,812 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-03-04 02:25:11,725 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-03-04 02:25:11,725 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-04 02:25:11,725 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-04 02:25:11,725 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-04 02:25:11,725 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-04 02:25:11,725 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-04 02:25:11,811 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-04 02:25:11,817 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-04 02:25:11,821 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-04 02:25:11,822 - FashionDataset - INFO - Validating dataset files...
2025-03-04 02:25:11,866 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-04 02:25:11,866 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-03-04 02:25:12,024 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-03-04 02:25:12,024 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-04 02:25:12,024 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-04 02:25:12,024 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-04 02:25:12,024 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-04 02:25:12,024 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-04 02:25:12,046 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-04 02:25:12,048 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-04 02:25:12,049 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-04 02:25:12,049 - FashionDataset - INFO - Validating dataset files...
2025-03-04 02:25:12,097 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-04 02:25:12,097 - TrainingScript - INFO -  Category labels are correctly indexed from 0 to 45.
2025-03-04 02:25:12,128 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-03-04 02:25:12,128 - FashionHybridModel - INFO - Parameters: num_categories=46, num_category_types=3, num_attributes=50, embed_dim=256
2025-03-04 02:25:12,466 - FashionHybridModel - INFO - Initialized resnet50 backbone with feature dimension: 2048
2025-03-04 02:25:12,468 - FashionHybridModel - INFO - Heatmap encoder initialized with output dimension: 256
2025-03-04 02:25:12,470 - FashionHybridModel - INFO - Attribute encoder initialized with output dimension: 64
2025-03-04 02:25:12,470 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2368
2025-03-04 02:25:12,477 - FashionHybridModel - INFO - Model initialization complete
2025-03-04 02:25:12,478 - FashionHybridModel - INFO - Image encoder backbone has been frozen
2025-03-04 02:25:26,282 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([32, 3, 224, 224]), Heatmap: torch.Size([32, 1, 224, 224]), Attributes: torch.Size([32, 50])
2025-03-04 02:25:28,462 - FashionHybridModel - INFO - Image features shape: torch.Size([32, 2048])
2025-03-04 02:25:28,989 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([32, 256])
2025-03-04 02:25:28,989 - FashionHybridModel - INFO - Attribute features shape: torch.Size([32, 64])
2025-03-04 02:25:28,989 - FashionHybridModel - INFO - Fused features shape: torch.Size([32, 256])
2025-03-04 02:25:28,997 - TrainingScript - ERROR - Error during forward pass or loss computation: 'FashionMultiTaskLoss' object has no attribute 'compatibility_weight'
2025-03-04 02:25:28,998 - TrainingScript - ERROR - Input shapes - Images: torch.Size([32, 3, 224, 224]), Heatmaps: torch.Size([32, 1, 224, 224]), Attributes: torch.Size([32, 50])
2025-03-04 02:28:16,789 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-03-04 02:28:17,544 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-03-04 02:28:17,544 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-04 02:28:17,544 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-04 02:28:17,544 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-04 02:28:17,544 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-04 02:28:17,544 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-04 02:28:17,608 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-04 02:28:17,623 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-04 02:28:17,624 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-04 02:28:17,624 - FashionDataset - INFO - Validating dataset files...
2025-03-04 02:28:17,676 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-04 02:28:17,676 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-03-04 02:28:17,819 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-03-04 02:28:17,819 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-04 02:28:17,834 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-04 02:28:17,835 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-04 02:28:17,835 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-04 02:28:17,835 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-04 02:28:17,838 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-04 02:28:17,851 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-04 02:28:17,852 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-04 02:28:17,852 - FashionDataset - INFO - Validating dataset files...
2025-03-04 02:28:17,898 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-04 02:28:17,906 - TrainingScript - INFO -  Category labels are correctly indexed from 0 to 45.
2025-03-04 02:28:17,939 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-03-04 02:28:17,939 - FashionHybridModel - INFO - Parameters: num_categories=46, num_category_types=3, num_attributes=50, embed_dim=256
2025-03-04 02:28:18,244 - FashionHybridModel - INFO - Initialized resnet50 backbone with feature dimension: 2048
2025-03-04 02:28:18,246 - FashionHybridModel - INFO - Heatmap encoder initialized with output dimension: 256
2025-03-04 02:28:18,248 - FashionHybridModel - INFO - Attribute encoder initialized with output dimension: 64
2025-03-04 02:28:18,248 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2368
2025-03-04 02:28:18,252 - FashionHybridModel - INFO - Model initialization complete
2025-03-04 02:28:18,254 - FashionHybridModel - INFO - Image encoder backbone has been frozen
2025-03-04 02:28:31,856 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([32, 3, 224, 224]), Heatmap: torch.Size([32, 1, 224, 224]), Attributes: torch.Size([32, 50])
2025-03-04 02:28:34,186 - FashionHybridModel - INFO - Image features shape: torch.Size([32, 2048])
2025-03-04 02:28:34,777 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([32, 256])
2025-03-04 02:28:34,779 - FashionHybridModel - INFO - Attribute features shape: torch.Size([32, 64])
2025-03-04 02:28:34,781 - FashionHybridModel - INFO - Fused features shape: torch.Size([32, 256])
2025-03-04 02:33:22,011 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-03-04 02:33:22,815 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-03-04 02:33:22,815 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-04 02:33:22,815 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-04 02:33:22,820 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-04 02:33:22,820 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-04 02:33:22,820 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-04 02:33:22,889 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-04 02:33:22,889 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-04 02:33:22,907 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-04 02:33:22,907 - FashionDataset - INFO - Validating dataset files...
2025-03-04 02:33:22,949 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-04 02:33:22,949 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-03-04 02:33:23,123 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-03-04 02:33:23,123 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-04 02:33:23,123 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-04 02:33:23,126 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-04 02:33:23,126 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-04 02:33:23,126 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-04 02:33:23,150 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-04 02:33:23,150 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-04 02:33:23,153 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-04 02:33:23,155 - FashionDataset - INFO - Validating dataset files...
2025-03-04 02:33:23,208 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-04 02:33:23,208 - TrainingScript - INFO -  Category labels are correctly indexed from 0 to 45.
2025-03-04 02:33:23,246 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-03-04 02:33:23,246 - FashionHybridModel - INFO - Parameters: num_categories=46, num_category_types=3, num_attributes=50, embed_dim=256
2025-03-04 02:33:23,553 - FashionHybridModel - INFO - Initialized resnet50 backbone with feature dimension: 2048
2025-03-04 02:33:23,555 - FashionHybridModel - INFO - Heatmap encoder initialized with output dimension: 256
2025-03-04 02:33:23,555 - FashionHybridModel - INFO - Attribute encoder initialized with output dimension: 64
2025-03-04 02:33:23,555 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2368
2025-03-04 02:33:23,555 - FashionHybridModel - INFO - Model initialization complete
2025-03-04 02:33:23,565 - FashionHybridModel - INFO - Image encoder backbone has been frozen
2025-03-04 02:33:38,524 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([32, 3, 224, 224]), Heatmap: torch.Size([32, 1, 224, 224]), Attributes: torch.Size([32, 50])
2025-03-04 02:33:41,012 - FashionHybridModel - INFO - Image features shape: torch.Size([32, 2048])
2025-03-04 02:33:41,631 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([32, 256])
2025-03-04 02:33:41,633 - FashionHybridModel - INFO - Attribute features shape: torch.Size([32, 64])
2025-03-04 02:33:41,635 - FashionHybridModel - INFO - Fused features shape: torch.Size([32, 256])
2025-03-04 02:33:42,490 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([32, 3, 224, 224]), Heatmap: torch.Size([32, 1, 224, 224]), Attributes: torch.Size([32, 50])
2025-03-04 02:33:44,864 - FashionHybridModel - INFO - Image features shape: torch.Size([32, 2048])
2025-03-04 02:33:45,423 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([32, 256])
2025-03-04 02:33:45,423 - FashionHybridModel - INFO - Attribute features shape: torch.Size([32, 64])
2025-03-04 02:33:45,423 - FashionHybridModel - INFO - Fused features shape: torch.Size([32, 256])
2025-03-04 02:33:46,052 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([32, 3, 224, 224]), Heatmap: torch.Size([32, 1, 224, 224]), Attributes: torch.Size([32, 50])
2025-03-04 02:33:48,079 - FashionHybridModel - INFO - Image features shape: torch.Size([32, 2048])
2025-03-04 02:33:48,622 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([32, 256])
2025-03-04 02:33:48,622 - FashionHybridModel - INFO - Attribute features shape: torch.Size([32, 64])
2025-03-04 02:33:48,622 - FashionHybridModel - INFO - Fused features shape: torch.Size([32, 256])
2025-03-04 02:33:49,268 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([32, 3, 224, 224]), Heatmap: torch.Size([32, 1, 224, 224]), Attributes: torch.Size([32, 50])
2025-03-04 02:33:51,460 - FashionHybridModel - INFO - Image features shape: torch.Size([32, 2048])
2025-03-04 02:33:51,914 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([32, 256])
2025-03-04 02:33:51,914 - FashionHybridModel - INFO - Attribute features shape: torch.Size([32, 64])
2025-03-04 02:33:51,914 - FashionHybridModel - INFO - Fused features shape: torch.Size([32, 256])
2025-03-04 02:33:52,580 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([32, 3, 224, 224]), Heatmap: torch.Size([32, 1, 224, 224]), Attributes: torch.Size([32, 50])
2025-03-04 02:33:54,788 - FashionHybridModel - INFO - Image features shape: torch.Size([32, 2048])
2025-03-04 02:33:55,293 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([32, 256])
2025-03-04 02:33:55,295 - FashionHybridModel - INFO - Attribute features shape: torch.Size([32, 64])
2025-03-04 02:33:55,295 - FashionHybridModel - INFO - Fused features shape: torch.Size([32, 256])
2025-03-04 02:33:56,010 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([32, 3, 224, 224]), Heatmap: torch.Size([32, 1, 224, 224]), Attributes: torch.Size([32, 50])
2025-03-04 02:33:58,186 - FashionHybridModel - INFO - Image features shape: torch.Size([32, 2048])
2025-03-04 02:33:58,673 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([32, 256])
2025-03-04 02:33:58,673 - FashionHybridModel - INFO - Attribute features shape: torch.Size([32, 64])
2025-03-04 02:33:58,673 - FashionHybridModel - INFO - Fused features shape: torch.Size([32, 256])
2025-03-04 02:33:59,299 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([32, 3, 224, 224]), Heatmap: torch.Size([32, 1, 224, 224]), Attributes: torch.Size([32, 50])
2025-03-04 02:34:01,422 - FashionHybridModel - INFO - Image features shape: torch.Size([32, 2048])
2025-03-04 02:34:01,858 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([32, 256])
2025-03-04 02:34:01,858 - FashionHybridModel - INFO - Attribute features shape: torch.Size([32, 64])
2025-03-04 02:34:01,858 - FashionHybridModel - INFO - Fused features shape: torch.Size([32, 256])
2025-03-04 02:34:02,493 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([32, 3, 224, 224]), Heatmap: torch.Size([32, 1, 224, 224]), Attributes: torch.Size([32, 50])
2025-03-04 02:34:04,713 - FashionHybridModel - INFO - Image features shape: torch.Size([32, 2048])
2025-03-04 02:34:05,177 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([32, 256])
2025-03-04 02:34:05,177 - FashionHybridModel - INFO - Attribute features shape: torch.Size([32, 64])
2025-03-04 02:34:05,177 - FashionHybridModel - INFO - Fused features shape: torch.Size([32, 256])
2025-03-04 02:34:05,803 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([32, 3, 224, 224]), Heatmap: torch.Size([32, 1, 224, 224]), Attributes: torch.Size([32, 50])
2025-03-04 02:34:07,940 - FashionHybridModel - INFO - Image features shape: torch.Size([32, 2048])
2025-03-04 02:34:08,467 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([32, 256])
2025-03-04 02:34:08,467 - FashionHybridModel - INFO - Attribute features shape: torch.Size([32, 64])
2025-03-04 02:34:08,467 - FashionHybridModel - INFO - Fused features shape: torch.Size([32, 256])
2025-03-04 02:34:09,105 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([32, 3, 224, 224]), Heatmap: torch.Size([32, 1, 224, 224]), Attributes: torch.Size([32, 50])
2025-03-04 02:34:11,219 - FashionHybridModel - INFO - Image features shape: torch.Size([32, 2048])
2025-03-04 02:34:11,668 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([32, 256])
2025-03-04 02:34:11,668 - FashionHybridModel - INFO - Attribute features shape: torch.Size([32, 64])
2025-03-04 02:34:11,668 - FashionHybridModel - INFO - Fused features shape: torch.Size([32, 256])
2025-03-04 02:34:12,359 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([32, 3, 224, 224]), Heatmap: torch.Size([32, 1, 224, 224]), Attributes: torch.Size([32, 50])
2025-03-04 02:34:14,497 - FashionHybridModel - INFO - Image features shape: torch.Size([32, 2048])
2025-03-04 02:34:14,977 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([32, 256])
2025-03-04 02:34:14,977 - FashionHybridModel - INFO - Attribute features shape: torch.Size([32, 64])
2025-03-04 02:34:14,977 - FashionHybridModel - INFO - Fused features shape: torch.Size([32, 256])
2025-03-04 02:34:15,608 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([32, 3, 224, 224]), Heatmap: torch.Size([32, 1, 224, 224]), Attributes: torch.Size([32, 50])
2025-03-04 02:34:17,596 - FashionHybridModel - INFO - Image features shape: torch.Size([32, 2048])
2025-03-04 02:34:18,074 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([32, 256])
2025-03-04 02:34:18,090 - FashionHybridModel - INFO - Attribute features shape: torch.Size([32, 64])
2025-03-04 02:34:18,090 - FashionHybridModel - INFO - Fused features shape: torch.Size([32, 256])
2025-03-04 02:34:18,704 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([32, 3, 224, 224]), Heatmap: torch.Size([32, 1, 224, 224]), Attributes: torch.Size([32, 50])
2025-03-04 02:34:20,821 - FashionHybridModel - INFO - Image features shape: torch.Size([32, 2048])
2025-03-04 02:34:21,270 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([32, 256])
2025-03-04 02:34:21,270 - FashionHybridModel - INFO - Attribute features shape: torch.Size([32, 64])
2025-03-04 02:34:21,270 - FashionHybridModel - INFO - Fused features shape: torch.Size([32, 256])
2025-03-04 02:34:21,981 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([32, 3, 224, 224]), Heatmap: torch.Size([32, 1, 224, 224]), Attributes: torch.Size([32, 50])
2025-03-04 02:34:24,220 - FashionHybridModel - INFO - Image features shape: torch.Size([32, 2048])
2025-03-04 02:34:24,755 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([32, 256])
2025-03-04 02:34:24,756 - FashionHybridModel - INFO - Attribute features shape: torch.Size([32, 64])
2025-03-04 02:34:24,757 - FashionHybridModel - INFO - Fused features shape: torch.Size([32, 256])
2025-03-04 02:34:25,362 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([32, 3, 224, 224]), Heatmap: torch.Size([32, 1, 224, 224]), Attributes: torch.Size([32, 50])
2025-03-04 12:23:05,455 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-03-04 12:23:06,200 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-03-04 12:23:06,211 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-04 12:23:06,211 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-04 12:23:06,216 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-04 12:23:06,216 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-04 12:23:06,219 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-04 12:23:06,295 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-04 12:23:06,295 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-04 12:23:06,303 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-04 12:23:06,303 - FashionDataset - INFO - Validating dataset files...
2025-03-04 12:23:06,383 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-04 12:23:06,390 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-03-04 12:23:06,538 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-03-04 12:23:06,538 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-04 12:23:06,538 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-04 12:23:06,538 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-04 12:23:06,538 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-04 12:23:06,538 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-04 12:23:06,557 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-04 12:23:06,557 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-04 12:23:06,557 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-04 12:23:06,557 - FashionDataset - INFO - Validating dataset files...
2025-03-04 12:23:06,640 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-04 12:23:06,648 - TrainingScript - INFO -  Category labels are correctly indexed from 0 to 45.
2025-03-04 12:23:06,678 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-03-04 12:23:06,678 - FashionHybridModel - INFO - Parameters: num_categories=46, num_category_types=3, num_attributes=50, embed_dim=256
2025-03-04 12:23:07,117 - FashionHybridModel - INFO - Initialized resnet50 backbone with feature dimension: 2048
2025-03-04 12:23:07,117 - FashionHybridModel - INFO - Heatmap encoder initialized with output dimension: 256
2025-03-04 12:23:07,131 - FashionHybridModel - INFO - Attribute encoder initialized with output dimension: 64
2025-03-04 12:23:07,131 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2368
2025-03-04 12:23:07,136 - FashionHybridModel - INFO - Model initialization complete
2025-03-04 12:23:07,140 - FashionHybridModel - INFO - Image encoder backbone has been frozen
2025-03-04 12:23:21,175 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([32, 3, 224, 224]), Heatmap: torch.Size([32, 1, 224, 224]), Attributes: torch.Size([32, 50])
2025-03-04 12:23:23,859 - FashionHybridModel - INFO - Image features shape: torch.Size([32, 2048])
2025-03-04 12:23:24,443 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([32, 256])
2025-03-04 12:23:24,450 - FashionHybridModel - INFO - Attribute features shape: torch.Size([32, 64])
2025-03-04 12:23:24,457 - FashionHybridModel - INFO - Fused features shape: torch.Size([32, 256])
2025-03-04 12:23:25,258 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([32, 3, 224, 224]), Heatmap: torch.Size([32, 1, 224, 224]), Attributes: torch.Size([32, 50])
2025-03-04 12:23:27,486 - FashionHybridModel - INFO - Image features shape: torch.Size([32, 2048])
2025-03-04 12:23:28,089 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([32, 256])
2025-03-04 12:23:28,091 - FashionHybridModel - INFO - Attribute features shape: torch.Size([32, 64])
2025-03-04 12:23:28,091 - FashionHybridModel - INFO - Fused features shape: torch.Size([32, 256])
2025-03-04 12:23:28,816 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([32, 3, 224, 224]), Heatmap: torch.Size([32, 1, 224, 224]), Attributes: torch.Size([32, 50])
2025-03-04 12:23:30,998 - FashionHybridModel - INFO - Image features shape: torch.Size([32, 2048])
2025-03-04 12:23:31,485 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([32, 256])
2025-03-04 12:23:31,485 - FashionHybridModel - INFO - Attribute features shape: torch.Size([32, 64])
2025-03-04 12:23:31,493 - FashionHybridModel - INFO - Fused features shape: torch.Size([32, 256])
2025-03-04 12:23:32,311 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([32, 3, 224, 224]), Heatmap: torch.Size([32, 1, 224, 224]), Attributes: torch.Size([32, 50])
2025-03-04 12:23:34,746 - FashionHybridModel - INFO - Image features shape: torch.Size([32, 2048])
2025-03-04 12:23:35,343 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([32, 256])
2025-03-04 12:23:35,345 - FashionHybridModel - INFO - Attribute features shape: torch.Size([32, 64])
2025-03-04 12:23:35,345 - FashionHybridModel - INFO - Fused features shape: torch.Size([32, 256])
2025-03-04 12:23:36,090 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([32, 3, 224, 224]), Heatmap: torch.Size([32, 1, 224, 224]), Attributes: torch.Size([32, 50])
2025-03-04 12:23:38,478 - FashionHybridModel - INFO - Image features shape: torch.Size([32, 2048])
2025-03-04 12:23:38,948 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([32, 256])
2025-03-04 12:23:38,948 - FashionHybridModel - INFO - Attribute features shape: torch.Size([32, 64])
2025-03-04 12:23:38,948 - FashionHybridModel - INFO - Fused features shape: torch.Size([32, 256])
2025-03-04 12:23:39,659 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([32, 3, 224, 224]), Heatmap: torch.Size([32, 1, 224, 224]), Attributes: torch.Size([32, 50])
2025-03-04 12:23:41,843 - FashionHybridModel - INFO - Image features shape: torch.Size([32, 2048])
2025-03-04 12:23:42,367 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([32, 256])
2025-03-04 12:23:42,367 - FashionHybridModel - INFO - Attribute features shape: torch.Size([32, 64])
2025-03-04 12:23:42,367 - FashionHybridModel - INFO - Fused features shape: torch.Size([32, 256])
2025-03-04 12:23:43,059 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([32, 3, 224, 224]), Heatmap: torch.Size([32, 1, 224, 224]), Attributes: torch.Size([32, 50])
2025-03-04 12:23:45,299 - FashionHybridModel - INFO - Image features shape: torch.Size([32, 2048])
2025-03-04 12:23:45,832 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([32, 256])
2025-03-04 12:23:45,832 - FashionHybridModel - INFO - Attribute features shape: torch.Size([32, 64])
2025-03-04 12:23:45,832 - FashionHybridModel - INFO - Fused features shape: torch.Size([32, 256])
2025-03-04 12:23:46,632 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([32, 3, 224, 224]), Heatmap: torch.Size([32, 1, 224, 224]), Attributes: torch.Size([32, 50])
2025-03-04 12:23:48,773 - FashionHybridModel - INFO - Image features shape: torch.Size([32, 2048])
2025-03-04 12:23:49,271 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([32, 256])
2025-03-04 12:23:49,273 - FashionHybridModel - INFO - Attribute features shape: torch.Size([32, 64])
2025-03-04 12:23:49,273 - FashionHybridModel - INFO - Fused features shape: torch.Size([32, 256])
2025-03-04 12:23:50,163 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([32, 3, 224, 224]), Heatmap: torch.Size([32, 1, 224, 224]), Attributes: torch.Size([32, 50])
2025-03-04 12:23:52,697 - FashionHybridModel - INFO - Image features shape: torch.Size([32, 2048])
2025-03-04 12:23:53,213 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([32, 256])
2025-03-04 12:23:53,213 - FashionHybridModel - INFO - Attribute features shape: torch.Size([32, 64])
2025-03-04 12:23:53,213 - FashionHybridModel - INFO - Fused features shape: torch.Size([32, 256])
2025-03-04 12:23:53,879 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([32, 3, 224, 224]), Heatmap: torch.Size([32, 1, 224, 224]), Attributes: torch.Size([32, 50])
2025-03-04 12:38:53,392 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-03-04 12:38:54,141 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-03-04 12:38:54,141 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-04 12:38:54,141 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-04 12:38:54,141 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-04 12:38:54,141 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-04 12:38:54,141 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-04 12:38:54,221 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-04 12:38:54,237 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-04 12:38:54,244 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-04 12:38:54,244 - FashionDataset - INFO - Validating dataset files...
2025-03-04 12:38:54,300 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-04 12:38:54,300 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-03-04 12:38:54,444 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-03-04 12:38:54,444 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-04 12:38:54,444 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-04 12:38:54,444 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-04 12:38:54,444 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-04 12:38:54,444 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-04 12:38:54,460 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-04 12:38:54,460 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-04 12:38:54,475 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-04 12:38:54,475 - FashionDataset - INFO - Validating dataset files...
2025-03-04 12:38:54,523 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-04 12:38:54,523 - TrainingScript - INFO -  Category labels are correctly indexed from 0 to 45.
2025-03-04 12:38:54,574 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-03-04 12:38:54,574 - FashionHybridModel - INFO - Parameters: num_categories=46, num_category_types=3, num_attributes=50, embed_dim=256
2025-03-04 12:38:54,909 - FashionHybridModel - INFO - Initialized resnet50 backbone with feature dimension: 2048
2025-03-04 12:38:54,913 - FashionHybridModel - INFO - Heatmap encoder initialized with output dimension: 256
2025-03-04 12:38:54,915 - FashionHybridModel - INFO - Attribute encoder initialized with output dimension: 64
2025-03-04 12:38:54,915 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2368
2025-03-04 12:38:54,921 - FashionHybridModel - INFO - Model initialization complete
2025-03-04 12:38:54,925 - FashionHybridModel - INFO - Image encoder backbone has been unfrozen
2025-03-04 12:39:08,430 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([32, 3, 224, 224]), Heatmap: torch.Size([32, 1, 224, 224]), Attributes: torch.Size([32, 50])
2025-03-04 12:39:11,867 - FashionHybridModel - INFO - Image features shape: torch.Size([32, 2048])
2025-03-04 12:39:12,611 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([32, 256])
2025-03-04 12:39:12,619 - FashionHybridModel - INFO - Attribute features shape: torch.Size([32, 64])
2025-03-04 12:39:12,625 - FashionHybridModel - INFO - Fused features shape: torch.Size([32, 256])
2025-03-04 12:39:18,270 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([32, 3, 224, 224]), Heatmap: torch.Size([32, 1, 224, 224]), Attributes: torch.Size([32, 50])
2025-03-04 12:39:20,659 - FashionHybridModel - INFO - Image features shape: torch.Size([32, 2048])
2025-03-04 12:39:21,351 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([32, 256])
2025-03-04 12:39:21,353 - FashionHybridModel - INFO - Attribute features shape: torch.Size([32, 64])
2025-03-04 12:39:21,353 - FashionHybridModel - INFO - Fused features shape: torch.Size([32, 256])
2025-03-04 12:39:26,059 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([32, 3, 224, 224]), Heatmap: torch.Size([32, 1, 224, 224]), Attributes: torch.Size([32, 50])
2025-03-04 12:39:28,440 - FashionHybridModel - INFO - Image features shape: torch.Size([32, 2048])
2025-03-04 12:39:29,049 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([32, 256])
2025-03-04 12:39:29,050 - FashionHybridModel - INFO - Attribute features shape: torch.Size([32, 64])
2025-03-04 12:39:29,050 - FashionHybridModel - INFO - Fused features shape: torch.Size([32, 256])
2025-03-04 12:39:33,697 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([32, 3, 224, 224]), Heatmap: torch.Size([32, 1, 224, 224]), Attributes: torch.Size([32, 50])
2025-03-04 12:39:36,025 - FashionHybridModel - INFO - Image features shape: torch.Size([32, 2048])
2025-03-04 12:39:36,688 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([32, 256])
2025-03-04 12:39:36,688 - FashionHybridModel - INFO - Attribute features shape: torch.Size([32, 64])
2025-03-04 12:39:36,688 - FashionHybridModel - INFO - Fused features shape: torch.Size([32, 256])
2025-03-04 12:51:04,868 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-03-04 12:51:05,614 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-03-04 12:51:05,614 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-04 12:51:05,614 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-04 12:51:05,628 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-04 12:51:05,628 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-04 12:51:05,628 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-04 12:51:05,718 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-04 12:51:05,720 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-04 12:51:05,728 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-04 12:51:05,730 - FashionDataset - INFO - Validating dataset files...
2025-03-04 12:51:05,841 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-04 12:51:05,841 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-03-04 12:51:06,038 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-03-04 12:51:06,038 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-04 12:51:06,038 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-04 12:51:06,038 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-04 12:51:06,038 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-04 12:51:06,038 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-04 12:51:06,069 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-04 12:51:06,071 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-04 12:51:06,071 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-04 12:51:06,071 - FashionDataset - INFO - Validating dataset files...
2025-03-04 12:51:06,168 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-04 12:51:06,168 - TrainingScript - INFO -  Category labels are correctly indexed from 0 to 45.
2025-03-04 12:51:06,243 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-03-04 12:51:06,243 - FashionHybridModel - INFO - Parameters: num_categories=46, num_category_types=3, num_attributes=50, embed_dim=256
2025-03-04 12:51:06,682 - FashionHybridModel - INFO - Initialized resnet50 backbone with feature dimension: 2048
2025-03-04 12:51:06,682 - FashionHybridModel - INFO - Heatmap encoder initialized with output dimension: 256
2025-03-04 12:51:06,682 - FashionHybridModel - INFO - Attribute encoder initialized with output dimension: 64
2025-03-04 12:51:06,682 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2368
2025-03-04 12:51:06,700 - FashionHybridModel - INFO - Model initialization complete
2025-03-04 12:51:06,704 - FashionHybridModel - INFO - Image encoder backbone has been unfrozen
2025-03-04 12:51:20,930 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([32, 3, 224, 224]), Heatmap: torch.Size([32, 1, 224, 224]), Attributes: torch.Size([32, 50])
2025-03-04 12:51:23,591 - FashionHybridModel - INFO - Image features shape: torch.Size([32, 2048])
2025-03-04 12:51:24,360 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([32, 256])
2025-03-04 12:51:24,366 - FashionHybridModel - INFO - Attribute features shape: torch.Size([32, 64])
2025-03-04 12:51:24,374 - FashionHybridModel - INFO - Fused features shape: torch.Size([32, 256])
2025-03-04 12:51:29,512 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([32, 3, 224, 224]), Heatmap: torch.Size([32, 1, 224, 224]), Attributes: torch.Size([32, 50])
2025-03-04 12:51:31,676 - FashionHybridModel - INFO - Image features shape: torch.Size([32, 2048])
2025-03-04 12:51:32,379 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([32, 256])
2025-03-04 12:51:32,381 - FashionHybridModel - INFO - Attribute features shape: torch.Size([32, 64])
2025-03-04 12:51:32,381 - FashionHybridModel - INFO - Fused features shape: torch.Size([32, 256])
2025-03-04 12:51:37,191 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([32, 3, 224, 224]), Heatmap: torch.Size([32, 1, 224, 224]), Attributes: torch.Size([32, 50])
2025-03-04 12:51:39,403 - FashionHybridModel - INFO - Image features shape: torch.Size([32, 2048])
2025-03-04 12:51:40,006 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([32, 256])
2025-03-04 12:51:40,006 - FashionHybridModel - INFO - Attribute features shape: torch.Size([32, 64])
2025-03-04 12:51:40,006 - FashionHybridModel - INFO - Fused features shape: torch.Size([32, 256])
2025-03-04 12:51:44,448 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([32, 3, 224, 224]), Heatmap: torch.Size([32, 1, 224, 224]), Attributes: torch.Size([32, 50])
2025-03-04 12:51:46,697 - FashionHybridModel - INFO - Image features shape: torch.Size([32, 2048])
2025-03-04 12:51:47,293 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([32, 256])
2025-03-04 12:51:47,293 - FashionHybridModel - INFO - Attribute features shape: torch.Size([32, 64])
2025-03-04 12:51:47,295 - FashionHybridModel - INFO - Fused features shape: torch.Size([32, 256])
2025-03-04 12:51:51,550 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([32, 3, 224, 224]), Heatmap: torch.Size([32, 1, 224, 224]), Attributes: torch.Size([32, 50])
2025-03-04 12:51:53,809 - FashionHybridModel - INFO - Image features shape: torch.Size([32, 2048])
2025-03-04 12:51:54,373 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([32, 256])
2025-03-04 12:51:54,375 - FashionHybridModel - INFO - Attribute features shape: torch.Size([32, 64])
2025-03-04 12:51:54,375 - FashionHybridModel - INFO - Fused features shape: torch.Size([32, 256])
2025-03-04 12:51:58,566 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([32, 3, 224, 224]), Heatmap: torch.Size([32, 1, 224, 224]), Attributes: torch.Size([32, 50])
2025-03-04 12:52:00,938 - FashionHybridModel - INFO - Image features shape: torch.Size([32, 2048])
2025-03-04 12:52:01,453 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([32, 256])
2025-03-04 12:52:01,453 - FashionHybridModel - INFO - Attribute features shape: torch.Size([32, 64])
2025-03-04 12:52:01,453 - FashionHybridModel - INFO - Fused features shape: torch.Size([32, 256])
2025-03-04 12:52:05,829 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([32, 3, 224, 224]), Heatmap: torch.Size([32, 1, 224, 224]), Attributes: torch.Size([32, 50])
2025-03-04 12:52:08,611 - FashionHybridModel - INFO - Image features shape: torch.Size([32, 2048])
2025-03-04 12:52:09,360 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([32, 256])
2025-03-04 12:52:09,362 - FashionHybridModel - INFO - Attribute features shape: torch.Size([32, 64])
2025-03-04 12:52:09,362 - FashionHybridModel - INFO - Fused features shape: torch.Size([32, 256])
2025-03-04 12:52:13,797 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([32, 3, 224, 224]), Heatmap: torch.Size([32, 1, 224, 224]), Attributes: torch.Size([32, 50])
2025-03-04 12:52:16,058 - FashionHybridModel - INFO - Image features shape: torch.Size([32, 2048])
2025-03-04 12:57:40,241 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-03-04 12:57:41,042 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-03-04 12:57:41,042 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-04 12:57:41,042 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-04 12:57:41,047 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-04 12:57:41,047 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-04 12:57:41,052 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-04 12:57:41,130 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-04 12:57:41,132 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-04 12:57:41,138 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-04 12:57:41,138 - FashionDataset - INFO - Validating dataset files...
2025-03-04 12:57:41,235 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-04 12:57:41,235 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-03-04 12:57:41,390 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-03-04 12:57:41,390 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-04 12:57:41,390 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-04 12:57:41,390 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-04 12:57:41,390 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-04 12:57:41,390 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-04 12:57:41,411 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-04 12:57:41,412 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-04 12:57:41,413 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-04 12:57:41,414 - FashionDataset - INFO - Validating dataset files...
2025-03-04 12:57:41,538 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-04 12:57:41,538 - TrainingScript - INFO -  Category labels are correctly indexed from 0 to 45.
2025-03-04 12:57:41,584 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-03-04 12:57:41,594 - FashionHybridModel - INFO - Parameters: num_categories=46, num_category_types=3, num_attributes=50, embed_dim=256
2025-03-04 12:57:42,077 - FashionHybridModel - INFO - Initialized resnet50 backbone with feature dimension: 2048
2025-03-04 12:57:42,081 - FashionHybridModel - INFO - Heatmap encoder initialized with output dimension: 256
2025-03-04 12:57:42,081 - FashionHybridModel - INFO - Attribute encoder initialized with output dimension: 64
2025-03-04 12:57:42,083 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2368
2025-03-04 12:57:42,087 - FashionHybridModel - INFO - Model initialization complete
2025-03-04 12:57:42,091 - FashionHybridModel - INFO - Image encoder backbone has been unfrozen
2025-03-04 12:57:55,646 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([32, 3, 224, 224]), Heatmap: torch.Size([32, 1, 224, 224]), Attributes: torch.Size([32, 50])
2025-03-04 12:57:58,458 - FashionHybridModel - INFO - Image features shape: torch.Size([32, 2048])
2025-03-04 12:57:59,547 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([32, 256])
2025-03-04 12:57:59,567 - FashionHybridModel - INFO - Attribute features shape: torch.Size([32, 64])
2025-03-04 12:57:59,573 - FashionHybridModel - INFO - Fused features shape: torch.Size([32, 256])
2025-03-04 12:58:04,253 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([32, 3, 224, 224]), Heatmap: torch.Size([32, 1, 224, 224]), Attributes: torch.Size([32, 50])
2025-03-04 12:58:06,603 - FashionHybridModel - INFO - Image features shape: torch.Size([32, 2048])
2025-03-04 12:58:07,232 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([32, 256])
2025-03-04 12:58:07,234 - FashionHybridModel - INFO - Attribute features shape: torch.Size([32, 64])
2025-03-04 12:58:07,234 - FashionHybridModel - INFO - Fused features shape: torch.Size([32, 256])
2025-03-04 12:58:11,751 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([32, 3, 224, 224]), Heatmap: torch.Size([32, 1, 224, 224]), Attributes: torch.Size([32, 50])
2025-03-04 12:58:13,983 - FashionHybridModel - INFO - Image features shape: torch.Size([32, 2048])
2025-03-04 12:58:14,551 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([32, 256])
2025-03-04 12:58:14,551 - FashionHybridModel - INFO - Attribute features shape: torch.Size([32, 64])
2025-03-04 12:58:14,551 - FashionHybridModel - INFO - Fused features shape: torch.Size([32, 256])
2025-03-04 12:58:18,887 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([32, 3, 224, 224]), Heatmap: torch.Size([32, 1, 224, 224]), Attributes: torch.Size([32, 50])
2025-03-04 12:58:21,271 - FashionHybridModel - INFO - Image features shape: torch.Size([32, 2048])
2025-03-04 12:58:21,846 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([32, 256])
2025-03-04 12:58:21,850 - FashionHybridModel - INFO - Attribute features shape: torch.Size([32, 64])
2025-03-04 12:58:21,850 - FashionHybridModel - INFO - Fused features shape: torch.Size([32, 256])
2025-03-04 12:58:26,458 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([32, 3, 224, 224]), Heatmap: torch.Size([32, 1, 224, 224]), Attributes: torch.Size([32, 50])
2025-03-04 12:58:28,792 - FashionHybridModel - INFO - Image features shape: torch.Size([32, 2048])
2025-03-04 12:58:29,392 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([32, 256])
2025-03-04 12:58:29,393 - FashionHybridModel - INFO - Attribute features shape: torch.Size([32, 64])
2025-03-04 12:58:29,393 - FashionHybridModel - INFO - Fused features shape: torch.Size([32, 256])
2025-03-04 13:18:41,221 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-03-04 13:18:41,987 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-03-04 13:18:41,987 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-04 13:18:41,987 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-04 13:18:41,992 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-04 13:18:41,993 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-04 13:18:41,993 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-04 13:18:42,068 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-04 13:18:42,070 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-04 13:18:42,078 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-04 13:18:42,078 - FashionDataset - INFO - Validating dataset files...
2025-03-04 13:18:42,189 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-04 13:18:42,189 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-03-04 13:18:42,371 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-03-04 13:18:42,371 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-04 13:18:42,371 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-04 13:18:42,371 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-04 13:18:42,371 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-04 13:18:42,376 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-04 13:18:42,394 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-04 13:18:42,397 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-04 13:18:42,400 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-04 13:18:42,400 - FashionDataset - INFO - Validating dataset files...
2025-03-04 13:18:42,527 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-04 13:18:42,528 - TrainingScript - INFO -  Category labels are correctly indexed from 0 to 45.
2025-03-04 13:18:42,584 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-03-04 13:18:42,584 - FashionHybridModel - INFO - Parameters: num_categories=46, num_category_types=3, num_attributes=50, embed_dim=256
2025-03-04 13:18:43,001 - FashionHybridModel - INFO - Initialized resnet50 backbone with feature dimension: 2048
2025-03-04 13:18:43,006 - FashionHybridModel - INFO - Heatmap encoder initialized with output dimension: 256
2025-03-04 13:18:43,007 - FashionHybridModel - INFO - Attribute encoder initialized with output dimension: 64
2025-03-04 13:18:43,007 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2368
2025-03-04 13:18:43,014 - FashionHybridModel - INFO - Model initialization complete
2025-03-04 13:18:43,017 - FashionHybridModel - INFO - Image encoder backbone has been unfrozen
2025-03-04 13:18:58,000 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([32, 3, 224, 224]), Heatmap: torch.Size([32, 1, 224, 224]), Attributes: torch.Size([32, 50])
2025-03-04 13:19:00,845 - FashionHybridModel - INFO - Image features shape: torch.Size([32, 2048])
2025-03-04 13:19:01,871 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([32, 256])
2025-03-04 13:19:01,890 - FashionHybridModel - INFO - Attribute features shape: torch.Size([32, 64])
2025-03-04 13:19:01,899 - FashionHybridModel - INFO - Fused features shape: torch.Size([32, 256])
2025-03-04 13:19:09,757 - FashionHybridModel - INFO - Image features shape: torch.Size([32, 2048])
2025-03-04 13:19:10,284 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([32, 256])
2025-03-04 13:19:10,284 - FashionHybridModel - INFO - Attribute features shape: torch.Size([32, 64])
2025-03-04 13:19:10,284 - FashionHybridModel - INFO - Fused features shape: torch.Size([32, 256])
2025-03-04 13:19:16,659 - FashionHybridModel - INFO - Image features shape: torch.Size([32, 2048])
2025-03-04 13:19:17,260 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([32, 256])
2025-03-04 13:19:17,260 - FashionHybridModel - INFO - Attribute features shape: torch.Size([32, 64])
2025-03-04 13:19:17,260 - FashionHybridModel - INFO - Fused features shape: torch.Size([32, 256])
2025-03-04 13:19:23,247 - FashionHybridModel - INFO - Image features shape: torch.Size([32, 2048])
2025-03-04 13:19:23,788 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([32, 256])
2025-03-04 13:19:23,788 - FashionHybridModel - INFO - Attribute features shape: torch.Size([32, 64])
2025-03-04 13:19:23,796 - FashionHybridModel - INFO - Fused features shape: torch.Size([32, 256])
2025-03-04 13:19:29,723 - FashionHybridModel - INFO - Image features shape: torch.Size([32, 2048])
2025-03-04 13:19:30,272 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([32, 256])
2025-03-04 13:19:30,274 - FashionHybridModel - INFO - Attribute features shape: torch.Size([32, 64])
2025-03-04 13:19:30,274 - FashionHybridModel - INFO - Fused features shape: torch.Size([32, 256])
2025-03-04 13:21:47,927 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-03-04 13:21:48,798 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-03-04 13:21:48,798 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-04 13:21:48,798 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-04 13:21:48,806 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-04 13:21:48,806 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-04 13:21:48,808 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-04 13:21:48,895 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-04 13:21:48,899 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-04 13:21:48,903 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-04 13:21:48,904 - FashionDataset - INFO - Validating dataset files...
2025-03-04 13:21:49,004 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-04 13:21:49,004 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-03-04 13:21:49,160 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-03-04 13:21:49,160 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-04 13:21:49,172 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-04 13:21:49,172 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-04 13:21:49,172 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-04 13:21:49,172 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-04 13:21:49,189 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-04 13:21:49,191 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-04 13:21:49,191 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-04 13:21:49,191 - FashionDataset - INFO - Validating dataset files...
2025-03-04 13:21:49,290 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-04 13:21:49,290 - TrainingScript - INFO -  Category labels are correctly indexed from 0 to 45.
2025-03-04 13:21:49,350 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-03-04 13:21:49,350 - FashionHybridModel - INFO - Parameters: num_categories=46, num_category_types=3, num_attributes=50, embed_dim=256
2025-03-04 13:21:49,767 - FashionHybridModel - INFO - Initialized resnet50 backbone with feature dimension: 2048
2025-03-04 13:21:49,771 - FashionHybridModel - INFO - Heatmap encoder initialized with output dimension: 256
2025-03-04 13:21:49,771 - FashionHybridModel - INFO - Attribute encoder initialized with output dimension: 64
2025-03-04 13:21:49,771 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2368
2025-03-04 13:21:49,779 - FashionHybridModel - INFO - Model initialization complete
2025-03-04 13:21:49,781 - FashionHybridModel - INFO - Image encoder backbone has been unfrozen
2025-03-04 13:22:04,336 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([32, 3, 224, 224]), Heatmap: torch.Size([32, 1, 224, 224]), Attributes: torch.Size([32, 50])
2025-03-04 13:22:07,354 - FashionHybridModel - INFO - Image features shape: torch.Size([32, 2048])
2025-03-04 13:22:07,356 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([32, 256])
2025-03-04 13:22:07,356 - FashionHybridModel - INFO - Attribute features shape: torch.Size([32, 64])
2025-03-04 13:22:07,356 - FashionHybridModel - INFO - Fused features shape: torch.Size([32, 256])
2025-03-04 13:33:05,473 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-03-04 13:33:06,421 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-03-04 13:33:06,423 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-04 13:33:06,423 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-04 13:33:06,423 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-04 13:33:06,423 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-04 13:33:06,423 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-04 13:33:06,494 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-04 13:33:06,509 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-04 13:33:06,514 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-04 13:33:06,514 - FashionDataset - INFO - Validating dataset files...
2025-03-04 13:33:06,569 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-04 13:33:06,569 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-03-04 13:33:06,710 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-03-04 13:33:06,710 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-04 13:33:06,724 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-04 13:33:06,724 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-04 13:33:06,724 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-04 13:33:06,724 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-04 13:33:06,726 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-04 13:33:06,742 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-04 13:33:06,743 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-04 13:33:06,743 - FashionDataset - INFO - Validating dataset files...
2025-03-04 13:33:06,785 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-04 13:33:06,785 - TrainingScript - INFO -  Category labels are correctly indexed from 0 to 45.
2025-03-04 13:33:06,848 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-03-04 13:33:06,848 - FashionHybridModel - INFO - Parameters: num_categories=46, num_category_types=3, num_attributes=50, embed_dim=256
2025-03-04 13:33:07,251 - FashionHybridModel - INFO - Initialized resnet50 backbone with feature dimension: 2048
2025-03-04 13:33:07,251 - FashionHybridModel - INFO - Heatmap encoder initialized with output dimension: 256
2025-03-04 13:33:07,251 - FashionHybridModel - INFO - Attribute encoder initialized with output dimension: 64
2025-03-04 13:33:07,251 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2368
2025-03-04 13:33:07,265 - FashionHybridModel - INFO - Model initialization complete
2025-03-04 13:33:07,268 - FashionHybridModel - INFO - Image encoder backbone has been unfrozen
2025-03-04 13:33:21,967 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([32, 3, 224, 224]), Heatmap: torch.Size([32, 1, 224, 224]), Attributes: torch.Size([32, 50])
2025-03-04 13:33:25,249 - FashionHybridModel - INFO - Image features shape: torch.Size([32, 2048])
2025-03-04 13:33:25,249 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([32, 256])
2025-03-04 13:33:25,249 - FashionHybridModel - INFO - Attribute features shape: torch.Size([32, 64])
2025-03-04 13:33:25,249 - FashionHybridModel - INFO - Fused features shape: torch.Size([32, 256])
2025-03-04 14:19:56,243 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-03-04 14:19:57,072 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-03-04 14:19:57,072 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-04 14:19:57,072 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-04 14:19:57,079 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-04 14:19:57,080 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-04 14:19:57,082 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-04 14:19:57,180 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-04 14:19:57,180 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-04 14:19:57,191 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-04 14:19:57,191 - FashionDataset - INFO - Validating dataset files...
2025-03-04 14:19:57,231 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-04 14:19:57,231 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-03-04 14:19:57,407 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-03-04 14:19:57,407 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-04 14:19:57,407 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-04 14:19:57,407 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-04 14:19:57,407 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-04 14:19:57,407 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-04 14:19:57,431 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-04 14:19:57,431 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-04 14:19:57,436 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-04 14:19:57,437 - FashionDataset - INFO - Validating dataset files...
2025-03-04 14:19:57,472 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-04 14:19:57,472 - TrainingScript - INFO -  Category labels are correctly indexed from 0 to 45.
2025-03-04 14:19:57,535 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-03-04 14:19:57,535 - FashionHybridModel - INFO - Parameters: num_categories=46, num_category_types=3, num_attributes=50, embed_dim=256
2025-03-04 14:19:58,009 - FashionHybridModel - INFO - Initialized resnet50 backbone with feature dimension: 2048
2025-03-04 14:19:58,011 - FashionHybridModel - INFO - Heatmap encoder initialized with output dimension: 256
2025-03-04 14:19:58,014 - FashionHybridModel - INFO - Attribute encoder initialized with output dimension: 64
2025-03-04 14:19:58,014 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2368
2025-03-04 14:19:58,021 - FashionHybridModel - INFO - Model initialization complete
2025-03-04 14:19:58,025 - FashionHybridModel - INFO - Image encoder backbone has been unfrozen
2025-03-04 14:20:13,057 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([32, 3, 224, 224]), Heatmap: torch.Size([32, 1, 224, 224]), Attributes: torch.Size([32, 50])
2025-03-04 14:20:16,767 - FashionHybridModel - INFO - Image features shape: torch.Size([32, 2048])
2025-03-04 14:20:17,187 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([32, 256])
2025-03-04 14:20:17,187 - FashionHybridModel - INFO - Attribute features shape: torch.Size([32, 64])
2025-03-04 14:20:17,187 - FashionHybridModel - INFO - Fused features shape: torch.Size([32, 256])
2025-03-04 16:45:13,332 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-03-04 16:45:14,128 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-03-04 16:45:14,128 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-04 16:45:14,128 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-04 16:45:14,128 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-04 16:45:14,128 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-04 16:45:14,128 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-04 16:45:14,241 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-04 16:45:14,256 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-04 16:45:14,264 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-04 16:45:14,264 - FashionDataset - INFO - Validating dataset files...
2025-03-04 16:45:14,320 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-04 16:45:14,320 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-03-04 16:45:14,488 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-03-04 16:45:14,500 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-04 16:45:14,500 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-04 16:45:14,500 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-04 16:45:14,500 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-04 16:45:14,500 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-04 16:45:14,524 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-04 16:45:14,526 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-04 16:45:14,527 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-04 16:45:14,529 - FashionDataset - INFO - Validating dataset files...
2025-03-04 16:45:14,569 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-04 16:45:14,569 - TrainingScript - INFO -  Category labels are correctly indexed from 0 to 45.
2025-03-04 16:45:14,634 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-03-04 16:45:15,063 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2176
2025-03-04 16:45:15,068 - FashionHybridModel - INFO - Model initialization complete
2025-03-04 16:49:06,223 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-03-04 16:49:06,935 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-03-04 16:49:06,935 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-04 16:49:06,935 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-04 16:49:06,935 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-04 16:49:06,935 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-04 16:49:06,935 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-04 16:49:07,024 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-04 16:49:07,030 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-04 16:49:07,032 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-04 16:49:07,032 - FashionDataset - INFO - Validating dataset files...
2025-03-04 16:49:07,085 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-04 16:49:07,085 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-03-04 16:49:07,240 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-03-04 16:49:07,240 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-04 16:49:07,240 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-04 16:49:07,240 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-04 16:49:07,240 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-04 16:49:07,240 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-04 16:49:07,259 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-04 16:49:07,259 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-04 16:49:07,261 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-04 16:49:07,261 - FashionDataset - INFO - Validating dataset files...
2025-03-04 16:49:07,305 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-04 16:49:07,305 - TrainingScript - INFO -  Category labels are correctly indexed from 0 to 45.
2025-03-04 16:49:07,369 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-03-04 16:49:07,668 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2176
2025-03-04 16:49:07,673 - FashionHybridModel - INFO - Model initialization complete
2025-03-04 16:49:07,676 - FashionHybridModel - INFO - Image encoder backbone has been unfrozen
2025-03-04 16:49:25,768 - TrainingScript - ERROR - Error during forward pass: iteration over a 0-d tensor
2025-03-04 17:18:33,309 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-03-04 17:18:34,029 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-03-04 17:18:34,029 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-04 17:18:34,036 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-04 17:18:34,036 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-04 17:18:34,036 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-04 17:18:34,036 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-04 17:18:34,108 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-04 17:18:34,110 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-04 17:18:34,111 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-04 17:18:34,111 - FashionDataset - INFO - Validating dataset files...
2025-03-04 17:18:34,214 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-04 17:18:34,214 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-03-04 17:18:34,359 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-03-04 17:18:34,359 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-04 17:18:34,367 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-04 17:18:34,367 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-04 17:18:34,367 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-04 17:18:34,367 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-04 17:18:34,383 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-04 17:18:34,383 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-04 17:18:34,387 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-04 17:18:34,387 - FashionDataset - INFO - Validating dataset files...
2025-03-04 17:18:34,476 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-04 17:18:34,476 - TrainingScript - INFO -  Category labels are correctly indexed from 0 to 45.
2025-03-04 17:18:34,528 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-03-04 17:18:34,811 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2176
2025-03-04 17:18:34,811 - FashionHybridModel - INFO - Model initialization complete
2025-03-04 17:18:34,811 - FashionHybridModel - INFO - Image encoder backbone has been unfrozen. Trainable params: 159
2025-03-04 17:18:51,953 - TrainingScript - ERROR - Error during forward pass: name 'epoch' is not defined
2025-03-04 18:18:26,988 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-03-04 18:18:27,720 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-03-04 18:18:27,720 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-04 18:18:27,720 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-04 18:18:27,720 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-04 18:18:27,720 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-04 18:18:27,720 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-04 18:18:27,784 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-04 18:18:27,799 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-04 18:18:27,802 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-04 18:18:27,802 - FashionDataset - INFO - Validating dataset files...
2025-03-04 18:18:27,850 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-04 18:18:27,850 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-03-04 18:18:28,005 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-03-04 18:18:28,005 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-04 18:18:28,005 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-04 18:18:28,014 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-04 18:18:28,014 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-04 18:18:28,014 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-04 18:18:28,027 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-04 18:18:28,032 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-04 18:18:28,034 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-04 18:18:28,034 - FashionDataset - INFO - Validating dataset files...
2025-03-04 18:18:28,083 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-04 18:18:28,083 - TrainingScript - INFO -  Category labels are correctly indexed from 0 to 45.
2025-03-04 18:18:28,148 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-03-04 18:18:28,433 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2176
2025-03-04 18:18:28,442 - FashionHybridModel - INFO - Model initialization complete
2025-03-04 18:18:28,446 - FashionHybridModel - INFO - Image encoder backbone has been unfrozen. Trainable params: 159
2025-03-04 18:33:33,218 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-03-04 18:33:33,971 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-03-04 18:33:33,971 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-04 18:33:33,972 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-04 18:33:33,973 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-04 18:33:33,973 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-04 18:33:33,973 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-04 18:33:34,053 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-04 18:33:34,055 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-04 18:33:34,061 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-04 18:33:34,061 - FashionDataset - INFO - Validating dataset files...
2025-03-04 18:33:34,112 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-04 18:33:34,112 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-03-04 18:33:34,252 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-03-04 18:33:34,252 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-04 18:33:34,252 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-04 18:33:34,252 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-04 18:33:34,252 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-04 18:33:34,252 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-04 18:33:34,280 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-04 18:33:34,281 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-04 18:33:34,283 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-04 18:33:34,283 - FashionDataset - INFO - Validating dataset files...
2025-03-04 18:33:34,324 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-04 18:33:34,324 - TrainingScript - INFO -  Category labels are correctly indexed from 0 to 45.
2025-03-04 18:33:34,378 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-03-04 18:33:34,653 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2176
2025-03-04 18:33:34,657 - FashionHybridModel - INFO - Model initialization complete
2025-03-04 18:33:34,661 - FashionHybridModel - INFO - Image encoder backbone has been unfrozen. Trainable params: 159
2025-03-04 18:33:52,224 - TrainingScript - INFO - Auxiliary Losses - Image: 4.0399, Heatmap: 1.1120, Attributes: 0.7261
2025-03-04 22:09:56,699 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-03-04 22:09:57,448 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-03-04 22:09:57,452 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-04 22:09:57,452 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-04 22:09:57,456 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-04 22:09:57,456 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-04 22:09:57,461 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-04 22:09:57,533 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-04 22:09:57,537 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-04 22:09:57,544 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-04 22:09:57,544 - FashionDataset - INFO - Validating dataset files...
2025-03-04 22:09:57,630 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-04 22:09:57,630 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-03-04 22:09:57,777 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-03-04 22:09:57,777 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-04 22:09:57,777 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-04 22:09:57,777 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-04 22:09:57,779 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-04 22:09:57,779 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-04 22:09:57,794 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-04 22:09:57,795 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-04 22:09:57,796 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-04 22:09:57,796 - FashionDataset - INFO - Validating dataset files...
2025-03-04 22:09:57,870 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-04 22:09:57,870 - TrainingScript - INFO -  Category labels are correctly indexed from 0 to 45.
2025-03-04 22:09:57,918 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-03-04 22:09:58,318 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2176
2025-03-04 22:09:58,318 - FashionHybridModel - INFO - Model initialization complete
2025-03-04 22:09:58,327 - FashionHybridModel - INFO - Image encoder backbone has been unfrozen. Trainable params: 159
2025-03-04 22:10:15,523 - TrainingScript - INFO - Auxiliary Losses - Image: 3.7048, Heatmap: 1.0950, Attributes: 0.7513
2025-03-04 22:10:19,399 - TrainingScript - WARNING - Warning: Key total_aux not found in loss_components, skipping update.
2025-03-04 22:10:22,182 - TrainingScript - INFO - Auxiliary Losses - Image: 5.1903, Heatmap: 1.0927, Attributes: 0.6975
2025-03-04 22:10:25,954 - TrainingScript - WARNING - Warning: Key total_aux not found in loss_components, skipping update.
2025-03-04 22:10:28,275 - TrainingScript - INFO - Auxiliary Losses - Image: 6.9465, Heatmap: 1.0973, Attributes: 0.6329
2025-03-04 22:10:32,510 - TrainingScript - WARNING - Warning: Key total_aux not found in loss_components, skipping update.
2025-03-04 22:10:34,766 - TrainingScript - INFO - Auxiliary Losses - Image: 6.7357, Heatmap: 1.0813, Attributes: 0.6036
2025-03-04 22:10:38,234 - TrainingScript - WARNING - Warning: Key total_aux not found in loss_components, skipping update.
2025-03-04 22:15:28,139 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-03-04 22:15:29,255 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-03-04 22:15:29,255 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-04 22:15:29,255 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-04 22:15:29,258 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-04 22:15:29,258 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-04 22:15:29,260 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-04 22:15:29,362 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-04 22:15:29,365 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-04 22:15:29,368 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-04 22:15:29,368 - FashionDataset - INFO - Validating dataset files...
2025-03-04 22:15:29,488 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-04 22:15:29,488 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-03-04 22:15:29,701 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-03-04 22:15:29,701 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-04 22:15:29,701 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-04 22:15:29,701 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-04 22:15:29,701 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-04 22:15:29,701 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-04 22:15:29,723 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-04 22:15:29,724 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-04 22:15:29,726 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-04 22:15:29,727 - FashionDataset - INFO - Validating dataset files...
2025-03-04 22:15:29,833 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-04 22:15:29,834 - TrainingScript - INFO -  Category labels are correctly indexed from 0 to 45.
2025-03-04 22:15:29,875 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-03-04 22:15:30,292 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2176
2025-03-04 22:15:30,297 - FashionHybridModel - INFO - Model initialization complete
2025-03-04 22:15:30,301 - FashionHybridModel - INFO - Image encoder backbone has been unfrozen. Trainable params: 159
2025-03-04 22:15:48,565 - TrainingScript - INFO - Auxiliary Losses - Image: 3.9023, Heatmap: 1.1355, Attributes: 0.7279
2025-03-04 22:15:55,054 - TrainingScript - INFO - Auxiliary Losses - Image: 5.5263, Heatmap: 1.1165, Attributes: 0.6706
2025-03-04 22:16:01,821 - TrainingScript - INFO - Auxiliary Losses - Image: 5.7972, Heatmap: 1.1119, Attributes: 0.6286
2025-03-04 22:16:08,282 - TrainingScript - INFO - Auxiliary Losses - Image: 5.4098, Heatmap: 1.1082, Attributes: 0.5851
2025-03-04 22:16:14,551 - TrainingScript - INFO - Auxiliary Losses - Image: 5.0161, Heatmap: 1.0869, Attributes: 0.5400
2025-03-04 22:16:20,773 - TrainingScript - INFO - Auxiliary Losses - Image: 4.9887, Heatmap: 1.0835, Attributes: 0.4937
2025-03-04 22:16:27,560 - TrainingScript - INFO - Auxiliary Losses - Image: 5.2828, Heatmap: 1.0821, Attributes: 0.4535
2025-03-04 22:26:43,192 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-03-04 22:26:44,004 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-03-04 22:26:44,008 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-04 22:26:44,008 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-04 22:26:44,010 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-04 22:26:44,010 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-04 22:26:44,013 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-04 22:26:44,089 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-04 22:26:44,089 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-04 22:26:44,097 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-04 22:26:44,097 - FashionDataset - INFO - Validating dataset files...
2025-03-04 22:26:44,191 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-04 22:26:44,191 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-03-04 22:26:44,351 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-03-04 22:26:44,351 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-04 22:26:44,351 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-04 22:26:44,351 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-04 22:26:44,351 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-04 22:26:44,351 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-04 22:26:44,367 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-04 22:26:44,369 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-04 22:26:44,370 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-04 22:26:44,370 - FashionDataset - INFO - Validating dataset files...
2025-03-04 22:26:44,456 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-04 22:26:44,456 - TrainingScript - INFO -  Category labels are correctly indexed from 0 to 45.
2025-03-04 22:26:44,511 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-03-04 22:26:44,819 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2176
2025-03-04 22:26:44,822 - FashionHybridModel - INFO - Model initialization complete
2025-03-04 22:26:44,828 - FashionHybridModel - INFO - Image encoder backbone has been unfrozen. Trainable params: 159
2025-03-04 22:27:02,406 - TrainingScript - INFO - Auxiliary Losses - Image: 3.9384, Heatmap: 1.1084, Attributes: 0.7389
2025-03-04 22:27:08,317 - TrainingScript - INFO - Auxiliary Losses - Image: 6.1009, Heatmap: 1.1066, Attributes: 0.6999
2025-03-04 22:27:14,208 - TrainingScript - INFO - Auxiliary Losses - Image: 4.7814, Heatmap: 1.1051, Attributes: 0.6346
2025-03-04 22:27:20,307 - TrainingScript - INFO - Auxiliary Losses - Image: 6.3669, Heatmap: 1.0967, Attributes: 0.6097
2025-03-04 22:27:26,138 - TrainingScript - INFO - Auxiliary Losses - Image: 3.5481, Heatmap: 1.0877, Attributes: 0.5682
2025-03-04 22:27:31,699 - TrainingScript - INFO - Auxiliary Losses - Image: 3.7549, Heatmap: 1.0781, Attributes: 0.5119
2025-03-04 22:27:37,181 - TrainingScript - INFO - Auxiliary Losses - Image: 6.5317, Heatmap: 1.0407, Attributes: 0.4773
2025-03-04 22:27:42,899 - TrainingScript - INFO - Auxiliary Losses - Image: 5.9874, Heatmap: 1.0875, Attributes: 0.4400
2025-03-04 22:27:49,522 - TrainingScript - INFO - Auxiliary Losses - Image: 4.1906, Heatmap: 1.0086, Attributes: 0.4092
2025-03-04 22:34:04,604 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-03-04 22:34:05,365 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-03-04 22:34:05,365 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-04 22:34:05,365 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-04 22:34:05,381 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-04 22:34:05,381 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-04 22:34:05,381 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-04 22:34:05,444 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-04 22:34:05,459 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-04 22:34:05,459 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-04 22:34:05,459 - FashionDataset - INFO - Validating dataset files...
2025-03-04 22:34:05,554 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-04 22:34:05,554 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-03-04 22:34:05,697 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-03-04 22:34:05,697 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-04 22:34:05,697 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-04 22:34:05,697 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-04 22:34:05,697 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-04 22:34:05,697 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-04 22:34:05,726 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-04 22:34:05,726 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-04 22:34:05,729 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-04 22:34:05,729 - FashionDataset - INFO - Validating dataset files...
2025-03-04 22:34:05,823 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-04 22:34:05,823 - TrainingScript - INFO -  Category labels are correctly indexed from 0 to 45.
2025-03-04 22:34:05,903 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-03-04 22:34:06,240 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2176
2025-03-04 22:34:06,244 - FashionHybridModel - INFO - Model initialization complete
2025-03-04 22:34:06,246 - FashionHybridModel - INFO - Image encoder backbone has been unfrozen. Trainable params: 159
2025-03-04 22:34:23,097 - TrainingScript - INFO - Auxiliary Losses - Image: 3.9180, Heatmap: 1.1329, Attributes: 0.7523
2025-03-04 22:34:28,944 - TrainingScript - INFO - Auxiliary Losses - Image: 6.8988, Heatmap: 1.1185, Attributes: 0.6990
2025-03-04 22:34:34,666 - TrainingScript - INFO - Auxiliary Losses - Image: 4.6476, Heatmap: 1.1207, Attributes: 0.6443
2025-03-04 22:34:40,315 - TrainingScript - INFO - Auxiliary Losses - Image: 3.5068, Heatmap: 1.1165, Attributes: 0.5917
2025-03-04 22:34:45,700 - TrainingScript - INFO - Auxiliary Losses - Image: 3.4709, Heatmap: 1.0943, Attributes: 0.5507
2025-03-04 22:34:51,249 - TrainingScript - INFO - Auxiliary Losses - Image: 4.6033, Heatmap: 1.0706, Attributes: 0.5192
2025-03-04 22:34:56,668 - TrainingScript - INFO - Auxiliary Losses - Image: 4.9980, Heatmap: 1.0629, Attributes: 0.4720
2025-03-04 22:38:42,909 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-03-04 22:38:43,670 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-03-04 22:38:43,670 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-04 22:38:43,670 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-04 22:38:43,674 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-04 22:38:43,674 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-04 22:38:43,674 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-04 22:38:43,735 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-04 22:38:43,751 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-04 22:38:43,755 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-04 22:38:43,755 - FashionDataset - INFO - Validating dataset files...
2025-03-04 22:38:43,849 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-04 22:38:43,849 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-03-04 22:38:43,992 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-03-04 22:38:43,992 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-04 22:38:43,992 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-04 22:38:43,992 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-04 22:38:43,992 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-04 22:38:43,992 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-04 22:38:44,019 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-04 22:38:44,020 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-04 22:38:44,020 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-04 22:38:44,020 - FashionDataset - INFO - Validating dataset files...
2025-03-04 22:38:44,104 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-04 22:38:44,104 - TrainingScript - INFO -  Category labels are correctly indexed from 0 to 45.
2025-03-04 22:38:44,155 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-03-04 22:38:44,431 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2176
2025-03-04 22:38:44,435 - FashionHybridModel - INFO - Model initialization complete
2025-03-04 22:38:44,439 - FashionHybridModel - INFO - Image encoder backbone has been unfrozen. Trainable params: 159
2025-03-04 22:39:02,431 - TrainingScript - INFO - Auxiliary Losses - Image: 3.9060, Heatmap: 1.1194, Attributes: 0.7077
2025-03-04 22:39:06,111 - TrainingScript - INFO -  [Detailed Log] Epoch 0, Batch 0/6538 | Loss: 6.4990 | Aux Losses - Image: 3.9060, Heatmap: 1.1194, Attributes: 0.7077
2025-03-04 22:39:08,655 - TrainingScript - INFO - Auxiliary Losses - Image: 5.4413, Heatmap: 1.1027, Attributes: 0.6497
2025-03-04 22:39:14,963 - TrainingScript - INFO - Auxiliary Losses - Image: 7.5483, Heatmap: 1.1043, Attributes: 0.6050
2025-03-04 22:39:20,758 - TrainingScript - INFO - Auxiliary Losses - Image: 5.7598, Heatmap: 1.0919, Attributes: 0.5742
2025-03-04 22:39:27,068 - TrainingScript - INFO - Auxiliary Losses - Image: 4.2075, Heatmap: 1.0854, Attributes: 0.5342
2025-03-04 22:39:33,192 - TrainingScript - INFO - Auxiliary Losses - Image: 3.7433, Heatmap: 1.0393, Attributes: 0.4888
2025-03-04 22:45:11,410 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-03-04 22:45:12,169 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-03-04 22:45:12,172 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-04 22:45:12,172 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-04 22:45:12,172 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-04 22:45:12,172 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-04 22:45:12,176 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-04 22:45:12,234 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-04 22:45:12,252 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-04 22:45:12,256 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-04 22:45:12,256 - FashionDataset - INFO - Validating dataset files...
2025-03-04 22:45:12,377 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-04 22:45:12,377 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-03-04 22:45:12,537 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-03-04 22:45:12,537 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-04 22:45:12,537 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-04 22:45:12,537 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-04 22:45:12,537 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-04 22:45:12,537 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-04 22:45:12,556 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-04 22:45:12,557 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-04 22:45:12,558 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-04 22:45:12,559 - FashionDataset - INFO - Validating dataset files...
2025-03-04 22:45:12,638 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-04 22:45:12,638 - TrainingScript - INFO -  Category labels are correctly indexed from 0 to 45.
2025-03-04 22:45:12,692 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-03-04 22:45:12,997 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2176
2025-03-04 22:45:12,997 - FashionHybridModel - INFO - Model initialization complete
2025-03-04 22:45:13,010 - FashionHybridModel - INFO - Image encoder backbone has been unfrozen. Trainable params: 159
2025-03-04 22:45:29,910 - TrainingScript - INFO - Auxiliary Losses - Image: 3.9436, Heatmap: 1.0817, Attributes: 0.7177
2025-03-04 22:45:36,603 - TrainingScript - INFO - Auxiliary Losses - Image: 5.7021, Heatmap: 1.0569, Attributes: 0.6740
2025-03-04 22:45:42,761 - TrainingScript - INFO - Auxiliary Losses - Image: 6.1278, Heatmap: 1.0595, Attributes: 0.6237
2025-03-04 22:45:48,626 - TrainingScript - INFO - Auxiliary Losses - Image: 4.8018, Heatmap: 1.0522, Attributes: 0.5760
2025-03-04 22:45:54,594 - TrainingScript - INFO - Auxiliary Losses - Image: 5.6641, Heatmap: 1.0684, Attributes: 0.5362
2025-03-04 22:46:00,121 - TrainingScript - INFO - Auxiliary Losses - Image: 5.1281, Heatmap: 1.0859, Attributes: 0.5032
2025-03-04 22:46:06,334 - TrainingScript - INFO - Auxiliary Losses - Image: 3.7736, Heatmap: 1.0708, Attributes: 0.4723
2025-03-04 22:46:12,216 - TrainingScript - INFO - Auxiliary Losses - Image: 4.3909, Heatmap: 1.0738, Attributes: 0.4293
2025-03-04 22:46:17,680 - TrainingScript - INFO - Auxiliary Losses - Image: 4.1863, Heatmap: 1.0460, Attributes: 0.3931
2025-03-04 22:46:23,212 - TrainingScript - INFO - Auxiliary Losses - Image: 4.3047, Heatmap: 1.0865, Attributes: 0.3664
2025-03-04 22:46:28,794 - TrainingScript - INFO - Auxiliary Losses - Image: 3.7010, Heatmap: 1.0759, Attributes: 0.3523
2025-03-04 22:46:35,319 - TrainingScript - INFO - Auxiliary Losses - Image: 3.4998, Heatmap: 1.0972, Attributes: 0.3250
2025-03-04 22:46:41,969 - TrainingScript - INFO - Auxiliary Losses - Image: 3.8682, Heatmap: 1.0793, Attributes: 0.3020
2025-03-04 22:46:48,362 - TrainingScript - INFO - Auxiliary Losses - Image: 4.1902, Heatmap: 1.0656, Attributes: 0.2726
2025-03-04 22:46:54,317 - TrainingScript - INFO - Auxiliary Losses - Image: 3.4791, Heatmap: 1.1073, Attributes: 0.2464
2025-03-04 22:47:00,277 - TrainingScript - INFO - Auxiliary Losses - Image: 3.2235, Heatmap: 1.0453, Attributes: 0.2568
2025-03-04 22:47:06,839 - TrainingScript - INFO - Auxiliary Losses - Image: 3.7133, Heatmap: 1.0344, Attributes: 0.2229
2025-03-04 22:53:39,688 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-03-04 22:53:40,514 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-03-04 22:53:40,514 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-04 22:53:40,514 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-04 22:53:40,516 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-04 22:53:40,516 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-04 22:53:40,521 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-04 22:53:40,594 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-04 22:53:40,594 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-04 22:53:40,602 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-04 22:53:40,603 - FashionDataset - INFO - Validating dataset files...
2025-03-04 22:53:40,686 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-04 22:53:40,686 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-03-04 22:53:40,827 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-03-04 22:53:40,827 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-04 22:53:40,827 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-04 22:53:40,843 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-04 22:53:40,843 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-04 22:53:40,843 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-04 22:53:40,843 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-04 22:53:40,859 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-04 22:53:40,861 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-04 22:53:40,861 - FashionDataset - INFO - Validating dataset files...
2025-03-04 22:53:40,937 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-04 22:53:40,937 - TrainingScript - INFO -  Category labels are correctly indexed from 0 to 45.
2025-03-04 22:53:40,992 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-03-04 22:53:41,265 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2176
2025-03-04 22:53:41,269 - FashionHybridModel - INFO - Model initialization complete
2025-03-04 22:53:41,273 - FashionHybridModel - INFO - Image encoder backbone has been unfrozen. Trainable params: 159
2025-03-04 22:53:58,950 - TrainingScript - INFO - Auxiliary Losses - Image: 3.9194, Heatmap: 1.1100, Attributes: 0.7382
2025-03-04 22:54:04,852 - TrainingScript - INFO - Auxiliary Losses - Image: 5.0011, Heatmap: 1.1005, Attributes: 0.6843
2025-03-04 22:54:10,479 - TrainingScript - INFO - Auxiliary Losses - Image: 7.1521, Heatmap: 1.1151, Attributes: 0.6306
2025-03-04 22:54:16,167 - TrainingScript - INFO - Auxiliary Losses - Image: 5.8539, Heatmap: 1.0970, Attributes: 0.5972
2025-03-04 22:54:21,674 - TrainingScript - INFO - Auxiliary Losses - Image: 4.4973, Heatmap: 1.0996, Attributes: 0.5543
2025-03-04 22:54:27,401 - TrainingScript - INFO - Auxiliary Losses - Image: 3.9213, Heatmap: 1.0944, Attributes: 0.5065
2025-03-04 22:54:33,008 - TrainingScript - INFO - Auxiliary Losses - Image: 3.3489, Heatmap: 1.0930, Attributes: 0.4937
2025-03-04 22:54:38,557 - TrainingScript - INFO - Auxiliary Losses - Image: 3.5209, Heatmap: 1.0581, Attributes: 0.4215
2025-03-04 22:54:44,268 - TrainingScript - INFO - Auxiliary Losses - Image: 5.0438, Heatmap: 1.1017, Attributes: 0.4022
2025-03-04 22:54:49,951 - TrainingScript - INFO - Auxiliary Losses - Image: 4.0594, Heatmap: 1.0331, Attributes: 0.3834
2025-03-04 22:54:55,565 - TrainingScript - INFO - Auxiliary Losses - Image: 4.7999, Heatmap: 1.0540, Attributes: 0.3732
2025-03-04 22:55:01,650 - TrainingScript - INFO - Auxiliary Losses - Image: 5.0674, Heatmap: 1.0253, Attributes: 0.3247
2025-03-04 22:55:07,460 - TrainingScript - INFO - Auxiliary Losses - Image: 5.3540, Heatmap: 0.9927, Attributes: 0.3162
2025-03-04 22:55:13,655 - TrainingScript - INFO - Auxiliary Losses - Image: 3.9548, Heatmap: 1.0600, Attributes: 0.2865
2025-03-04 22:59:10,735 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-03-04 22:59:11,496 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-03-04 22:59:11,500 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-04 22:59:11,500 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-04 22:59:11,500 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-04 22:59:11,500 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-04 22:59:11,500 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-04 22:59:11,574 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-04 22:59:11,574 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-04 22:59:11,584 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-04 22:59:11,584 - FashionDataset - INFO - Validating dataset files...
2025-03-04 22:59:11,662 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-04 22:59:11,662 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-03-04 22:59:11,804 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-03-04 22:59:11,815 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-04 22:59:11,815 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-04 22:59:11,815 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-04 22:59:11,815 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-04 22:59:11,815 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-04 22:59:11,832 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-04 22:59:11,835 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-04 22:59:11,837 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-04 22:59:11,837 - FashionDataset - INFO - Validating dataset files...
2025-03-04 22:59:11,911 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-04 22:59:11,911 - TrainingScript - INFO -  Category labels are correctly indexed from 0 to 45.
2025-03-04 22:59:11,959 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-03-04 22:59:12,243 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2176
2025-03-04 22:59:12,247 - FashionHybridModel - INFO - Model initialization complete
2025-03-04 22:59:12,251 - FashionHybridModel - INFO - Image encoder backbone has been unfrozen. Trainable params: 159
2025-03-04 22:59:29,429 - TrainingScript - INFO - Auxiliary Losses - Image: 3.8681, Heatmap: 1.0743, Attributes: 0.7346
2025-03-04 22:59:35,255 - TrainingScript - INFO - Auxiliary Losses - Image: 5.1892, Heatmap: 1.0613, Attributes: 0.6822
2025-03-04 22:59:41,043 - TrainingScript - INFO - Auxiliary Losses - Image: 5.3561, Heatmap: 1.0715, Attributes: 0.6241
2025-03-04 22:59:46,763 - TrainingScript - INFO - Auxiliary Losses - Image: 4.1538, Heatmap: 1.0269, Attributes: 0.5892
2025-03-04 22:59:52,505 - TrainingScript - INFO - Auxiliary Losses - Image: 6.3613, Heatmap: 1.0723, Attributes: 0.5462
2025-03-04 22:59:58,202 - TrainingScript - INFO - Auxiliary Losses - Image: 3.4511, Heatmap: 1.0943, Attributes: 0.4979
2025-03-04 23:00:03,965 - TrainingScript - INFO - Auxiliary Losses - Image: 4.1099, Heatmap: 1.1322, Attributes: 0.4685
2025-03-04 23:00:09,668 - TrainingScript - INFO - Auxiliary Losses - Image: 4.0619, Heatmap: 1.0650, Attributes: 0.4315
2025-03-04 23:00:15,474 - TrainingScript - INFO - Auxiliary Losses - Image: 3.4649, Heatmap: 1.0094, Attributes: 0.4061
2025-03-04 23:00:21,558 - TrainingScript - INFO - Auxiliary Losses - Image: 4.8646, Heatmap: 1.0907, Attributes: 0.3787
2025-03-04 23:00:27,029 - TrainingScript - INFO - Auxiliary Losses - Image: 4.1466, Heatmap: 1.0554, Attributes: 0.3637
2025-03-04 23:00:32,525 - TrainingScript - INFO - Auxiliary Losses - Image: 5.5591, Heatmap: 1.0404, Attributes: 0.3368
2025-03-04 23:00:37,984 - TrainingScript - INFO - Auxiliary Losses - Image: 3.7753, Heatmap: 0.9932, Attributes: 0.3197
2025-03-04 23:00:43,375 - TrainingScript - INFO - Auxiliary Losses - Image: 3.9527, Heatmap: 1.1191, Attributes: 0.3167
2025-03-04 23:00:48,839 - TrainingScript - INFO - Auxiliary Losses - Image: 3.7418, Heatmap: 1.0713, Attributes: 0.2749
2025-03-04 23:00:55,727 - TrainingScript - INFO - Auxiliary Losses - Image: 3.8752, Heatmap: 0.9578, Attributes: 0.2629
2025-03-04 23:01:02,502 - TrainingScript - INFO - Auxiliary Losses - Image: 5.6336, Heatmap: 1.0175, Attributes: 0.2455
2025-03-04 23:01:08,206 - TrainingScript - INFO - Auxiliary Losses - Image: 5.2392, Heatmap: 0.9235, Attributes: 0.2198
2025-03-04 23:01:13,543 - TrainingScript - INFO - Auxiliary Losses - Image: 3.3913, Heatmap: 0.8810, Attributes: 0.2105
2025-03-04 23:01:18,859 - TrainingScript - INFO - Auxiliary Losses - Image: 5.3167, Heatmap: 1.1021, Attributes: 0.1797
2025-03-04 23:01:24,295 - TrainingScript - INFO - Auxiliary Losses - Image: 4.2313, Heatmap: 1.0951, Attributes: 0.1873
2025-03-04 23:01:29,706 - TrainingScript - INFO - Auxiliary Losses - Image: 3.7635, Heatmap: 1.0973, Attributes: 0.1723
2025-03-04 23:01:35,298 - TrainingScript - INFO - Auxiliary Losses - Image: 3.6349, Heatmap: 1.0729, Attributes: 0.1863
2025-03-04 23:01:41,687 - TrainingScript - INFO - Auxiliary Losses - Image: 3.5603, Heatmap: 0.9231, Attributes: 0.1590
2025-03-05 01:11:56,720 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-03-05 01:11:57,449 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-03-05 01:11:57,449 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-05 01:11:57,449 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-05 01:11:57,449 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-05 01:11:57,449 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-05 01:11:57,449 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-05 01:11:57,524 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-05 01:11:57,524 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-05 01:11:57,524 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-05 01:11:57,524 - FashionDataset - INFO - Enabling LRU cache with size 100
2025-03-05 01:11:57,524 - FashionDataset - INFO - Validating dataset files...
2025-03-05 01:11:57,584 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-05 01:11:57,584 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-03-05 01:11:57,738 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-03-05 01:11:57,738 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-05 01:11:57,738 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-05 01:11:57,738 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-05 01:11:57,738 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-05 01:11:57,738 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-05 01:11:57,757 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-05 01:11:57,757 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-05 01:11:57,757 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-05 01:11:57,757 - FashionDataset - INFO - Enabling LRU cache with size 100
2025-03-05 01:11:57,757 - FashionDataset - INFO - Validating dataset files...
2025-03-05 01:11:57,811 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-05 01:11:57,811 - TrainingScript - INFO -  Category labels are correctly indexed from 0 to 45.
2025-03-05 01:11:57,870 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-03-05 01:11:58,176 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2176
2025-03-05 01:11:58,176 - FashionHybridModel - INFO - Model initialization complete
2025-03-05 01:11:58,183 - FashionHybridModel - INFO - Image encoder backbone has been unfrozen. Trainable params: 159
2025-03-05 01:17:28,165 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-03-05 01:17:28,943 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-03-05 01:17:28,943 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-05 01:17:28,946 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-05 01:17:28,947 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-05 01:17:28,947 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-05 01:17:28,947 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-05 01:17:29,040 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-05 01:17:29,042 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-05 01:17:29,047 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-05 01:17:29,047 - FashionDataset - INFO - Validating dataset files...
2025-03-05 01:17:29,097 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-05 01:17:29,097 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-03-05 01:17:29,240 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-03-05 01:17:29,240 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-05 01:17:29,240 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-05 01:17:29,240 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-05 01:17:29,240 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-05 01:17:29,240 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-05 01:17:29,263 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-05 01:17:29,268 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-05 01:17:29,268 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-05 01:17:29,270 - FashionDataset - INFO - Validating dataset files...
2025-03-05 01:17:29,313 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-05 01:17:29,313 - TrainingScript - INFO -  Category labels are correctly indexed from 0 to 45.
2025-03-05 01:17:29,384 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-03-05 01:17:29,665 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2176
2025-03-05 01:17:29,670 - FashionHybridModel - INFO - Model initialization complete
2025-03-05 01:17:29,673 - FashionHybridModel - INFO - Image encoder backbone has been unfrozen. Trainable params: 159
2025-03-05 01:17:44,496 - FashionDataset - ERROR - Error in __getitem__: 'FashionDataset' object has no attribute 'load_image'
2025-03-05 01:17:44,496 - FashionDataset - ERROR - Error in __getitem__: 'FashionDataset' object has no attribute 'load_image'
2025-03-05 01:17:44,500 - FashionDataset - ERROR - Error in __getitem__: 'FashionDataset' object has no attribute 'load_image'
2025-03-05 01:17:44,500 - FashionDataset - ERROR - Error in __getitem__: 'FashionDataset' object has no attribute 'load_image'
2025-03-05 01:17:44,505 - FashionDataset - ERROR - Error in __getitem__: 'FashionDataset' object has no attribute 'load_image'
2025-03-05 01:25:19,238 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-03-05 01:25:20,083 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-03-05 01:25:20,084 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-05 01:25:20,084 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-05 01:25:20,084 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-05 01:25:20,087 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-05 01:25:20,088 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-05 01:25:20,171 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-05 01:25:20,182 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-05 01:25:20,191 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-05 01:25:20,191 - FashionDataset - INFO - Validating dataset files...
2025-03-05 01:25:20,233 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-05 01:25:20,233 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-03-05 01:25:20,389 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-03-05 01:25:20,389 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-05 01:25:20,389 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-05 01:25:20,389 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-05 01:25:20,389 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-05 01:25:20,389 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-05 01:25:20,411 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-05 01:25:20,415 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-05 01:25:20,417 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-05 01:25:20,417 - FashionDataset - INFO - Validating dataset files...
2025-03-05 01:25:20,461 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-05 01:25:20,461 - TrainingScript - INFO -  Category labels are correctly indexed from 0 to 45.
2025-03-05 01:25:20,510 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-03-05 01:25:20,510 - FashionHybridModel - INFO - Parameters: num_categories=46, num_category_types=3, num_attributes=50, embed_dim=256
2025-03-05 01:25:20,798 - FashionHybridModel - INFO - Initialized resnet50 backbone with feature dimension: 2048
2025-03-05 01:25:20,800 - FashionHybridModel - INFO - Heatmap encoder initialized with output dimension: 256
2025-03-05 01:25:20,800 - FashionHybridModel - INFO - Attribute encoder initialized with output dimension: 64
2025-03-05 01:25:20,800 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2368
2025-03-05 01:25:20,808 - FashionHybridModel - INFO - Model initialization complete
2025-03-05 01:25:20,809 - FashionHybridModel - INFO - Image encoder backbone has been unfrozen
2025-03-05 01:25:35,352 - FashionHybridModel - INFO - Input shapes - Image: torch.Size([32, 3, 224, 224]), Heatmap: torch.Size([32, 1, 224, 224]), Attributes: torch.Size([32, 50])
2025-03-05 01:25:38,547 - FashionHybridModel - INFO - Image features shape: torch.Size([32, 2048])
2025-03-05 01:25:38,547 - FashionHybridModel - INFO - Heatmap features shape: torch.Size([32, 256])
2025-03-05 01:25:38,547 - FashionHybridModel - INFO - Attribute features shape: torch.Size([32, 64])
2025-03-05 01:25:38,547 - FashionHybridModel - INFO - Fused features shape: torch.Size([32, 256])
2025-03-05 01:48:50,257 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-03-05 01:48:51,035 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-03-05 01:48:51,035 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-05 01:48:51,038 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-05 01:48:51,038 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-05 01:48:51,038 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-05 01:48:51,038 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-05 01:48:51,128 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-05 01:48:51,128 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-05 01:48:51,147 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-05 01:48:51,147 - FashionDataset - INFO - Validating dataset files...
2025-03-05 01:48:51,200 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-05 01:48:51,200 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-03-05 01:48:51,380 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-03-05 01:48:51,380 - FashionDataset - INFO - Using transforms: Compose(
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-05 01:48:51,380 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-05 01:48:51,380 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-05 01:48:51,380 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-05 01:48:51,380 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-05 01:48:51,407 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-05 01:48:51,409 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-05 01:48:51,411 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-05 01:48:51,411 - FashionDataset - INFO - Enabling LRU cache with size 100
2025-03-05 01:48:51,413 - FashionDataset - INFO - Validating dataset files...
2025-03-05 01:48:51,474 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-05 01:48:51,474 - TrainingScript - INFO -  Category labels are correctly indexed from 0 to 45.
2025-03-05 01:48:51,533 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-03-05 01:48:51,849 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2176
2025-03-05 01:48:51,865 - FashionHybridModel - INFO - Model initialization complete
2025-03-05 01:48:51,869 - FashionHybridModel - INFO - Image encoder backbone has been unfrozen. Trainable params: 159
2025-03-05 01:49:09,534 - TrainingScript - INFO - Auxiliary Losses - Image: 3.8311, Heatmap: 1.0723, Attributes: 0.7093
2025-03-05 01:49:16,321 - TrainingScript - INFO - Auxiliary Losses - Image: 3.6146, Heatmap: 1.0981, Attributes: 0.7074
2025-03-05 01:49:22,478 - TrainingScript - INFO - Auxiliary Losses - Image: 3.5599, Heatmap: 1.1274, Attributes: 0.7009
2025-03-05 01:49:28,110 - TrainingScript - INFO - Auxiliary Losses - Image: 3.4777, Heatmap: 1.0911, Attributes: 0.7043
2025-03-05 01:49:34,147 - TrainingScript - INFO - Auxiliary Losses - Image: 3.3471, Heatmap: 1.1111, Attributes: 0.6843
2025-03-05 01:49:40,075 - TrainingScript - INFO - Auxiliary Losses - Image: 3.2606, Heatmap: 1.1089, Attributes: 0.6757
2025-03-05 01:49:46,578 - TrainingScript - INFO - Auxiliary Losses - Image: 3.3097, Heatmap: 1.1105, Attributes: 0.6969
2025-03-05 02:00:23,807 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_train.csv
2025-03-05 02:00:24,719 - FashionDataset - INFO - Loaded metadata with 209215 entries
2025-03-05 02:00:24,719 - FashionDataset - INFO - Using transforms: Compose(
    RandomHorizontalFlip(p=0.5)
    RandomRotation(degrees=[-20.0, 20.0], interpolation=nearest, expand=False, fill=0)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=(-0.1, 0.1))
    RandomErasing(p=0.5, scale=(0.02, 0.2), ratio=(0.3, 3.3), value=0, inplace=False)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-05 02:00:24,721 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-05 02:00:24,721 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-05 02:00:24,723 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-05 02:00:24,723 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-05 02:00:24,822 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-05 02:00:24,822 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-05 02:00:24,838 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-05 02:00:24,838 - FashionDataset - INFO - Validating dataset files...
2025-03-05 02:00:24,950 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-05 02:00:24,952 - FashionDataset - INFO - Initializing FashionDataset with metadata: X:\dissertation\StyleSyncProject\zsehran\metadata_updated_val.csv
2025-03-05 02:00:25,135 - FashionDataset - INFO - Loaded metadata with 39999 entries
2025-03-05 02:00:25,150 - FashionDataset - INFO - Using transforms: Compose(
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
2025-03-05 02:00:25,150 - FashionDataset - INFO - Extracted 50 attribute columns
2025-03-05 02:00:25,150 - FashionDataset - INFO - Original unique categories: [np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(46), np.int64(47), np.int64(48)]
2025-03-05 02:00:25,150 - FashionDataset - INFO - Valid categories after filtering: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39, 40, 41, 42, 43, 44, 46, 47, 48]
2025-03-05 02:00:25,150 - FashionDataset - INFO - Category mapping: {1: 0, 2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 9, 11: 10, 12: 11, 13: 12, 14: 13, 15: 14, 16: 15, 17: 16, 18: 17, 19: 18, 20: 19, 21: 20, 22: 21, 23: 22, 24: 23, 25: 24, 26: 25, 27: 26, 28: 27, 29: 28, 30: 29, 31: 30, 32: 31, 33: 32, 34: 33, 35: 34, 36: 35, 37: 36, 39: 37, 40: 38, 41: 39, 42: 40, 43: 41, 44: 42, 46: 43, 47: 44, 48: 45}
2025-03-05 02:00:25,166 - FashionDataset - INFO - After remapping: category_label min=0, max=45
2025-03-05 02:00:25,166 - FashionDataset - INFO - Final category labels after remapping: [np.int64(0), np.int64(1), np.int64(2), np.int64(3), np.int64(4), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(9), np.int64(10), np.int64(11), np.int64(12), np.int64(13), np.int64(14), np.int64(15), np.int64(16), np.int64(17), np.int64(18), np.int64(19), np.int64(20), np.int64(21), np.int64(22), np.int64(23), np.int64(24), np.int64(25), np.int64(26), np.int64(27), np.int64(28), np.int64(29), np.int64(30), np.int64(31), np.int64(32), np.int64(33), np.int64(34), np.int64(35), np.int64(36), np.int64(37), np.int64(38), np.int64(39), np.int64(40), np.int64(41), np.int64(42), np.int64(43), np.int64(44), np.int64(45)]
2025-03-05 02:00:25,166 - FashionDataset - INFO - Created category mapping with 46 categories
2025-03-05 02:00:25,166 - FashionDataset - INFO - Enabling LRU cache with size 100
2025-03-05 02:00:25,166 - FashionDataset - INFO - Validating dataset files...
2025-03-05 02:00:25,267 - FashionDataset - INFO - Validated 100 random samples, all files exist
2025-03-05 02:00:25,269 - TrainingScript - INFO -  Category labels are correctly indexed from 0 to 45.
2025-03-05 02:00:25,349 - FashionHybridModel - INFO - Initializing FashionHybridModel with resnet50 backbone
2025-03-05 02:00:25,790 - FashionHybridModel - INFO - Total feature dimension after concatenation: 2176
2025-03-05 02:00:25,802 - FashionHybridModel - INFO - Model initialization complete
2025-03-05 02:00:25,806 - FashionHybridModel - INFO - Image encoder backbone has been unfrozen. Trainable params: 159
2025-03-05 02:00:45,852 - TrainingScript - INFO - Auxiliary Losses - Image: 3.8802, Heatmap: 1.1080, Attributes: 0.7247
